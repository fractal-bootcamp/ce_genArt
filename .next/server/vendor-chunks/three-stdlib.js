"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/three-stdlib";
exports.ids = ["vendor-chunks/three-stdlib"];
exports.modules = {

/***/ "(ssr)/./node_modules/three-stdlib/controls/OrbitControls.js":
/*!*************************************************************!*\
  !*** ./node_modules/three-stdlib/controls/OrbitControls.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MapControls: () => (/* binding */ MapControls),\n/* harmony export */   OrbitControls: () => (/* binding */ OrbitControls)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\nvar __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\n\nconst _ray = new three__WEBPACK_IMPORTED_MODULE_0__.Ray();\nconst _plane = new three__WEBPACK_IMPORTED_MODULE_0__.Plane();\nconst TILT_LIMIT = Math.cos(70 * (Math.PI / 180));\nconst moduloWrapAround = (offset, capacity) => (offset % capacity + capacity) % capacity;\nclass OrbitControls extends three__WEBPACK_IMPORTED_MODULE_0__.EventDispatcher {\n  constructor(object, domElement) {\n    super();\n    __publicField(this, \"object\");\n    __publicField(this, \"domElement\");\n    // Set to false to disable this control\n    __publicField(this, \"enabled\", true);\n    // \"target\" sets the location of focus, where the object orbits around\n    __publicField(this, \"target\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    // How far you can dolly in and out ( PerspectiveCamera only )\n    __publicField(this, \"minDistance\", 0);\n    __publicField(this, \"maxDistance\", Infinity);\n    // How far you can zoom in and out ( OrthographicCamera only )\n    __publicField(this, \"minZoom\", 0);\n    __publicField(this, \"maxZoom\", Infinity);\n    // How far you can orbit vertically, upper and lower limits.\n    // Range is 0 to Math.PI radians.\n    __publicField(this, \"minPolarAngle\", 0);\n    // radians\n    __publicField(this, \"maxPolarAngle\", Math.PI);\n    // radians\n    // How far you can orbit horizontally, upper and lower limits.\n    // If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n    __publicField(this, \"minAzimuthAngle\", -Infinity);\n    // radians\n    __publicField(this, \"maxAzimuthAngle\", Infinity);\n    // radians\n    // Set to true to enable damping (inertia)\n    // If damping is enabled, you must call controls.update() in your animation loop\n    __publicField(this, \"enableDamping\", false);\n    __publicField(this, \"dampingFactor\", 0.05);\n    // This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n    // Set to false to disable zooming\n    __publicField(this, \"enableZoom\", true);\n    __publicField(this, \"zoomSpeed\", 1);\n    // Set to false to disable rotating\n    __publicField(this, \"enableRotate\", true);\n    __publicField(this, \"rotateSpeed\", 1);\n    // Set to false to disable panning\n    __publicField(this, \"enablePan\", true);\n    __publicField(this, \"panSpeed\", 1);\n    __publicField(this, \"screenSpacePanning\", true);\n    // if false, pan orthogonal to world-space direction camera.up\n    __publicField(this, \"keyPanSpeed\", 7);\n    // pixels moved per arrow key push\n    __publicField(this, \"zoomToCursor\", false);\n    // Set to true to automatically rotate around the target\n    // If auto-rotate is enabled, you must call controls.update() in your animation loop\n    __publicField(this, \"autoRotate\", false);\n    __publicField(this, \"autoRotateSpeed\", 2);\n    // 30 seconds per orbit when fps is 60\n    __publicField(this, \"reverseOrbit\", false);\n    // true if you want to reverse the orbit to mouse drag from left to right = orbits left\n    __publicField(this, \"reverseHorizontalOrbit\", false);\n    // true if you want to reverse the horizontal orbit direction\n    __publicField(this, \"reverseVerticalOrbit\", false);\n    // true if you want to reverse the vertical orbit direction\n    // The four arrow keys\n    __publicField(this, \"keys\", { LEFT: \"ArrowLeft\", UP: \"ArrowUp\", RIGHT: \"ArrowRight\", BOTTOM: \"ArrowDown\" });\n    // Mouse buttons\n    __publicField(this, \"mouseButtons\", {\n      LEFT: three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.ROTATE,\n      MIDDLE: three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.DOLLY,\n      RIGHT: three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.PAN\n    });\n    // Touch fingers\n    __publicField(this, \"touches\", { ONE: three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.ROTATE, TWO: three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.DOLLY_PAN });\n    __publicField(this, \"target0\");\n    __publicField(this, \"position0\");\n    __publicField(this, \"zoom0\");\n    // the target DOM element for key events\n    __publicField(this, \"_domElementKeyEvents\", null);\n    __publicField(this, \"getPolarAngle\");\n    __publicField(this, \"getAzimuthalAngle\");\n    __publicField(this, \"setPolarAngle\");\n    __publicField(this, \"setAzimuthalAngle\");\n    __publicField(this, \"getDistance\");\n    __publicField(this, \"listenToKeyEvents\");\n    __publicField(this, \"stopListenToKeyEvents\");\n    __publicField(this, \"saveState\");\n    __publicField(this, \"reset\");\n    __publicField(this, \"update\");\n    __publicField(this, \"connect\");\n    __publicField(this, \"dispose\");\n    this.object = object;\n    this.domElement = domElement;\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.zoom0 = this.object.zoom;\n    this.getPolarAngle = () => spherical.phi;\n    this.getAzimuthalAngle = () => spherical.theta;\n    this.setPolarAngle = (value) => {\n      let phi = moduloWrapAround(value, 2 * Math.PI);\n      let currentPhi = spherical.phi;\n      if (currentPhi < 0)\n        currentPhi += 2 * Math.PI;\n      if (phi < 0)\n        phi += 2 * Math.PI;\n      let phiDist = Math.abs(phi - currentPhi);\n      if (2 * Math.PI - phiDist < phiDist) {\n        if (phi < currentPhi) {\n          phi += 2 * Math.PI;\n        } else {\n          currentPhi += 2 * Math.PI;\n        }\n      }\n      sphericalDelta.phi = phi - currentPhi;\n      scope.update();\n    };\n    this.setAzimuthalAngle = (value) => {\n      let theta = moduloWrapAround(value, 2 * Math.PI);\n      let currentTheta = spherical.theta;\n      if (currentTheta < 0)\n        currentTheta += 2 * Math.PI;\n      if (theta < 0)\n        theta += 2 * Math.PI;\n      let thetaDist = Math.abs(theta - currentTheta);\n      if (2 * Math.PI - thetaDist < thetaDist) {\n        if (theta < currentTheta) {\n          theta += 2 * Math.PI;\n        } else {\n          currentTheta += 2 * Math.PI;\n        }\n      }\n      sphericalDelta.theta = theta - currentTheta;\n      scope.update();\n    };\n    this.getDistance = () => scope.object.position.distanceTo(scope.target);\n    this.listenToKeyEvents = (domElement2) => {\n      domElement2.addEventListener(\"keydown\", onKeyDown);\n      this._domElementKeyEvents = domElement2;\n    };\n    this.stopListenToKeyEvents = () => {\n      this._domElementKeyEvents.removeEventListener(\"keydown\", onKeyDown);\n      this._domElementKeyEvents = null;\n    };\n    this.saveState = () => {\n      scope.target0.copy(scope.target);\n      scope.position0.copy(scope.object.position);\n      scope.zoom0 = scope.object.zoom;\n    };\n    this.reset = () => {\n      scope.target.copy(scope.target0);\n      scope.object.position.copy(scope.position0);\n      scope.object.zoom = scope.zoom0;\n      scope.object.updateProjectionMatrix();\n      scope.dispatchEvent(changeEvent);\n      scope.update();\n      state = STATE.NONE;\n    };\n    this.update = (() => {\n      const offset = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3();\n      const up = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 1, 0);\n      const quat = new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion().setFromUnitVectors(object.up, up);\n      const quatInverse = quat.clone().invert();\n      const lastPosition = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3();\n      const lastQuaternion = new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion();\n      const twoPI = 2 * Math.PI;\n      return function update() {\n        const position = scope.object.position;\n        quat.setFromUnitVectors(object.up, up);\n        quatInverse.copy(quat).invert();\n        offset.copy(position).sub(scope.target);\n        offset.applyQuaternion(quat);\n        spherical.setFromVector3(offset);\n        if (scope.autoRotate && state === STATE.NONE) {\n          rotateLeft(getAutoRotationAngle());\n        }\n        if (scope.enableDamping) {\n          spherical.theta += sphericalDelta.theta * scope.dampingFactor;\n          spherical.phi += sphericalDelta.phi * scope.dampingFactor;\n        } else {\n          spherical.theta += sphericalDelta.theta;\n          spherical.phi += sphericalDelta.phi;\n        }\n        let min = scope.minAzimuthAngle;\n        let max = scope.maxAzimuthAngle;\n        if (isFinite(min) && isFinite(max)) {\n          if (min < -Math.PI)\n            min += twoPI;\n          else if (min > Math.PI)\n            min -= twoPI;\n          if (max < -Math.PI)\n            max += twoPI;\n          else if (max > Math.PI)\n            max -= twoPI;\n          if (min <= max) {\n            spherical.theta = Math.max(min, Math.min(max, spherical.theta));\n          } else {\n            spherical.theta = spherical.theta > (min + max) / 2 ? Math.max(min, spherical.theta) : Math.min(max, spherical.theta);\n          }\n        }\n        spherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, spherical.phi));\n        spherical.makeSafe();\n        if (scope.enableDamping === true) {\n          scope.target.addScaledVector(panOffset, scope.dampingFactor);\n        } else {\n          scope.target.add(panOffset);\n        }\n        if (scope.zoomToCursor && performCursorZoom || scope.object.isOrthographicCamera) {\n          spherical.radius = clampDistance(spherical.radius);\n        } else {\n          spherical.radius = clampDistance(spherical.radius * scale);\n        }\n        offset.setFromSpherical(spherical);\n        offset.applyQuaternion(quatInverse);\n        position.copy(scope.target).add(offset);\n        if (!scope.object.matrixAutoUpdate)\n          scope.object.updateMatrix();\n        scope.object.lookAt(scope.target);\n        if (scope.enableDamping === true) {\n          sphericalDelta.theta *= 1 - scope.dampingFactor;\n          sphericalDelta.phi *= 1 - scope.dampingFactor;\n          panOffset.multiplyScalar(1 - scope.dampingFactor);\n        } else {\n          sphericalDelta.set(0, 0, 0);\n          panOffset.set(0, 0, 0);\n        }\n        let zoomChanged = false;\n        if (scope.zoomToCursor && performCursorZoom) {\n          let newRadius = null;\n          if (scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.PerspectiveCamera && scope.object.isPerspectiveCamera) {\n            const prevRadius = offset.length();\n            newRadius = clampDistance(prevRadius * scale);\n            const radiusDelta = prevRadius - newRadius;\n            scope.object.position.addScaledVector(dollyDirection, radiusDelta);\n            scope.object.updateMatrixWorld();\n          } else if (scope.object.isOrthographicCamera) {\n            const mouseBefore = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(mouse.x, mouse.y, 0);\n            mouseBefore.unproject(scope.object);\n            scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / scale));\n            scope.object.updateProjectionMatrix();\n            zoomChanged = true;\n            const mouseAfter = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(mouse.x, mouse.y, 0);\n            mouseAfter.unproject(scope.object);\n            scope.object.position.sub(mouseAfter).add(mouseBefore);\n            scope.object.updateMatrixWorld();\n            newRadius = offset.length();\n          } else {\n            console.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled.\");\n            scope.zoomToCursor = false;\n          }\n          if (newRadius !== null) {\n            if (scope.screenSpacePanning) {\n              scope.target.set(0, 0, -1).transformDirection(scope.object.matrix).multiplyScalar(newRadius).add(scope.object.position);\n            } else {\n              _ray.origin.copy(scope.object.position);\n              _ray.direction.set(0, 0, -1).transformDirection(scope.object.matrix);\n              if (Math.abs(scope.object.up.dot(_ray.direction)) < TILT_LIMIT) {\n                object.lookAt(scope.target);\n              } else {\n                _plane.setFromNormalAndCoplanarPoint(scope.object.up, scope.target);\n                _ray.intersectPlane(_plane, scope.target);\n              }\n            }\n          }\n        } else if (scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.OrthographicCamera && scope.object.isOrthographicCamera) {\n          zoomChanged = scale !== 1;\n          if (zoomChanged) {\n            scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / scale));\n            scope.object.updateProjectionMatrix();\n          }\n        }\n        scale = 1;\n        performCursorZoom = false;\n        if (zoomChanged || lastPosition.distanceToSquared(scope.object.position) > EPS || 8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {\n          scope.dispatchEvent(changeEvent);\n          lastPosition.copy(scope.object.position);\n          lastQuaternion.copy(scope.object.quaternion);\n          zoomChanged = false;\n          return true;\n        }\n        return false;\n      };\n    })();\n    this.connect = (domElement2) => {\n      scope.domElement = domElement2;\n      scope.domElement.style.touchAction = \"none\";\n      scope.domElement.addEventListener(\"contextmenu\", onContextMenu);\n      scope.domElement.addEventListener(\"pointerdown\", onPointerDown);\n      scope.domElement.addEventListener(\"pointercancel\", onPointerUp);\n      scope.domElement.addEventListener(\"wheel\", onMouseWheel);\n    };\n    this.dispose = () => {\n      var _a, _b, _c, _d, _e, _f;\n      if (scope.domElement) {\n        scope.domElement.style.touchAction = \"auto\";\n      }\n      (_a = scope.domElement) == null ? void 0 : _a.removeEventListener(\"contextmenu\", onContextMenu);\n      (_b = scope.domElement) == null ? void 0 : _b.removeEventListener(\"pointerdown\", onPointerDown);\n      (_c = scope.domElement) == null ? void 0 : _c.removeEventListener(\"pointercancel\", onPointerUp);\n      (_d = scope.domElement) == null ? void 0 : _d.removeEventListener(\"wheel\", onMouseWheel);\n      (_e = scope.domElement) == null ? void 0 : _e.ownerDocument.removeEventListener(\"pointermove\", onPointerMove);\n      (_f = scope.domElement) == null ? void 0 : _f.ownerDocument.removeEventListener(\"pointerup\", onPointerUp);\n      if (scope._domElementKeyEvents !== null) {\n        scope._domElementKeyEvents.removeEventListener(\"keydown\", onKeyDown);\n      }\n    };\n    const scope = this;\n    const changeEvent = { type: \"change\" };\n    const startEvent = { type: \"start\" };\n    const endEvent = { type: \"end\" };\n    const STATE = {\n      NONE: -1,\n      ROTATE: 0,\n      DOLLY: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_PAN: 4,\n      TOUCH_DOLLY_PAN: 5,\n      TOUCH_DOLLY_ROTATE: 6\n    };\n    let state = STATE.NONE;\n    const EPS = 1e-6;\n    const spherical = new three__WEBPACK_IMPORTED_MODULE_0__.Spherical();\n    const sphericalDelta = new three__WEBPACK_IMPORTED_MODULE_0__.Spherical();\n    let scale = 1;\n    const panOffset = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3();\n    const rotateStart = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const rotateEnd = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const rotateDelta = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const panStart = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const panEnd = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const panDelta = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const dollyStart = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const dollyEnd = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const dollyDelta = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    const dollyDirection = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3();\n    const mouse = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n    let performCursorZoom = false;\n    const pointers = [];\n    const pointerPositions = {};\n    function getAutoRotationAngle() {\n      return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n    }\n    function getZoomScale() {\n      return Math.pow(0.95, scope.zoomSpeed);\n    }\n    function rotateLeft(angle) {\n      if (scope.reverseOrbit || scope.reverseHorizontalOrbit) {\n        sphericalDelta.theta += angle;\n      } else {\n        sphericalDelta.theta -= angle;\n      }\n    }\n    function rotateUp(angle) {\n      if (scope.reverseOrbit || scope.reverseVerticalOrbit) {\n        sphericalDelta.phi += angle;\n      } else {\n        sphericalDelta.phi -= angle;\n      }\n    }\n    const panLeft = (() => {\n      const v = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3();\n      return function panLeft2(distance, objectMatrix) {\n        v.setFromMatrixColumn(objectMatrix, 0);\n        v.multiplyScalar(-distance);\n        panOffset.add(v);\n      };\n    })();\n    const panUp = (() => {\n      const v = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3();\n      return function panUp2(distance, objectMatrix) {\n        if (scope.screenSpacePanning === true) {\n          v.setFromMatrixColumn(objectMatrix, 1);\n        } else {\n          v.setFromMatrixColumn(objectMatrix, 0);\n          v.crossVectors(scope.object.up, v);\n        }\n        v.multiplyScalar(distance);\n        panOffset.add(v);\n      };\n    })();\n    const pan = (() => {\n      const offset = new three__WEBPACK_IMPORTED_MODULE_0__.Vector3();\n      return function pan2(deltaX, deltaY) {\n        const element = scope.domElement;\n        if (element && scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.PerspectiveCamera && scope.object.isPerspectiveCamera) {\n          const position = scope.object.position;\n          offset.copy(position).sub(scope.target);\n          let targetDistance = offset.length();\n          targetDistance *= Math.tan(scope.object.fov / 2 * Math.PI / 180);\n          panLeft(2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix);\n          panUp(2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix);\n        } else if (element && scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.OrthographicCamera && scope.object.isOrthographicCamera) {\n          panLeft(\n            deltaX * (scope.object.right - scope.object.left) / scope.object.zoom / element.clientWidth,\n            scope.object.matrix\n          );\n          panUp(\n            deltaY * (scope.object.top - scope.object.bottom) / scope.object.zoom / element.clientHeight,\n            scope.object.matrix\n          );\n        } else {\n          console.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.\");\n          scope.enablePan = false;\n        }\n      };\n    })();\n    function dollyOut(dollyScale) {\n      if (scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.PerspectiveCamera && scope.object.isPerspectiveCamera || scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.OrthographicCamera && scope.object.isOrthographicCamera) {\n        scale /= dollyScale;\n      } else {\n        console.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\");\n        scope.enableZoom = false;\n      }\n    }\n    function dollyIn(dollyScale) {\n      if (scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.PerspectiveCamera && scope.object.isPerspectiveCamera || scope.object instanceof three__WEBPACK_IMPORTED_MODULE_0__.OrthographicCamera && scope.object.isOrthographicCamera) {\n        scale *= dollyScale;\n      } else {\n        console.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\");\n        scope.enableZoom = false;\n      }\n    }\n    function updateMouseParameters(event) {\n      if (!scope.zoomToCursor || !scope.domElement) {\n        return;\n      }\n      performCursorZoom = true;\n      const rect = scope.domElement.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      const w = rect.width;\n      const h = rect.height;\n      mouse.x = x / w * 2 - 1;\n      mouse.y = -(y / h) * 2 + 1;\n      dollyDirection.set(mouse.x, mouse.y, 1).unproject(scope.object).sub(scope.object.position).normalize();\n    }\n    function clampDistance(dist) {\n      return Math.max(scope.minDistance, Math.min(scope.maxDistance, dist));\n    }\n    function handleMouseDownRotate(event) {\n      rotateStart.set(event.clientX, event.clientY);\n    }\n    function handleMouseDownDolly(event) {\n      updateMouseParameters(event);\n      dollyStart.set(event.clientX, event.clientY);\n    }\n    function handleMouseDownPan(event) {\n      panStart.set(event.clientX, event.clientY);\n    }\n    function handleMouseMoveRotate(event) {\n      rotateEnd.set(event.clientX, event.clientY);\n      rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);\n      const element = scope.domElement;\n      if (element) {\n        rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight);\n        rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);\n      }\n      rotateStart.copy(rotateEnd);\n      scope.update();\n    }\n    function handleMouseMoveDolly(event) {\n      dollyEnd.set(event.clientX, event.clientY);\n      dollyDelta.subVectors(dollyEnd, dollyStart);\n      if (dollyDelta.y > 0) {\n        dollyOut(getZoomScale());\n      } else if (dollyDelta.y < 0) {\n        dollyIn(getZoomScale());\n      }\n      dollyStart.copy(dollyEnd);\n      scope.update();\n    }\n    function handleMouseMovePan(event) {\n      panEnd.set(event.clientX, event.clientY);\n      panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\n      pan(panDelta.x, panDelta.y);\n      panStart.copy(panEnd);\n      scope.update();\n    }\n    function handleMouseWheel(event) {\n      updateMouseParameters(event);\n      if (event.deltaY < 0) {\n        dollyIn(getZoomScale());\n      } else if (event.deltaY > 0) {\n        dollyOut(getZoomScale());\n      }\n      scope.update();\n    }\n    function handleKeyDown(event) {\n      let needsUpdate = false;\n      switch (event.code) {\n        case scope.keys.UP:\n          pan(0, scope.keyPanSpeed);\n          needsUpdate = true;\n          break;\n        case scope.keys.BOTTOM:\n          pan(0, -scope.keyPanSpeed);\n          needsUpdate = true;\n          break;\n        case scope.keys.LEFT:\n          pan(scope.keyPanSpeed, 0);\n          needsUpdate = true;\n          break;\n        case scope.keys.RIGHT:\n          pan(-scope.keyPanSpeed, 0);\n          needsUpdate = true;\n          break;\n      }\n      if (needsUpdate) {\n        event.preventDefault();\n        scope.update();\n      }\n    }\n    function handleTouchStartRotate() {\n      if (pointers.length == 1) {\n        rotateStart.set(pointers[0].pageX, pointers[0].pageY);\n      } else {\n        const x = 0.5 * (pointers[0].pageX + pointers[1].pageX);\n        const y = 0.5 * (pointers[0].pageY + pointers[1].pageY);\n        rotateStart.set(x, y);\n      }\n    }\n    function handleTouchStartPan() {\n      if (pointers.length == 1) {\n        panStart.set(pointers[0].pageX, pointers[0].pageY);\n      } else {\n        const x = 0.5 * (pointers[0].pageX + pointers[1].pageX);\n        const y = 0.5 * (pointers[0].pageY + pointers[1].pageY);\n        panStart.set(x, y);\n      }\n    }\n    function handleTouchStartDolly() {\n      const dx = pointers[0].pageX - pointers[1].pageX;\n      const dy = pointers[0].pageY - pointers[1].pageY;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n      dollyStart.set(0, distance);\n    }\n    function handleTouchStartDollyPan() {\n      if (scope.enableZoom)\n        handleTouchStartDolly();\n      if (scope.enablePan)\n        handleTouchStartPan();\n    }\n    function handleTouchStartDollyRotate() {\n      if (scope.enableZoom)\n        handleTouchStartDolly();\n      if (scope.enableRotate)\n        handleTouchStartRotate();\n    }\n    function handleTouchMoveRotate(event) {\n      if (pointers.length == 1) {\n        rotateEnd.set(event.pageX, event.pageY);\n      } else {\n        const position = getSecondPointerPosition(event);\n        const x = 0.5 * (event.pageX + position.x);\n        const y = 0.5 * (event.pageY + position.y);\n        rotateEnd.set(x, y);\n      }\n      rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);\n      const element = scope.domElement;\n      if (element) {\n        rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight);\n        rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);\n      }\n      rotateStart.copy(rotateEnd);\n    }\n    function handleTouchMovePan(event) {\n      if (pointers.length == 1) {\n        panEnd.set(event.pageX, event.pageY);\n      } else {\n        const position = getSecondPointerPosition(event);\n        const x = 0.5 * (event.pageX + position.x);\n        const y = 0.5 * (event.pageY + position.y);\n        panEnd.set(x, y);\n      }\n      panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\n      pan(panDelta.x, panDelta.y);\n      panStart.copy(panEnd);\n    }\n    function handleTouchMoveDolly(event) {\n      const position = getSecondPointerPosition(event);\n      const dx = event.pageX - position.x;\n      const dy = event.pageY - position.y;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n      dollyEnd.set(0, distance);\n      dollyDelta.set(0, Math.pow(dollyEnd.y / dollyStart.y, scope.zoomSpeed));\n      dollyOut(dollyDelta.y);\n      dollyStart.copy(dollyEnd);\n    }\n    function handleTouchMoveDollyPan(event) {\n      if (scope.enableZoom)\n        handleTouchMoveDolly(event);\n      if (scope.enablePan)\n        handleTouchMovePan(event);\n    }\n    function handleTouchMoveDollyRotate(event) {\n      if (scope.enableZoom)\n        handleTouchMoveDolly(event);\n      if (scope.enableRotate)\n        handleTouchMoveRotate(event);\n    }\n    function onPointerDown(event) {\n      var _a, _b;\n      if (scope.enabled === false)\n        return;\n      if (pointers.length === 0) {\n        (_a = scope.domElement) == null ? void 0 : _a.ownerDocument.addEventListener(\"pointermove\", onPointerMove);\n        (_b = scope.domElement) == null ? void 0 : _b.ownerDocument.addEventListener(\"pointerup\", onPointerUp);\n      }\n      addPointer(event);\n      if (event.pointerType === \"touch\") {\n        onTouchStart(event);\n      } else {\n        onMouseDown(event);\n      }\n    }\n    function onPointerMove(event) {\n      if (scope.enabled === false)\n        return;\n      if (event.pointerType === \"touch\") {\n        onTouchMove(event);\n      } else {\n        onMouseMove(event);\n      }\n    }\n    function onPointerUp(event) {\n      var _a, _b, _c;\n      removePointer(event);\n      if (pointers.length === 0) {\n        (_a = scope.domElement) == null ? void 0 : _a.releasePointerCapture(event.pointerId);\n        (_b = scope.domElement) == null ? void 0 : _b.ownerDocument.removeEventListener(\"pointermove\", onPointerMove);\n        (_c = scope.domElement) == null ? void 0 : _c.ownerDocument.removeEventListener(\"pointerup\", onPointerUp);\n      }\n      scope.dispatchEvent(endEvent);\n      state = STATE.NONE;\n    }\n    function onMouseDown(event) {\n      let mouseAction;\n      switch (event.button) {\n        case 0:\n          mouseAction = scope.mouseButtons.LEFT;\n          break;\n        case 1:\n          mouseAction = scope.mouseButtons.MIDDLE;\n          break;\n        case 2:\n          mouseAction = scope.mouseButtons.RIGHT;\n          break;\n        default:\n          mouseAction = -1;\n      }\n      switch (mouseAction) {\n        case three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.DOLLY:\n          if (scope.enableZoom === false)\n            return;\n          handleMouseDownDolly(event);\n          state = STATE.DOLLY;\n          break;\n        case three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.ROTATE:\n          if (event.ctrlKey || event.metaKey || event.shiftKey) {\n            if (scope.enablePan === false)\n              return;\n            handleMouseDownPan(event);\n            state = STATE.PAN;\n          } else {\n            if (scope.enableRotate === false)\n              return;\n            handleMouseDownRotate(event);\n            state = STATE.ROTATE;\n          }\n          break;\n        case three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.PAN:\n          if (event.ctrlKey || event.metaKey || event.shiftKey) {\n            if (scope.enableRotate === false)\n              return;\n            handleMouseDownRotate(event);\n            state = STATE.ROTATE;\n          } else {\n            if (scope.enablePan === false)\n              return;\n            handleMouseDownPan(event);\n            state = STATE.PAN;\n          }\n          break;\n        default:\n          state = STATE.NONE;\n      }\n      if (state !== STATE.NONE) {\n        scope.dispatchEvent(startEvent);\n      }\n    }\n    function onMouseMove(event) {\n      if (scope.enabled === false)\n        return;\n      switch (state) {\n        case STATE.ROTATE:\n          if (scope.enableRotate === false)\n            return;\n          handleMouseMoveRotate(event);\n          break;\n        case STATE.DOLLY:\n          if (scope.enableZoom === false)\n            return;\n          handleMouseMoveDolly(event);\n          break;\n        case STATE.PAN:\n          if (scope.enablePan === false)\n            return;\n          handleMouseMovePan(event);\n          break;\n      }\n    }\n    function onMouseWheel(event) {\n      if (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE && state !== STATE.ROTATE) {\n        return;\n      }\n      event.preventDefault();\n      scope.dispatchEvent(startEvent);\n      handleMouseWheel(event);\n      scope.dispatchEvent(endEvent);\n    }\n    function onKeyDown(event) {\n      if (scope.enabled === false || scope.enablePan === false)\n        return;\n      handleKeyDown(event);\n    }\n    function onTouchStart(event) {\n      trackPointer(event);\n      switch (pointers.length) {\n        case 1:\n          switch (scope.touches.ONE) {\n            case three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.ROTATE:\n              if (scope.enableRotate === false)\n                return;\n              handleTouchStartRotate();\n              state = STATE.TOUCH_ROTATE;\n              break;\n            case three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.PAN:\n              if (scope.enablePan === false)\n                return;\n              handleTouchStartPan();\n              state = STATE.TOUCH_PAN;\n              break;\n            default:\n              state = STATE.NONE;\n          }\n          break;\n        case 2:\n          switch (scope.touches.TWO) {\n            case three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.DOLLY_PAN:\n              if (scope.enableZoom === false && scope.enablePan === false)\n                return;\n              handleTouchStartDollyPan();\n              state = STATE.TOUCH_DOLLY_PAN;\n              break;\n            case three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.DOLLY_ROTATE:\n              if (scope.enableZoom === false && scope.enableRotate === false)\n                return;\n              handleTouchStartDollyRotate();\n              state = STATE.TOUCH_DOLLY_ROTATE;\n              break;\n            default:\n              state = STATE.NONE;\n          }\n          break;\n        default:\n          state = STATE.NONE;\n      }\n      if (state !== STATE.NONE) {\n        scope.dispatchEvent(startEvent);\n      }\n    }\n    function onTouchMove(event) {\n      trackPointer(event);\n      switch (state) {\n        case STATE.TOUCH_ROTATE:\n          if (scope.enableRotate === false)\n            return;\n          handleTouchMoveRotate(event);\n          scope.update();\n          break;\n        case STATE.TOUCH_PAN:\n          if (scope.enablePan === false)\n            return;\n          handleTouchMovePan(event);\n          scope.update();\n          break;\n        case STATE.TOUCH_DOLLY_PAN:\n          if (scope.enableZoom === false && scope.enablePan === false)\n            return;\n          handleTouchMoveDollyPan(event);\n          scope.update();\n          break;\n        case STATE.TOUCH_DOLLY_ROTATE:\n          if (scope.enableZoom === false && scope.enableRotate === false)\n            return;\n          handleTouchMoveDollyRotate(event);\n          scope.update();\n          break;\n        default:\n          state = STATE.NONE;\n      }\n    }\n    function onContextMenu(event) {\n      if (scope.enabled === false)\n        return;\n      event.preventDefault();\n    }\n    function addPointer(event) {\n      pointers.push(event);\n    }\n    function removePointer(event) {\n      delete pointerPositions[event.pointerId];\n      for (let i = 0; i < pointers.length; i++) {\n        if (pointers[i].pointerId == event.pointerId) {\n          pointers.splice(i, 1);\n          return;\n        }\n      }\n    }\n    function trackPointer(event) {\n      let position = pointerPositions[event.pointerId];\n      if (position === void 0) {\n        position = new three__WEBPACK_IMPORTED_MODULE_0__.Vector2();\n        pointerPositions[event.pointerId] = position;\n      }\n      position.set(event.pageX, event.pageY);\n    }\n    function getSecondPointerPosition(event) {\n      const pointer = event.pointerId === pointers[0].pointerId ? pointers[1] : pointers[0];\n      return pointerPositions[pointer.pointerId];\n    }\n    if (domElement !== void 0)\n      this.connect(domElement);\n    this.update();\n  }\n}\nclass MapControls extends OrbitControls {\n  constructor(object, domElement) {\n    super(object, domElement);\n    this.screenSpacePanning = false;\n    this.mouseButtons.LEFT = three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.PAN;\n    this.mouseButtons.RIGHT = three__WEBPACK_IMPORTED_MODULE_0__.MOUSE.ROTATE;\n    this.touches.ONE = three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.PAN;\n    this.touches.TWO = three__WEBPACK_IMPORTED_MODULE_0__.TOUCH.DOLLY_ROTATE;\n  }\n}\n\n//# sourceMappingURL=OrbitControls.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvdGhyZWUtc3RkbGliL2NvbnRyb2xzL09yYml0Q29udHJvbHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQSw4RUFBOEUsNkRBQTZEO0FBQzNJO0FBQ0E7QUFDQTtBQUNBO0FBQ2tKO0FBQ2xKLGlCQUFpQixzQ0FBRztBQUNwQixtQkFBbUIsd0NBQUs7QUFDeEI7QUFDQTtBQUNBLDRCQUE0QixrREFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywwQ0FBTztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RDtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDRFQUE0RTtBQUM5RztBQUNBO0FBQ0EsWUFBWSx3Q0FBSztBQUNqQixjQUFjLHdDQUFLO0FBQ25CLGFBQWEsd0NBQUs7QUFDbEIsS0FBSztBQUNMO0FBQ0EscUNBQXFDLEtBQUssd0NBQUssY0FBYyx3Q0FBSyxZQUFZO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsMENBQU87QUFDaEMscUJBQXFCLDBDQUFPO0FBQzVCLHVCQUF1Qiw2Q0FBVTtBQUNqQztBQUNBLCtCQUErQiwwQ0FBTztBQUN0QyxpQ0FBaUMsNkNBQVU7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLG9EQUFpQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaLG9DQUFvQywwQ0FBTztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywwQ0FBTztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsaUNBQWlDLHFEQUFrQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQix5QkFBeUI7QUFDekIsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw0Q0FBUztBQUNuQywrQkFBK0IsNENBQVM7QUFDeEM7QUFDQSwwQkFBMEIsMENBQU87QUFDakMsNEJBQTRCLDBDQUFPO0FBQ25DLDBCQUEwQiwwQ0FBTztBQUNqQyw0QkFBNEIsMENBQU87QUFDbkMseUJBQXlCLDBDQUFPO0FBQ2hDLHVCQUF1QiwwQ0FBTztBQUM5Qix5QkFBeUIsMENBQU87QUFDaEMsMkJBQTJCLDBDQUFPO0FBQ2xDLHlCQUF5QiwwQ0FBTztBQUNoQywyQkFBMkIsMENBQU87QUFDbEMsK0JBQStCLDBDQUFPO0FBQ3RDLHNCQUFzQiwwQ0FBTztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDBDQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxvQkFBb0IsMENBQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLHlCQUF5QiwwQ0FBTztBQUNoQztBQUNBO0FBQ0EsK0NBQStDLG9EQUFpQjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDRDQUE0QyxxREFBa0I7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGtDQUFrQyxvREFBaUIsZ0VBQWdFLHFEQUFrQjtBQUNySTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG9EQUFpQixnRUFBZ0UscURBQWtCO0FBQ3JJO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx3Q0FBSztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx3Q0FBSztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsd0NBQUs7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHdDQUFLO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0NBQUs7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix3Q0FBSztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHdDQUFLO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixxQkFBcUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDBDQUFPO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsd0NBQUs7QUFDbEMsOEJBQThCLHdDQUFLO0FBQ25DLHVCQUF1Qix3Q0FBSztBQUM1Qix1QkFBdUIsd0NBQUs7QUFDNUI7QUFDQTtBQUlFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW5hcnRfc2l0ZS8uL25vZGVfbW9kdWxlcy90aHJlZS1zdGRsaWIvY29udHJvbHMvT3JiaXRDb250cm9scy5qcz85MGIyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZOb3JtYWxQcm9wID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ga2V5IGluIG9iaiA/IF9fZGVmUHJvcChvYmosIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZSB9KSA6IG9ialtrZXldID0gdmFsdWU7XG52YXIgX19wdWJsaWNGaWVsZCA9IChvYmosIGtleSwgdmFsdWUpID0+IHtcbiAgX19kZWZOb3JtYWxQcm9wKG9iaiwgdHlwZW9mIGtleSAhPT0gXCJzeW1ib2xcIiA/IGtleSArIFwiXCIgOiBrZXksIHZhbHVlKTtcbiAgcmV0dXJuIHZhbHVlO1xufTtcbmltcG9ydCB7IFJheSwgUGxhbmUsIEV2ZW50RGlzcGF0Y2hlciwgVmVjdG9yMywgTU9VU0UsIFRPVUNILCBRdWF0ZXJuaW9uLCBQZXJzcGVjdGl2ZUNhbWVyYSwgT3J0aG9ncmFwaGljQ2FtZXJhLCBTcGhlcmljYWwsIFZlY3RvcjIgfSBmcm9tIFwidGhyZWVcIjtcbmNvbnN0IF9yYXkgPSBuZXcgUmF5KCk7XG5jb25zdCBfcGxhbmUgPSBuZXcgUGxhbmUoKTtcbmNvbnN0IFRJTFRfTElNSVQgPSBNYXRoLmNvcyg3MCAqIChNYXRoLlBJIC8gMTgwKSk7XG5jb25zdCBtb2R1bG9XcmFwQXJvdW5kID0gKG9mZnNldCwgY2FwYWNpdHkpID0+IChvZmZzZXQgJSBjYXBhY2l0eSArIGNhcGFjaXR5KSAlIGNhcGFjaXR5O1xuY2xhc3MgT3JiaXRDb250cm9scyBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG4gIGNvbnN0cnVjdG9yKG9iamVjdCwgZG9tRWxlbWVudCkge1xuICAgIHN1cGVyKCk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm9iamVjdFwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZG9tRWxlbWVudFwiKTtcbiAgICAvLyBTZXQgdG8gZmFsc2UgdG8gZGlzYWJsZSB0aGlzIGNvbnRyb2xcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZW5hYmxlZFwiLCB0cnVlKTtcbiAgICAvLyBcInRhcmdldFwiIHNldHMgdGhlIGxvY2F0aW9uIG9mIGZvY3VzLCB3aGVyZSB0aGUgb2JqZWN0IG9yYml0cyBhcm91bmRcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwidGFyZ2V0XCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIC8vIEhvdyBmYXIgeW91IGNhbiBkb2xseSBpbiBhbmQgb3V0ICggUGVyc3BlY3RpdmVDYW1lcmEgb25seSApXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm1pbkRpc3RhbmNlXCIsIDApO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJtYXhEaXN0YW5jZVwiLCBJbmZpbml0eSk7XG4gICAgLy8gSG93IGZhciB5b3UgY2FuIHpvb20gaW4gYW5kIG91dCAoIE9ydGhvZ3JhcGhpY0NhbWVyYSBvbmx5IClcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwibWluWm9vbVwiLCAwKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwibWF4Wm9vbVwiLCBJbmZpbml0eSk7XG4gICAgLy8gSG93IGZhciB5b3UgY2FuIG9yYml0IHZlcnRpY2FsbHksIHVwcGVyIGFuZCBsb3dlciBsaW1pdHMuXG4gICAgLy8gUmFuZ2UgaXMgMCB0byBNYXRoLlBJIHJhZGlhbnMuXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm1pblBvbGFyQW5nbGVcIiwgMCk7XG4gICAgLy8gcmFkaWFuc1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJtYXhQb2xhckFuZ2xlXCIsIE1hdGguUEkpO1xuICAgIC8vIHJhZGlhbnNcbiAgICAvLyBIb3cgZmFyIHlvdSBjYW4gb3JiaXQgaG9yaXpvbnRhbGx5LCB1cHBlciBhbmQgbG93ZXIgbGltaXRzLlxuICAgIC8vIElmIHNldCwgdGhlIGludGVydmFsIFsgbWluLCBtYXggXSBtdXN0IGJlIGEgc3ViLWludGVydmFsIG9mIFsgLSAyIFBJLCAyIFBJIF0sIHdpdGggKCBtYXggLSBtaW4gPCAyIFBJIClcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwibWluQXppbXV0aEFuZ2xlXCIsIC1JbmZpbml0eSk7XG4gICAgLy8gcmFkaWFuc1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJtYXhBemltdXRoQW5nbGVcIiwgSW5maW5pdHkpO1xuICAgIC8vIHJhZGlhbnNcbiAgICAvLyBTZXQgdG8gdHJ1ZSB0byBlbmFibGUgZGFtcGluZyAoaW5lcnRpYSlcbiAgICAvLyBJZiBkYW1waW5nIGlzIGVuYWJsZWQsIHlvdSBtdXN0IGNhbGwgY29udHJvbHMudXBkYXRlKCkgaW4geW91ciBhbmltYXRpb24gbG9vcFxuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJlbmFibGVEYW1waW5nXCIsIGZhbHNlKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZGFtcGluZ0ZhY3RvclwiLCAwLjA1KTtcbiAgICAvLyBUaGlzIG9wdGlvbiBhY3R1YWxseSBlbmFibGVzIGRvbGx5aW5nIGluIGFuZCBvdXQ7IGxlZnQgYXMgXCJ6b29tXCIgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LlxuICAgIC8vIFNldCB0byBmYWxzZSB0byBkaXNhYmxlIHpvb21pbmdcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZW5hYmxlWm9vbVwiLCB0cnVlKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiem9vbVNwZWVkXCIsIDEpO1xuICAgIC8vIFNldCB0byBmYWxzZSB0byBkaXNhYmxlIHJvdGF0aW5nXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImVuYWJsZVJvdGF0ZVwiLCB0cnVlKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwicm90YXRlU3BlZWRcIiwgMSk7XG4gICAgLy8gU2V0IHRvIGZhbHNlIHRvIGRpc2FibGUgcGFubmluZ1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJlbmFibGVQYW5cIiwgdHJ1ZSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInBhblNwZWVkXCIsIDEpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzY3JlZW5TcGFjZVBhbm5pbmdcIiwgdHJ1ZSk7XG4gICAgLy8gaWYgZmFsc2UsIHBhbiBvcnRob2dvbmFsIHRvIHdvcmxkLXNwYWNlIGRpcmVjdGlvbiBjYW1lcmEudXBcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwia2V5UGFuU3BlZWRcIiwgNyk7XG4gICAgLy8gcGl4ZWxzIG1vdmVkIHBlciBhcnJvdyBrZXkgcHVzaFxuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ6b29tVG9DdXJzb3JcIiwgZmFsc2UpO1xuICAgIC8vIFNldCB0byB0cnVlIHRvIGF1dG9tYXRpY2FsbHkgcm90YXRlIGFyb3VuZCB0aGUgdGFyZ2V0XG4gICAgLy8gSWYgYXV0by1yb3RhdGUgaXMgZW5hYmxlZCwgeW91IG11c3QgY2FsbCBjb250cm9scy51cGRhdGUoKSBpbiB5b3VyIGFuaW1hdGlvbiBsb29wXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImF1dG9Sb3RhdGVcIiwgZmFsc2UpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJhdXRvUm90YXRlU3BlZWRcIiwgMik7XG4gICAgLy8gMzAgc2Vjb25kcyBwZXIgb3JiaXQgd2hlbiBmcHMgaXMgNjBcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwicmV2ZXJzZU9yYml0XCIsIGZhbHNlKTtcbiAgICAvLyB0cnVlIGlmIHlvdSB3YW50IHRvIHJldmVyc2UgdGhlIG9yYml0IHRvIG1vdXNlIGRyYWcgZnJvbSBsZWZ0IHRvIHJpZ2h0ID0gb3JiaXRzIGxlZnRcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwicmV2ZXJzZUhvcml6b250YWxPcmJpdFwiLCBmYWxzZSk7XG4gICAgLy8gdHJ1ZSBpZiB5b3Ugd2FudCB0byByZXZlcnNlIHRoZSBob3Jpem9udGFsIG9yYml0IGRpcmVjdGlvblxuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJyZXZlcnNlVmVydGljYWxPcmJpdFwiLCBmYWxzZSk7XG4gICAgLy8gdHJ1ZSBpZiB5b3Ugd2FudCB0byByZXZlcnNlIHRoZSB2ZXJ0aWNhbCBvcmJpdCBkaXJlY3Rpb25cbiAgICAvLyBUaGUgZm91ciBhcnJvdyBrZXlzXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImtleXNcIiwgeyBMRUZUOiBcIkFycm93TGVmdFwiLCBVUDogXCJBcnJvd1VwXCIsIFJJR0hUOiBcIkFycm93UmlnaHRcIiwgQk9UVE9NOiBcIkFycm93RG93blwiIH0pO1xuICAgIC8vIE1vdXNlIGJ1dHRvbnNcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwibW91c2VCdXR0b25zXCIsIHtcbiAgICAgIExFRlQ6IE1PVVNFLlJPVEFURSxcbiAgICAgIE1JRERMRTogTU9VU0UuRE9MTFksXG4gICAgICBSSUdIVDogTU9VU0UuUEFOXG4gICAgfSk7XG4gICAgLy8gVG91Y2ggZmluZ2Vyc1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0b3VjaGVzXCIsIHsgT05FOiBUT1VDSC5ST1RBVEUsIFRXTzogVE9VQ0guRE9MTFlfUEFOIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0YXJnZXQwXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwb3NpdGlvbjBcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInpvb20wXCIpO1xuICAgIC8vIHRoZSB0YXJnZXQgRE9NIGVsZW1lbnQgZm9yIGtleSBldmVudHNcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiX2RvbUVsZW1lbnRLZXlFdmVudHNcIiwgbnVsbCk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImdldFBvbGFyQW5nbGVcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImdldEF6aW11dGhhbEFuZ2xlXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzZXRQb2xhckFuZ2xlXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzZXRBemltdXRoYWxBbmdsZVwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZ2V0RGlzdGFuY2VcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImxpc3RlblRvS2V5RXZlbnRzXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzdG9wTGlzdGVuVG9LZXlFdmVudHNcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInNhdmVTdGF0ZVwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwicmVzZXRcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInVwZGF0ZVwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiY29ubmVjdFwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZGlzcG9zZVwiKTtcbiAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgICB0aGlzLmRvbUVsZW1lbnQgPSBkb21FbGVtZW50O1xuICAgIHRoaXMudGFyZ2V0MCA9IHRoaXMudGFyZ2V0LmNsb25lKCk7XG4gICAgdGhpcy5wb3NpdGlvbjAgPSB0aGlzLm9iamVjdC5wb3NpdGlvbi5jbG9uZSgpO1xuICAgIHRoaXMuem9vbTAgPSB0aGlzLm9iamVjdC56b29tO1xuICAgIHRoaXMuZ2V0UG9sYXJBbmdsZSA9ICgpID0+IHNwaGVyaWNhbC5waGk7XG4gICAgdGhpcy5nZXRBemltdXRoYWxBbmdsZSA9ICgpID0+IHNwaGVyaWNhbC50aGV0YTtcbiAgICB0aGlzLnNldFBvbGFyQW5nbGUgPSAodmFsdWUpID0+IHtcbiAgICAgIGxldCBwaGkgPSBtb2R1bG9XcmFwQXJvdW5kKHZhbHVlLCAyICogTWF0aC5QSSk7XG4gICAgICBsZXQgY3VycmVudFBoaSA9IHNwaGVyaWNhbC5waGk7XG4gICAgICBpZiAoY3VycmVudFBoaSA8IDApXG4gICAgICAgIGN1cnJlbnRQaGkgKz0gMiAqIE1hdGguUEk7XG4gICAgICBpZiAocGhpIDwgMClcbiAgICAgICAgcGhpICs9IDIgKiBNYXRoLlBJO1xuICAgICAgbGV0IHBoaURpc3QgPSBNYXRoLmFicyhwaGkgLSBjdXJyZW50UGhpKTtcbiAgICAgIGlmICgyICogTWF0aC5QSSAtIHBoaURpc3QgPCBwaGlEaXN0KSB7XG4gICAgICAgIGlmIChwaGkgPCBjdXJyZW50UGhpKSB7XG4gICAgICAgICAgcGhpICs9IDIgKiBNYXRoLlBJO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRQaGkgKz0gMiAqIE1hdGguUEk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNwaGVyaWNhbERlbHRhLnBoaSA9IHBoaSAtIGN1cnJlbnRQaGk7XG4gICAgICBzY29wZS51cGRhdGUoKTtcbiAgICB9O1xuICAgIHRoaXMuc2V0QXppbXV0aGFsQW5nbGUgPSAodmFsdWUpID0+IHtcbiAgICAgIGxldCB0aGV0YSA9IG1vZHVsb1dyYXBBcm91bmQodmFsdWUsIDIgKiBNYXRoLlBJKTtcbiAgICAgIGxldCBjdXJyZW50VGhldGEgPSBzcGhlcmljYWwudGhldGE7XG4gICAgICBpZiAoY3VycmVudFRoZXRhIDwgMClcbiAgICAgICAgY3VycmVudFRoZXRhICs9IDIgKiBNYXRoLlBJO1xuICAgICAgaWYgKHRoZXRhIDwgMClcbiAgICAgICAgdGhldGEgKz0gMiAqIE1hdGguUEk7XG4gICAgICBsZXQgdGhldGFEaXN0ID0gTWF0aC5hYnModGhldGEgLSBjdXJyZW50VGhldGEpO1xuICAgICAgaWYgKDIgKiBNYXRoLlBJIC0gdGhldGFEaXN0IDwgdGhldGFEaXN0KSB7XG4gICAgICAgIGlmICh0aGV0YSA8IGN1cnJlbnRUaGV0YSkge1xuICAgICAgICAgIHRoZXRhICs9IDIgKiBNYXRoLlBJO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRUaGV0YSArPSAyICogTWF0aC5QSTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc3BoZXJpY2FsRGVsdGEudGhldGEgPSB0aGV0YSAtIGN1cnJlbnRUaGV0YTtcbiAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgIH07XG4gICAgdGhpcy5nZXREaXN0YW5jZSA9ICgpID0+IHNjb3BlLm9iamVjdC5wb3NpdGlvbi5kaXN0YW5jZVRvKHNjb3BlLnRhcmdldCk7XG4gICAgdGhpcy5saXN0ZW5Ub0tleUV2ZW50cyA9IChkb21FbGVtZW50MikgPT4ge1xuICAgICAgZG9tRWxlbWVudDIuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgIHRoaXMuX2RvbUVsZW1lbnRLZXlFdmVudHMgPSBkb21FbGVtZW50MjtcbiAgICB9O1xuICAgIHRoaXMuc3RvcExpc3RlblRvS2V5RXZlbnRzID0gKCkgPT4ge1xuICAgICAgdGhpcy5fZG9tRWxlbWVudEtleUV2ZW50cy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBvbktleURvd24pO1xuICAgICAgdGhpcy5fZG9tRWxlbWVudEtleUV2ZW50cyA9IG51bGw7XG4gICAgfTtcbiAgICB0aGlzLnNhdmVTdGF0ZSA9ICgpID0+IHtcbiAgICAgIHNjb3BlLnRhcmdldDAuY29weShzY29wZS50YXJnZXQpO1xuICAgICAgc2NvcGUucG9zaXRpb24wLmNvcHkoc2NvcGUub2JqZWN0LnBvc2l0aW9uKTtcbiAgICAgIHNjb3BlLnpvb20wID0gc2NvcGUub2JqZWN0Lnpvb207XG4gICAgfTtcbiAgICB0aGlzLnJlc2V0ID0gKCkgPT4ge1xuICAgICAgc2NvcGUudGFyZ2V0LmNvcHkoc2NvcGUudGFyZ2V0MCk7XG4gICAgICBzY29wZS5vYmplY3QucG9zaXRpb24uY29weShzY29wZS5wb3NpdGlvbjApO1xuICAgICAgc2NvcGUub2JqZWN0Lnpvb20gPSBzY29wZS56b29tMDtcbiAgICAgIHNjb3BlLm9iamVjdC51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICBzY29wZS5kaXNwYXRjaEV2ZW50KGNoYW5nZUV2ZW50KTtcbiAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgICAgc3RhdGUgPSBTVEFURS5OT05FO1xuICAgIH07XG4gICAgdGhpcy51cGRhdGUgPSAoKCkgPT4ge1xuICAgICAgY29uc3Qgb2Zmc2V0ID0gbmV3IFZlY3RvcjMoKTtcbiAgICAgIGNvbnN0IHVwID0gbmV3IFZlY3RvcjMoMCwgMSwgMCk7XG4gICAgICBjb25zdCBxdWF0ID0gbmV3IFF1YXRlcm5pb24oKS5zZXRGcm9tVW5pdFZlY3RvcnMob2JqZWN0LnVwLCB1cCk7XG4gICAgICBjb25zdCBxdWF0SW52ZXJzZSA9IHF1YXQuY2xvbmUoKS5pbnZlcnQoKTtcbiAgICAgIGNvbnN0IGxhc3RQb3NpdGlvbiA9IG5ldyBWZWN0b3IzKCk7XG4gICAgICBjb25zdCBsYXN0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7XG4gICAgICBjb25zdCB0d29QSSA9IDIgKiBNYXRoLlBJO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICAgICAgY29uc3QgcG9zaXRpb24gPSBzY29wZS5vYmplY3QucG9zaXRpb247XG4gICAgICAgIHF1YXQuc2V0RnJvbVVuaXRWZWN0b3JzKG9iamVjdC51cCwgdXApO1xuICAgICAgICBxdWF0SW52ZXJzZS5jb3B5KHF1YXQpLmludmVydCgpO1xuICAgICAgICBvZmZzZXQuY29weShwb3NpdGlvbikuc3ViKHNjb3BlLnRhcmdldCk7XG4gICAgICAgIG9mZnNldC5hcHBseVF1YXRlcm5pb24ocXVhdCk7XG4gICAgICAgIHNwaGVyaWNhbC5zZXRGcm9tVmVjdG9yMyhvZmZzZXQpO1xuICAgICAgICBpZiAoc2NvcGUuYXV0b1JvdGF0ZSAmJiBzdGF0ZSA9PT0gU1RBVEUuTk9ORSkge1xuICAgICAgICAgIHJvdGF0ZUxlZnQoZ2V0QXV0b1JvdGF0aW9uQW5nbGUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNjb3BlLmVuYWJsZURhbXBpbmcpIHtcbiAgICAgICAgICBzcGhlcmljYWwudGhldGEgKz0gc3BoZXJpY2FsRGVsdGEudGhldGEgKiBzY29wZS5kYW1waW5nRmFjdG9yO1xuICAgICAgICAgIHNwaGVyaWNhbC5waGkgKz0gc3BoZXJpY2FsRGVsdGEucGhpICogc2NvcGUuZGFtcGluZ0ZhY3RvcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzcGhlcmljYWwudGhldGEgKz0gc3BoZXJpY2FsRGVsdGEudGhldGE7XG4gICAgICAgICAgc3BoZXJpY2FsLnBoaSArPSBzcGhlcmljYWxEZWx0YS5waGk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG1pbiA9IHNjb3BlLm1pbkF6aW11dGhBbmdsZTtcbiAgICAgICAgbGV0IG1heCA9IHNjb3BlLm1heEF6aW11dGhBbmdsZTtcbiAgICAgICAgaWYgKGlzRmluaXRlKG1pbikgJiYgaXNGaW5pdGUobWF4KSkge1xuICAgICAgICAgIGlmIChtaW4gPCAtTWF0aC5QSSlcbiAgICAgICAgICAgIG1pbiArPSB0d29QSTtcbiAgICAgICAgICBlbHNlIGlmIChtaW4gPiBNYXRoLlBJKVxuICAgICAgICAgICAgbWluIC09IHR3b1BJO1xuICAgICAgICAgIGlmIChtYXggPCAtTWF0aC5QSSlcbiAgICAgICAgICAgIG1heCArPSB0d29QSTtcbiAgICAgICAgICBlbHNlIGlmIChtYXggPiBNYXRoLlBJKVxuICAgICAgICAgICAgbWF4IC09IHR3b1BJO1xuICAgICAgICAgIGlmIChtaW4gPD0gbWF4KSB7XG4gICAgICAgICAgICBzcGhlcmljYWwudGhldGEgPSBNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgc3BoZXJpY2FsLnRoZXRhKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNwaGVyaWNhbC50aGV0YSA9IHNwaGVyaWNhbC50aGV0YSA+IChtaW4gKyBtYXgpIC8gMiA/IE1hdGgubWF4KG1pbiwgc3BoZXJpY2FsLnRoZXRhKSA6IE1hdGgubWluKG1heCwgc3BoZXJpY2FsLnRoZXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3BoZXJpY2FsLnBoaSA9IE1hdGgubWF4KHNjb3BlLm1pblBvbGFyQW5nbGUsIE1hdGgubWluKHNjb3BlLm1heFBvbGFyQW5nbGUsIHNwaGVyaWNhbC5waGkpKTtcbiAgICAgICAgc3BoZXJpY2FsLm1ha2VTYWZlKCk7XG4gICAgICAgIGlmIChzY29wZS5lbmFibGVEYW1waW5nID09PSB0cnVlKSB7XG4gICAgICAgICAgc2NvcGUudGFyZ2V0LmFkZFNjYWxlZFZlY3RvcihwYW5PZmZzZXQsIHNjb3BlLmRhbXBpbmdGYWN0b3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjb3BlLnRhcmdldC5hZGQocGFuT2Zmc2V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NvcGUuem9vbVRvQ3Vyc29yICYmIHBlcmZvcm1DdXJzb3Jab29tIHx8IHNjb3BlLm9iamVjdC5pc09ydGhvZ3JhcGhpY0NhbWVyYSkge1xuICAgICAgICAgIHNwaGVyaWNhbC5yYWRpdXMgPSBjbGFtcERpc3RhbmNlKHNwaGVyaWNhbC5yYWRpdXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNwaGVyaWNhbC5yYWRpdXMgPSBjbGFtcERpc3RhbmNlKHNwaGVyaWNhbC5yYWRpdXMgKiBzY2FsZSk7XG4gICAgICAgIH1cbiAgICAgICAgb2Zmc2V0LnNldEZyb21TcGhlcmljYWwoc3BoZXJpY2FsKTtcbiAgICAgICAgb2Zmc2V0LmFwcGx5UXVhdGVybmlvbihxdWF0SW52ZXJzZSk7XG4gICAgICAgIHBvc2l0aW9uLmNvcHkoc2NvcGUudGFyZ2V0KS5hZGQob2Zmc2V0KTtcbiAgICAgICAgaWYgKCFzY29wZS5vYmplY3QubWF0cml4QXV0b1VwZGF0ZSlcbiAgICAgICAgICBzY29wZS5vYmplY3QudXBkYXRlTWF0cml4KCk7XG4gICAgICAgIHNjb3BlLm9iamVjdC5sb29rQXQoc2NvcGUudGFyZ2V0KTtcbiAgICAgICAgaWYgKHNjb3BlLmVuYWJsZURhbXBpbmcgPT09IHRydWUpIHtcbiAgICAgICAgICBzcGhlcmljYWxEZWx0YS50aGV0YSAqPSAxIC0gc2NvcGUuZGFtcGluZ0ZhY3RvcjtcbiAgICAgICAgICBzcGhlcmljYWxEZWx0YS5waGkgKj0gMSAtIHNjb3BlLmRhbXBpbmdGYWN0b3I7XG4gICAgICAgICAgcGFuT2Zmc2V0Lm11bHRpcGx5U2NhbGFyKDEgLSBzY29wZS5kYW1waW5nRmFjdG9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzcGhlcmljYWxEZWx0YS5zZXQoMCwgMCwgMCk7XG4gICAgICAgICAgcGFuT2Zmc2V0LnNldCgwLCAwLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgem9vbUNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKHNjb3BlLnpvb21Ub0N1cnNvciAmJiBwZXJmb3JtQ3Vyc29yWm9vbSkge1xuICAgICAgICAgIGxldCBuZXdSYWRpdXMgPSBudWxsO1xuICAgICAgICAgIGlmIChzY29wZS5vYmplY3QgaW5zdGFuY2VvZiBQZXJzcGVjdGl2ZUNhbWVyYSAmJiBzY29wZS5vYmplY3QuaXNQZXJzcGVjdGl2ZUNhbWVyYSkge1xuICAgICAgICAgICAgY29uc3QgcHJldlJhZGl1cyA9IG9mZnNldC5sZW5ndGgoKTtcbiAgICAgICAgICAgIG5ld1JhZGl1cyA9IGNsYW1wRGlzdGFuY2UocHJldlJhZGl1cyAqIHNjYWxlKTtcbiAgICAgICAgICAgIGNvbnN0IHJhZGl1c0RlbHRhID0gcHJldlJhZGl1cyAtIG5ld1JhZGl1cztcbiAgICAgICAgICAgIHNjb3BlLm9iamVjdC5wb3NpdGlvbi5hZGRTY2FsZWRWZWN0b3IoZG9sbHlEaXJlY3Rpb24sIHJhZGl1c0RlbHRhKTtcbiAgICAgICAgICAgIHNjb3BlLm9iamVjdC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoc2NvcGUub2JqZWN0LmlzT3J0aG9ncmFwaGljQ2FtZXJhKSB7XG4gICAgICAgICAgICBjb25zdCBtb3VzZUJlZm9yZSA9IG5ldyBWZWN0b3IzKG1vdXNlLngsIG1vdXNlLnksIDApO1xuICAgICAgICAgICAgbW91c2VCZWZvcmUudW5wcm9qZWN0KHNjb3BlLm9iamVjdCk7XG4gICAgICAgICAgICBzY29wZS5vYmplY3Quem9vbSA9IE1hdGgubWF4KHNjb3BlLm1pblpvb20sIE1hdGgubWluKHNjb3BlLm1heFpvb20sIHNjb3BlLm9iamVjdC56b29tIC8gc2NhbGUpKTtcbiAgICAgICAgICAgIHNjb3BlLm9iamVjdC51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICAgICAgICB6b29tQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBtb3VzZUFmdGVyID0gbmV3IFZlY3RvcjMobW91c2UueCwgbW91c2UueSwgMCk7XG4gICAgICAgICAgICBtb3VzZUFmdGVyLnVucHJvamVjdChzY29wZS5vYmplY3QpO1xuICAgICAgICAgICAgc2NvcGUub2JqZWN0LnBvc2l0aW9uLnN1Yihtb3VzZUFmdGVyKS5hZGQobW91c2VCZWZvcmUpO1xuICAgICAgICAgICAgc2NvcGUub2JqZWN0LnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG4gICAgICAgICAgICBuZXdSYWRpdXMgPSBvZmZzZXQubGVuZ3RoKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIldBUk5JTkc6IE9yYml0Q29udHJvbHMuanMgZW5jb3VudGVyZWQgYW4gdW5rbm93biBjYW1lcmEgdHlwZSAtIHpvb20gdG8gY3Vyc29yIGRpc2FibGVkLlwiKTtcbiAgICAgICAgICAgIHNjb3BlLnpvb21Ub0N1cnNvciA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobmV3UmFkaXVzICE9PSBudWxsKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuc2NyZWVuU3BhY2VQYW5uaW5nKSB7XG4gICAgICAgICAgICAgIHNjb3BlLnRhcmdldC5zZXQoMCwgMCwgLTEpLnRyYW5zZm9ybURpcmVjdGlvbihzY29wZS5vYmplY3QubWF0cml4KS5tdWx0aXBseVNjYWxhcihuZXdSYWRpdXMpLmFkZChzY29wZS5vYmplY3QucG9zaXRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX3JheS5vcmlnaW4uY29weShzY29wZS5vYmplY3QucG9zaXRpb24pO1xuICAgICAgICAgICAgICBfcmF5LmRpcmVjdGlvbi5zZXQoMCwgMCwgLTEpLnRyYW5zZm9ybURpcmVjdGlvbihzY29wZS5vYmplY3QubWF0cml4KTtcbiAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHNjb3BlLm9iamVjdC51cC5kb3QoX3JheS5kaXJlY3Rpb24pKSA8IFRJTFRfTElNSVQpIHtcbiAgICAgICAgICAgICAgICBvYmplY3QubG9va0F0KHNjb3BlLnRhcmdldCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgX3BsYW5lLnNldEZyb21Ob3JtYWxBbmRDb3BsYW5hclBvaW50KHNjb3BlLm9iamVjdC51cCwgc2NvcGUudGFyZ2V0KTtcbiAgICAgICAgICAgICAgICBfcmF5LmludGVyc2VjdFBsYW5lKF9wbGFuZSwgc2NvcGUudGFyZ2V0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChzY29wZS5vYmplY3QgaW5zdGFuY2VvZiBPcnRob2dyYXBoaWNDYW1lcmEgJiYgc2NvcGUub2JqZWN0LmlzT3J0aG9ncmFwaGljQ2FtZXJhKSB7XG4gICAgICAgICAgem9vbUNoYW5nZWQgPSBzY2FsZSAhPT0gMTtcbiAgICAgICAgICBpZiAoem9vbUNoYW5nZWQpIHtcbiAgICAgICAgICAgIHNjb3BlLm9iamVjdC56b29tID0gTWF0aC5tYXgoc2NvcGUubWluWm9vbSwgTWF0aC5taW4oc2NvcGUubWF4Wm9vbSwgc2NvcGUub2JqZWN0Lnpvb20gLyBzY2FsZSkpO1xuICAgICAgICAgICAgc2NvcGUub2JqZWN0LnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2NhbGUgPSAxO1xuICAgICAgICBwZXJmb3JtQ3Vyc29yWm9vbSA9IGZhbHNlO1xuICAgICAgICBpZiAoem9vbUNoYW5nZWQgfHwgbGFzdFBvc2l0aW9uLmRpc3RhbmNlVG9TcXVhcmVkKHNjb3BlLm9iamVjdC5wb3NpdGlvbikgPiBFUFMgfHwgOCAqICgxIC0gbGFzdFF1YXRlcm5pb24uZG90KHNjb3BlLm9iamVjdC5xdWF0ZXJuaW9uKSkgPiBFUFMpIHtcbiAgICAgICAgICBzY29wZS5kaXNwYXRjaEV2ZW50KGNoYW5nZUV2ZW50KTtcbiAgICAgICAgICBsYXN0UG9zaXRpb24uY29weShzY29wZS5vYmplY3QucG9zaXRpb24pO1xuICAgICAgICAgIGxhc3RRdWF0ZXJuaW9uLmNvcHkoc2NvcGUub2JqZWN0LnF1YXRlcm5pb24pO1xuICAgICAgICAgIHpvb21DaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICB9KSgpO1xuICAgIHRoaXMuY29ubmVjdCA9IChkb21FbGVtZW50MikgPT4ge1xuICAgICAgc2NvcGUuZG9tRWxlbWVudCA9IGRvbUVsZW1lbnQyO1xuICAgICAgc2NvcGUuZG9tRWxlbWVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwibm9uZVwiO1xuICAgICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgb25Db250ZXh0TWVudSk7XG4gICAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCBvblBvaW50ZXJEb3duKTtcbiAgICAgIHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJjYW5jZWxcIiwgb25Qb2ludGVyVXApO1xuICAgICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgb25Nb3VzZVdoZWVsKTtcbiAgICB9O1xuICAgIHRoaXMuZGlzcG9zZSA9ICgpID0+IHtcbiAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mO1xuICAgICAgaWYgKHNjb3BlLmRvbUVsZW1lbnQpIHtcbiAgICAgICAgc2NvcGUuZG9tRWxlbWVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwiYXV0b1wiO1xuICAgICAgfVxuICAgICAgKF9hID0gc2NvcGUuZG9tRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBvbkNvbnRleHRNZW51KTtcbiAgICAgIChfYiA9IHNjb3BlLmRvbUVsZW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYi5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgb25Qb2ludGVyRG93bik7XG4gICAgICAoX2MgPSBzY29wZS5kb21FbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2MucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJjYW5jZWxcIiwgb25Qb2ludGVyVXApO1xuICAgICAgKF9kID0gc2NvcGUuZG9tRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9kLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCBvbk1vdXNlV2hlZWwpO1xuICAgICAgKF9lID0gc2NvcGUuZG9tRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9lLm93bmVyRG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIG9uUG9pbnRlck1vdmUpO1xuICAgICAgKF9mID0gc2NvcGUuZG9tRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9mLm93bmVyRG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCBvblBvaW50ZXJVcCk7XG4gICAgICBpZiAoc2NvcGUuX2RvbUVsZW1lbnRLZXlFdmVudHMgIT09IG51bGwpIHtcbiAgICAgICAgc2NvcGUuX2RvbUVsZW1lbnRLZXlFdmVudHMucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHNjb3BlID0gdGhpcztcbiAgICBjb25zdCBjaGFuZ2VFdmVudCA9IHsgdHlwZTogXCJjaGFuZ2VcIiB9O1xuICAgIGNvbnN0IHN0YXJ0RXZlbnQgPSB7IHR5cGU6IFwic3RhcnRcIiB9O1xuICAgIGNvbnN0IGVuZEV2ZW50ID0geyB0eXBlOiBcImVuZFwiIH07XG4gICAgY29uc3QgU1RBVEUgPSB7XG4gICAgICBOT05FOiAtMSxcbiAgICAgIFJPVEFURTogMCxcbiAgICAgIERPTExZOiAxLFxuICAgICAgUEFOOiAyLFxuICAgICAgVE9VQ0hfUk9UQVRFOiAzLFxuICAgICAgVE9VQ0hfUEFOOiA0LFxuICAgICAgVE9VQ0hfRE9MTFlfUEFOOiA1LFxuICAgICAgVE9VQ0hfRE9MTFlfUk9UQVRFOiA2XG4gICAgfTtcbiAgICBsZXQgc3RhdGUgPSBTVEFURS5OT05FO1xuICAgIGNvbnN0IEVQUyA9IDFlLTY7XG4gICAgY29uc3Qgc3BoZXJpY2FsID0gbmV3IFNwaGVyaWNhbCgpO1xuICAgIGNvbnN0IHNwaGVyaWNhbERlbHRhID0gbmV3IFNwaGVyaWNhbCgpO1xuICAgIGxldCBzY2FsZSA9IDE7XG4gICAgY29uc3QgcGFuT2Zmc2V0ID0gbmV3IFZlY3RvcjMoKTtcbiAgICBjb25zdCByb3RhdGVTdGFydCA9IG5ldyBWZWN0b3IyKCk7XG4gICAgY29uc3Qgcm90YXRlRW5kID0gbmV3IFZlY3RvcjIoKTtcbiAgICBjb25zdCByb3RhdGVEZWx0YSA9IG5ldyBWZWN0b3IyKCk7XG4gICAgY29uc3QgcGFuU3RhcnQgPSBuZXcgVmVjdG9yMigpO1xuICAgIGNvbnN0IHBhbkVuZCA9IG5ldyBWZWN0b3IyKCk7XG4gICAgY29uc3QgcGFuRGVsdGEgPSBuZXcgVmVjdG9yMigpO1xuICAgIGNvbnN0IGRvbGx5U3RhcnQgPSBuZXcgVmVjdG9yMigpO1xuICAgIGNvbnN0IGRvbGx5RW5kID0gbmV3IFZlY3RvcjIoKTtcbiAgICBjb25zdCBkb2xseURlbHRhID0gbmV3IFZlY3RvcjIoKTtcbiAgICBjb25zdCBkb2xseURpcmVjdGlvbiA9IG5ldyBWZWN0b3IzKCk7XG4gICAgY29uc3QgbW91c2UgPSBuZXcgVmVjdG9yMigpO1xuICAgIGxldCBwZXJmb3JtQ3Vyc29yWm9vbSA9IGZhbHNlO1xuICAgIGNvbnN0IHBvaW50ZXJzID0gW107XG4gICAgY29uc3QgcG9pbnRlclBvc2l0aW9ucyA9IHt9O1xuICAgIGZ1bmN0aW9uIGdldEF1dG9Sb3RhdGlvbkFuZ2xlKCkge1xuICAgICAgcmV0dXJuIDIgKiBNYXRoLlBJIC8gNjAgLyA2MCAqIHNjb3BlLmF1dG9Sb3RhdGVTcGVlZDtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0Wm9vbVNjYWxlKCkge1xuICAgICAgcmV0dXJuIE1hdGgucG93KDAuOTUsIHNjb3BlLnpvb21TcGVlZCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJvdGF0ZUxlZnQoYW5nbGUpIHtcbiAgICAgIGlmIChzY29wZS5yZXZlcnNlT3JiaXQgfHwgc2NvcGUucmV2ZXJzZUhvcml6b250YWxPcmJpdCkge1xuICAgICAgICBzcGhlcmljYWxEZWx0YS50aGV0YSArPSBhbmdsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNwaGVyaWNhbERlbHRhLnRoZXRhIC09IGFuZ2xlO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiByb3RhdGVVcChhbmdsZSkge1xuICAgICAgaWYgKHNjb3BlLnJldmVyc2VPcmJpdCB8fCBzY29wZS5yZXZlcnNlVmVydGljYWxPcmJpdCkge1xuICAgICAgICBzcGhlcmljYWxEZWx0YS5waGkgKz0gYW5nbGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGhlcmljYWxEZWx0YS5waGkgLT0gYW5nbGU7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHBhbkxlZnQgPSAoKCkgPT4ge1xuICAgICAgY29uc3QgdiA9IG5ldyBWZWN0b3IzKCk7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gcGFuTGVmdDIoZGlzdGFuY2UsIG9iamVjdE1hdHJpeCkge1xuICAgICAgICB2LnNldEZyb21NYXRyaXhDb2x1bW4ob2JqZWN0TWF0cml4LCAwKTtcbiAgICAgICAgdi5tdWx0aXBseVNjYWxhcigtZGlzdGFuY2UpO1xuICAgICAgICBwYW5PZmZzZXQuYWRkKHYpO1xuICAgICAgfTtcbiAgICB9KSgpO1xuICAgIGNvbnN0IHBhblVwID0gKCgpID0+IHtcbiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjdG9yMygpO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBhblVwMihkaXN0YW5jZSwgb2JqZWN0TWF0cml4KSB7XG4gICAgICAgIGlmIChzY29wZS5zY3JlZW5TcGFjZVBhbm5pbmcgPT09IHRydWUpIHtcbiAgICAgICAgICB2LnNldEZyb21NYXRyaXhDb2x1bW4ob2JqZWN0TWF0cml4LCAxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2LnNldEZyb21NYXRyaXhDb2x1bW4ob2JqZWN0TWF0cml4LCAwKTtcbiAgICAgICAgICB2LmNyb3NzVmVjdG9ycyhzY29wZS5vYmplY3QudXAsIHYpO1xuICAgICAgICB9XG4gICAgICAgIHYubXVsdGlwbHlTY2FsYXIoZGlzdGFuY2UpO1xuICAgICAgICBwYW5PZmZzZXQuYWRkKHYpO1xuICAgICAgfTtcbiAgICB9KSgpO1xuICAgIGNvbnN0IHBhbiA9ICgoKSA9PiB7XG4gICAgICBjb25zdCBvZmZzZXQgPSBuZXcgVmVjdG9yMygpO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBhbjIoZGVsdGFYLCBkZWx0YVkpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHNjb3BlLmRvbUVsZW1lbnQ7XG4gICAgICAgIGlmIChlbGVtZW50ICYmIHNjb3BlLm9iamVjdCBpbnN0YW5jZW9mIFBlcnNwZWN0aXZlQ2FtZXJhICYmIHNjb3BlLm9iamVjdC5pc1BlcnNwZWN0aXZlQ2FtZXJhKSB7XG4gICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBzY29wZS5vYmplY3QucG9zaXRpb247XG4gICAgICAgICAgb2Zmc2V0LmNvcHkocG9zaXRpb24pLnN1YihzY29wZS50YXJnZXQpO1xuICAgICAgICAgIGxldCB0YXJnZXREaXN0YW5jZSA9IG9mZnNldC5sZW5ndGgoKTtcbiAgICAgICAgICB0YXJnZXREaXN0YW5jZSAqPSBNYXRoLnRhbihzY29wZS5vYmplY3QuZm92IC8gMiAqIE1hdGguUEkgLyAxODApO1xuICAgICAgICAgIHBhbkxlZnQoMiAqIGRlbHRhWCAqIHRhcmdldERpc3RhbmNlIC8gZWxlbWVudC5jbGllbnRIZWlnaHQsIHNjb3BlLm9iamVjdC5tYXRyaXgpO1xuICAgICAgICAgIHBhblVwKDIgKiBkZWx0YVkgKiB0YXJnZXREaXN0YW5jZSAvIGVsZW1lbnQuY2xpZW50SGVpZ2h0LCBzY29wZS5vYmplY3QubWF0cml4KTtcbiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50ICYmIHNjb3BlLm9iamVjdCBpbnN0YW5jZW9mIE9ydGhvZ3JhcGhpY0NhbWVyYSAmJiBzY29wZS5vYmplY3QuaXNPcnRob2dyYXBoaWNDYW1lcmEpIHtcbiAgICAgICAgICBwYW5MZWZ0KFxuICAgICAgICAgICAgZGVsdGFYICogKHNjb3BlLm9iamVjdC5yaWdodCAtIHNjb3BlLm9iamVjdC5sZWZ0KSAvIHNjb3BlLm9iamVjdC56b29tIC8gZWxlbWVudC5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgIHNjb3BlLm9iamVjdC5tYXRyaXhcbiAgICAgICAgICApO1xuICAgICAgICAgIHBhblVwKFxuICAgICAgICAgICAgZGVsdGFZICogKHNjb3BlLm9iamVjdC50b3AgLSBzY29wZS5vYmplY3QuYm90dG9tKSAvIHNjb3BlLm9iamVjdC56b29tIC8gZWxlbWVudC5jbGllbnRIZWlnaHQsXG4gICAgICAgICAgICBzY29wZS5vYmplY3QubWF0cml4XG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJXQVJOSU5HOiBPcmJpdENvbnRyb2xzLmpzIGVuY291bnRlcmVkIGFuIHVua25vd24gY2FtZXJhIHR5cGUgLSBwYW4gZGlzYWJsZWQuXCIpO1xuICAgICAgICAgIHNjb3BlLmVuYWJsZVBhbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0pKCk7XG4gICAgZnVuY3Rpb24gZG9sbHlPdXQoZG9sbHlTY2FsZSkge1xuICAgICAgaWYgKHNjb3BlLm9iamVjdCBpbnN0YW5jZW9mIFBlcnNwZWN0aXZlQ2FtZXJhICYmIHNjb3BlLm9iamVjdC5pc1BlcnNwZWN0aXZlQ2FtZXJhIHx8IHNjb3BlLm9iamVjdCBpbnN0YW5jZW9mIE9ydGhvZ3JhcGhpY0NhbWVyYSAmJiBzY29wZS5vYmplY3QuaXNPcnRob2dyYXBoaWNDYW1lcmEpIHtcbiAgICAgICAgc2NhbGUgLz0gZG9sbHlTY2FsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIldBUk5JTkc6IE9yYml0Q29udHJvbHMuanMgZW5jb3VudGVyZWQgYW4gdW5rbm93biBjYW1lcmEgdHlwZSAtIGRvbGx5L3pvb20gZGlzYWJsZWQuXCIpO1xuICAgICAgICBzY29wZS5lbmFibGVab29tID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGRvbGx5SW4oZG9sbHlTY2FsZSkge1xuICAgICAgaWYgKHNjb3BlLm9iamVjdCBpbnN0YW5jZW9mIFBlcnNwZWN0aXZlQ2FtZXJhICYmIHNjb3BlLm9iamVjdC5pc1BlcnNwZWN0aXZlQ2FtZXJhIHx8IHNjb3BlLm9iamVjdCBpbnN0YW5jZW9mIE9ydGhvZ3JhcGhpY0NhbWVyYSAmJiBzY29wZS5vYmplY3QuaXNPcnRob2dyYXBoaWNDYW1lcmEpIHtcbiAgICAgICAgc2NhbGUgKj0gZG9sbHlTY2FsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIldBUk5JTkc6IE9yYml0Q29udHJvbHMuanMgZW5jb3VudGVyZWQgYW4gdW5rbm93biBjYW1lcmEgdHlwZSAtIGRvbGx5L3pvb20gZGlzYWJsZWQuXCIpO1xuICAgICAgICBzY29wZS5lbmFibGVab29tID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZU1vdXNlUGFyYW1ldGVycyhldmVudCkge1xuICAgICAgaWYgKCFzY29wZS56b29tVG9DdXJzb3IgfHwgIXNjb3BlLmRvbUVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcGVyZm9ybUN1cnNvclpvb20gPSB0cnVlO1xuICAgICAgY29uc3QgcmVjdCA9IHNjb3BlLmRvbUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBjb25zdCB4ID0gZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdDtcbiAgICAgIGNvbnN0IHkgPSBldmVudC5jbGllbnRZIC0gcmVjdC50b3A7XG4gICAgICBjb25zdCB3ID0gcmVjdC53aWR0aDtcbiAgICAgIGNvbnN0IGggPSByZWN0LmhlaWdodDtcbiAgICAgIG1vdXNlLnggPSB4IC8gdyAqIDIgLSAxO1xuICAgICAgbW91c2UueSA9IC0oeSAvIGgpICogMiArIDE7XG4gICAgICBkb2xseURpcmVjdGlvbi5zZXQobW91c2UueCwgbW91c2UueSwgMSkudW5wcm9qZWN0KHNjb3BlLm9iamVjdCkuc3ViKHNjb3BlLm9iamVjdC5wb3NpdGlvbikubm9ybWFsaXplKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNsYW1wRGlzdGFuY2UoZGlzdCkge1xuICAgICAgcmV0dXJuIE1hdGgubWF4KHNjb3BlLm1pbkRpc3RhbmNlLCBNYXRoLm1pbihzY29wZS5tYXhEaXN0YW5jZSwgZGlzdCkpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVNb3VzZURvd25Sb3RhdGUoZXZlbnQpIHtcbiAgICAgIHJvdGF0ZVN0YXJ0LnNldChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duRG9sbHkoZXZlbnQpIHtcbiAgICAgIHVwZGF0ZU1vdXNlUGFyYW1ldGVycyhldmVudCk7XG4gICAgICBkb2xseVN0YXJ0LnNldChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duUGFuKGV2ZW50KSB7XG4gICAgICBwYW5TdGFydC5zZXQoZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZVJvdGF0ZShldmVudCkge1xuICAgICAgcm90YXRlRW5kLnNldChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcbiAgICAgIHJvdGF0ZURlbHRhLnN1YlZlY3RvcnMocm90YXRlRW5kLCByb3RhdGVTdGFydCkubXVsdGlwbHlTY2FsYXIoc2NvcGUucm90YXRlU3BlZWQpO1xuICAgICAgY29uc3QgZWxlbWVudCA9IHNjb3BlLmRvbUVsZW1lbnQ7XG4gICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICByb3RhdGVMZWZ0KDIgKiBNYXRoLlBJICogcm90YXRlRGVsdGEueCAvIGVsZW1lbnQuY2xpZW50SGVpZ2h0KTtcbiAgICAgICAgcm90YXRlVXAoMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS55IC8gZWxlbWVudC5jbGllbnRIZWlnaHQpO1xuICAgICAgfVxuICAgICAgcm90YXRlU3RhcnQuY29weShyb3RhdGVFbmQpO1xuICAgICAgc2NvcGUudXBkYXRlKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZURvbGx5KGV2ZW50KSB7XG4gICAgICBkb2xseUVuZC5zZXQoZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSk7XG4gICAgICBkb2xseURlbHRhLnN1YlZlY3RvcnMoZG9sbHlFbmQsIGRvbGx5U3RhcnQpO1xuICAgICAgaWYgKGRvbGx5RGVsdGEueSA+IDApIHtcbiAgICAgICAgZG9sbHlPdXQoZ2V0Wm9vbVNjYWxlKCkpO1xuICAgICAgfSBlbHNlIGlmIChkb2xseURlbHRhLnkgPCAwKSB7XG4gICAgICAgIGRvbGx5SW4oZ2V0Wm9vbVNjYWxlKCkpO1xuICAgICAgfVxuICAgICAgZG9sbHlTdGFydC5jb3B5KGRvbGx5RW5kKTtcbiAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmVQYW4oZXZlbnQpIHtcbiAgICAgIHBhbkVuZC5zZXQoZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSk7XG4gICAgICBwYW5EZWx0YS5zdWJWZWN0b3JzKHBhbkVuZCwgcGFuU3RhcnQpLm11bHRpcGx5U2NhbGFyKHNjb3BlLnBhblNwZWVkKTtcbiAgICAgIHBhbihwYW5EZWx0YS54LCBwYW5EZWx0YS55KTtcbiAgICAgIHBhblN0YXJ0LmNvcHkocGFuRW5kKTtcbiAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVNb3VzZVdoZWVsKGV2ZW50KSB7XG4gICAgICB1cGRhdGVNb3VzZVBhcmFtZXRlcnMoZXZlbnQpO1xuICAgICAgaWYgKGV2ZW50LmRlbHRhWSA8IDApIHtcbiAgICAgICAgZG9sbHlJbihnZXRab29tU2NhbGUoKSk7XG4gICAgICB9IGVsc2UgaWYgKGV2ZW50LmRlbHRhWSA+IDApIHtcbiAgICAgICAgZG9sbHlPdXQoZ2V0Wm9vbVNjYWxlKCkpO1xuICAgICAgfVxuICAgICAgc2NvcGUudXBkYXRlKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGhhbmRsZUtleURvd24oZXZlbnQpIHtcbiAgICAgIGxldCBuZWVkc1VwZGF0ZSA9IGZhbHNlO1xuICAgICAgc3dpdGNoIChldmVudC5jb2RlKSB7XG4gICAgICAgIGNhc2Ugc2NvcGUua2V5cy5VUDpcbiAgICAgICAgICBwYW4oMCwgc2NvcGUua2V5UGFuU3BlZWQpO1xuICAgICAgICAgIG5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBzY29wZS5rZXlzLkJPVFRPTTpcbiAgICAgICAgICBwYW4oMCwgLXNjb3BlLmtleVBhblNwZWVkKTtcbiAgICAgICAgICBuZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2Ugc2NvcGUua2V5cy5MRUZUOlxuICAgICAgICAgIHBhbihzY29wZS5rZXlQYW5TcGVlZCwgMCk7XG4gICAgICAgICAgbmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHNjb3BlLmtleXMuUklHSFQ6XG4gICAgICAgICAgcGFuKC1zY29wZS5rZXlQYW5TcGVlZCwgMCk7XG4gICAgICAgICAgbmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKG5lZWRzVXBkYXRlKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0Um90YXRlKCkge1xuICAgICAgaWYgKHBvaW50ZXJzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgIHJvdGF0ZVN0YXJ0LnNldChwb2ludGVyc1swXS5wYWdlWCwgcG9pbnRlcnNbMF0ucGFnZVkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgeCA9IDAuNSAqIChwb2ludGVyc1swXS5wYWdlWCArIHBvaW50ZXJzWzFdLnBhZ2VYKTtcbiAgICAgICAgY29uc3QgeSA9IDAuNSAqIChwb2ludGVyc1swXS5wYWdlWSArIHBvaW50ZXJzWzFdLnBhZ2VZKTtcbiAgICAgICAgcm90YXRlU3RhcnQuc2V0KHgsIHkpO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0UGFuKCkge1xuICAgICAgaWYgKHBvaW50ZXJzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgIHBhblN0YXJ0LnNldChwb2ludGVyc1swXS5wYWdlWCwgcG9pbnRlcnNbMF0ucGFnZVkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgeCA9IDAuNSAqIChwb2ludGVyc1swXS5wYWdlWCArIHBvaW50ZXJzWzFdLnBhZ2VYKTtcbiAgICAgICAgY29uc3QgeSA9IDAuNSAqIChwb2ludGVyc1swXS5wYWdlWSArIHBvaW50ZXJzWzFdLnBhZ2VZKTtcbiAgICAgICAgcGFuU3RhcnQuc2V0KHgsIHkpO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0RG9sbHkoKSB7XG4gICAgICBjb25zdCBkeCA9IHBvaW50ZXJzWzBdLnBhZ2VYIC0gcG9pbnRlcnNbMV0ucGFnZVg7XG4gICAgICBjb25zdCBkeSA9IHBvaW50ZXJzWzBdLnBhZ2VZIC0gcG9pbnRlcnNbMV0ucGFnZVk7XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG4gICAgICBkb2xseVN0YXJ0LnNldCgwLCBkaXN0YW5jZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGhhbmRsZVRvdWNoU3RhcnREb2xseVBhbigpIHtcbiAgICAgIGlmIChzY29wZS5lbmFibGVab29tKVxuICAgICAgICBoYW5kbGVUb3VjaFN0YXJ0RG9sbHkoKTtcbiAgICAgIGlmIChzY29wZS5lbmFibGVQYW4pXG4gICAgICAgIGhhbmRsZVRvdWNoU3RhcnRQYW4oKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlVG91Y2hTdGFydERvbGx5Um90YXRlKCkge1xuICAgICAgaWYgKHNjb3BlLmVuYWJsZVpvb20pXG4gICAgICAgIGhhbmRsZVRvdWNoU3RhcnREb2xseSgpO1xuICAgICAgaWYgKHNjb3BlLmVuYWJsZVJvdGF0ZSlcbiAgICAgICAgaGFuZGxlVG91Y2hTdGFydFJvdGF0ZSgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVUb3VjaE1vdmVSb3RhdGUoZXZlbnQpIHtcbiAgICAgIGlmIChwb2ludGVycy5sZW5ndGggPT0gMSkge1xuICAgICAgICByb3RhdGVFbmQuc2V0KGV2ZW50LnBhZ2VYLCBldmVudC5wYWdlWSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGdldFNlY29uZFBvaW50ZXJQb3NpdGlvbihldmVudCk7XG4gICAgICAgIGNvbnN0IHggPSAwLjUgKiAoZXZlbnQucGFnZVggKyBwb3NpdGlvbi54KTtcbiAgICAgICAgY29uc3QgeSA9IDAuNSAqIChldmVudC5wYWdlWSArIHBvc2l0aW9uLnkpO1xuICAgICAgICByb3RhdGVFbmQuc2V0KHgsIHkpO1xuICAgICAgfVxuICAgICAgcm90YXRlRGVsdGEuc3ViVmVjdG9ycyhyb3RhdGVFbmQsIHJvdGF0ZVN0YXJ0KS5tdWx0aXBseVNjYWxhcihzY29wZS5yb3RhdGVTcGVlZCk7XG4gICAgICBjb25zdCBlbGVtZW50ID0gc2NvcGUuZG9tRWxlbWVudDtcbiAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgIHJvdGF0ZUxlZnQoMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS54IC8gZWxlbWVudC5jbGllbnRIZWlnaHQpO1xuICAgICAgICByb3RhdGVVcCgyICogTWF0aC5QSSAqIHJvdGF0ZURlbHRhLnkgLyBlbGVtZW50LmNsaWVudEhlaWdodCk7XG4gICAgICB9XG4gICAgICByb3RhdGVTdGFydC5jb3B5KHJvdGF0ZUVuZCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGhhbmRsZVRvdWNoTW92ZVBhbihldmVudCkge1xuICAgICAgaWYgKHBvaW50ZXJzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgIHBhbkVuZC5zZXQoZXZlbnQucGFnZVgsIGV2ZW50LnBhZ2VZKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gZ2V0U2Vjb25kUG9pbnRlclBvc2l0aW9uKGV2ZW50KTtcbiAgICAgICAgY29uc3QgeCA9IDAuNSAqIChldmVudC5wYWdlWCArIHBvc2l0aW9uLngpO1xuICAgICAgICBjb25zdCB5ID0gMC41ICogKGV2ZW50LnBhZ2VZICsgcG9zaXRpb24ueSk7XG4gICAgICAgIHBhbkVuZC5zZXQoeCwgeSk7XG4gICAgICB9XG4gICAgICBwYW5EZWx0YS5zdWJWZWN0b3JzKHBhbkVuZCwgcGFuU3RhcnQpLm11bHRpcGx5U2NhbGFyKHNjb3BlLnBhblNwZWVkKTtcbiAgICAgIHBhbihwYW5EZWx0YS54LCBwYW5EZWx0YS55KTtcbiAgICAgIHBhblN0YXJ0LmNvcHkocGFuRW5kKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlVG91Y2hNb3ZlRG9sbHkoZXZlbnQpIHtcbiAgICAgIGNvbnN0IHBvc2l0aW9uID0gZ2V0U2Vjb25kUG9pbnRlclBvc2l0aW9uKGV2ZW50KTtcbiAgICAgIGNvbnN0IGR4ID0gZXZlbnQucGFnZVggLSBwb3NpdGlvbi54O1xuICAgICAgY29uc3QgZHkgPSBldmVudC5wYWdlWSAtIHBvc2l0aW9uLnk7XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG4gICAgICBkb2xseUVuZC5zZXQoMCwgZGlzdGFuY2UpO1xuICAgICAgZG9sbHlEZWx0YS5zZXQoMCwgTWF0aC5wb3coZG9sbHlFbmQueSAvIGRvbGx5U3RhcnQueSwgc2NvcGUuem9vbVNwZWVkKSk7XG4gICAgICBkb2xseU91dChkb2xseURlbHRhLnkpO1xuICAgICAgZG9sbHlTdGFydC5jb3B5KGRvbGx5RW5kKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlVG91Y2hNb3ZlRG9sbHlQYW4oZXZlbnQpIHtcbiAgICAgIGlmIChzY29wZS5lbmFibGVab29tKVxuICAgICAgICBoYW5kbGVUb3VjaE1vdmVEb2xseShldmVudCk7XG4gICAgICBpZiAoc2NvcGUuZW5hYmxlUGFuKVxuICAgICAgICBoYW5kbGVUb3VjaE1vdmVQYW4oZXZlbnQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVUb3VjaE1vdmVEb2xseVJvdGF0ZShldmVudCkge1xuICAgICAgaWYgKHNjb3BlLmVuYWJsZVpvb20pXG4gICAgICAgIGhhbmRsZVRvdWNoTW92ZURvbGx5KGV2ZW50KTtcbiAgICAgIGlmIChzY29wZS5lbmFibGVSb3RhdGUpXG4gICAgICAgIGhhbmRsZVRvdWNoTW92ZVJvdGF0ZShldmVudCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uUG9pbnRlckRvd24oZXZlbnQpIHtcbiAgICAgIHZhciBfYSwgX2I7XG4gICAgICBpZiAoc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGlmIChwb2ludGVycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgKF9hID0gc2NvcGUuZG9tRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm93bmVyRG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIG9uUG9pbnRlck1vdmUpO1xuICAgICAgICAoX2IgPSBzY29wZS5kb21FbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2Iub3duZXJEb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIG9uUG9pbnRlclVwKTtcbiAgICAgIH1cbiAgICAgIGFkZFBvaW50ZXIoZXZlbnQpO1xuICAgICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIpIHtcbiAgICAgICAgb25Ub3VjaFN0YXJ0KGV2ZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9uTW91c2VEb3duKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb25Qb2ludGVyTW92ZShldmVudCkge1xuICAgICAgaWYgKHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlKVxuICAgICAgICByZXR1cm47XG4gICAgICBpZiAoZXZlbnQucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIikge1xuICAgICAgICBvblRvdWNoTW92ZShldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbk1vdXNlTW92ZShldmVudCk7XG4gICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uUG9pbnRlclVwKGV2ZW50KSB7XG4gICAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAgIHJlbW92ZVBvaW50ZXIoZXZlbnQpO1xuICAgICAgaWYgKHBvaW50ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAoX2EgPSBzY29wZS5kb21FbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EucmVsZWFzZVBvaW50ZXJDYXB0dXJlKGV2ZW50LnBvaW50ZXJJZCk7XG4gICAgICAgIChfYiA9IHNjb3BlLmRvbUVsZW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYi5vd25lckRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCBvblBvaW50ZXJNb3ZlKTtcbiAgICAgICAgKF9jID0gc2NvcGUuZG9tRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jLm93bmVyRG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCBvblBvaW50ZXJVcCk7XG4gICAgICB9XG4gICAgICBzY29wZS5kaXNwYXRjaEV2ZW50KGVuZEV2ZW50KTtcbiAgICAgIHN0YXRlID0gU1RBVEUuTk9ORTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25Nb3VzZURvd24oZXZlbnQpIHtcbiAgICAgIGxldCBtb3VzZUFjdGlvbjtcbiAgICAgIHN3aXRjaCAoZXZlbnQuYnV0dG9uKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICBtb3VzZUFjdGlvbiA9IHNjb3BlLm1vdXNlQnV0dG9ucy5MRUZUO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgbW91c2VBY3Rpb24gPSBzY29wZS5tb3VzZUJ1dHRvbnMuTUlERExFO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgbW91c2VBY3Rpb24gPSBzY29wZS5tb3VzZUJ1dHRvbnMuUklHSFQ7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgbW91c2VBY3Rpb24gPSAtMTtcbiAgICAgIH1cbiAgICAgIHN3aXRjaCAobW91c2VBY3Rpb24pIHtcbiAgICAgICAgY2FzZSBNT1VTRS5ET0xMWTpcbiAgICAgICAgICBpZiAoc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaGFuZGxlTW91c2VEb3duRG9sbHkoZXZlbnQpO1xuICAgICAgICAgIHN0YXRlID0gU1RBVEUuRE9MTFk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgTU9VU0UuUk9UQVRFOlxuICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkgfHwgZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgIGlmIChzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlKVxuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBoYW5kbGVNb3VzZURvd25QYW4oZXZlbnQpO1xuICAgICAgICAgICAgc3RhdGUgPSBTVEFURS5QQU47XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzY29wZS5lbmFibGVSb3RhdGUgPT09IGZhbHNlKVxuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBoYW5kbGVNb3VzZURvd25Sb3RhdGUoZXZlbnQpO1xuICAgICAgICAgICAgc3RhdGUgPSBTVEFURS5ST1RBVEU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIE1PVVNFLlBBTjpcbiAgICAgICAgICBpZiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5IHx8IGV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgaGFuZGxlTW91c2VEb3duUm90YXRlKGV2ZW50KTtcbiAgICAgICAgICAgIHN0YXRlID0gU1RBVEUuUk9UQVRFO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuZW5hYmxlUGFuID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgaGFuZGxlTW91c2VEb3duUGFuKGV2ZW50KTtcbiAgICAgICAgICAgIHN0YXRlID0gU1RBVEUuUEFOO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBzdGF0ZSA9IFNUQVRFLk5PTkU7XG4gICAgICB9XG4gICAgICBpZiAoc3RhdGUgIT09IFNUQVRFLk5PTkUpIHtcbiAgICAgICAgc2NvcGUuZGlzcGF0Y2hFdmVudChzdGFydEV2ZW50KTtcbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb25Nb3VzZU1vdmUoZXZlbnQpIHtcbiAgICAgIGlmIChzY29wZS5lbmFibGVkID09PSBmYWxzZSlcbiAgICAgICAgcmV0dXJuO1xuICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICBjYXNlIFNUQVRFLlJPVEFURTpcbiAgICAgICAgICBpZiAoc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICBoYW5kbGVNb3VzZU1vdmVSb3RhdGUoZXZlbnQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFNUQVRFLkRPTExZOlxuICAgICAgICAgIGlmIChzY29wZS5lbmFibGVab29tID09PSBmYWxzZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICBoYW5kbGVNb3VzZU1vdmVEb2xseShldmVudCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgU1RBVEUuUEFOOlxuICAgICAgICAgIGlmIChzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIGhhbmRsZU1vdXNlTW92ZVBhbihldmVudCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uTW91c2VXaGVlbChldmVudCkge1xuICAgICAgaWYgKHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlIHx8IHNjb3BlLmVuYWJsZVpvb20gPT09IGZhbHNlIHx8IHN0YXRlICE9PSBTVEFURS5OT05FICYmIHN0YXRlICE9PSBTVEFURS5ST1RBVEUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHNjb3BlLmRpc3BhdGNoRXZlbnQoc3RhcnRFdmVudCk7XG4gICAgICBoYW5kbGVNb3VzZVdoZWVsKGV2ZW50KTtcbiAgICAgIHNjb3BlLmRpc3BhdGNoRXZlbnQoZW5kRXZlbnQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbktleURvd24oZXZlbnQpIHtcbiAgICAgIGlmIChzY29wZS5lbmFibGVkID09PSBmYWxzZSB8fCBzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlKVxuICAgICAgICByZXR1cm47XG4gICAgICBoYW5kbGVLZXlEb3duKGV2ZW50KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25Ub3VjaFN0YXJ0KGV2ZW50KSB7XG4gICAgICB0cmFja1BvaW50ZXIoZXZlbnQpO1xuICAgICAgc3dpdGNoIChwb2ludGVycy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIHN3aXRjaCAoc2NvcGUudG91Y2hlcy5PTkUpIHtcbiAgICAgICAgICAgIGNhc2UgVE9VQ0guUk9UQVRFOlxuICAgICAgICAgICAgICBpZiAoc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIGhhbmRsZVRvdWNoU3RhcnRSb3RhdGUoKTtcbiAgICAgICAgICAgICAgc3RhdGUgPSBTVEFURS5UT1VDSF9ST1RBVEU7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBUT1VDSC5QQU46XG4gICAgICAgICAgICAgIGlmIChzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgaGFuZGxlVG91Y2hTdGFydFBhbigpO1xuICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFLlRPVUNIX1BBTjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFLk5PTkU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgc3dpdGNoIChzY29wZS50b3VjaGVzLlRXTykge1xuICAgICAgICAgICAgY2FzZSBUT1VDSC5ET0xMWV9QQU46XG4gICAgICAgICAgICAgIGlmIChzY29wZS5lbmFibGVab29tID09PSBmYWxzZSAmJiBzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgaGFuZGxlVG91Y2hTdGFydERvbGx5UGFuKCk7XG4gICAgICAgICAgICAgIHN0YXRlID0gU1RBVEUuVE9VQ0hfRE9MTFlfUEFOO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgVE9VQ0guRE9MTFlfUk9UQVRFOlxuICAgICAgICAgICAgICBpZiAoc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UgJiYgc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIGhhbmRsZVRvdWNoU3RhcnREb2xseVJvdGF0ZSgpO1xuICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFLlRPVUNIX0RPTExZX1JPVEFURTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFLk5PTkU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHN0YXRlID0gU1RBVEUuTk9ORTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZSAhPT0gU1RBVEUuTk9ORSkge1xuICAgICAgICBzY29wZS5kaXNwYXRjaEV2ZW50KHN0YXJ0RXZlbnQpO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvblRvdWNoTW92ZShldmVudCkge1xuICAgICAgdHJhY2tQb2ludGVyKGV2ZW50KTtcbiAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgY2FzZSBTVEFURS5UT1VDSF9ST1RBVEU6XG4gICAgICAgICAgaWYgKHNjb3BlLmVuYWJsZVJvdGF0ZSA9PT0gZmFsc2UpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaGFuZGxlVG91Y2hNb3ZlUm90YXRlKGV2ZW50KTtcbiAgICAgICAgICBzY29wZS51cGRhdGUoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBTVEFURS5UT1VDSF9QQU46XG4gICAgICAgICAgaWYgKHNjb3BlLmVuYWJsZVBhbiA9PT0gZmFsc2UpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaGFuZGxlVG91Y2hNb3ZlUGFuKGV2ZW50KTtcbiAgICAgICAgICBzY29wZS51cGRhdGUoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBTVEFURS5UT1VDSF9ET0xMWV9QQU46XG4gICAgICAgICAgaWYgKHNjb3BlLmVuYWJsZVpvb20gPT09IGZhbHNlICYmIHNjb3BlLmVuYWJsZVBhbiA9PT0gZmFsc2UpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaGFuZGxlVG91Y2hNb3ZlRG9sbHlQYW4oZXZlbnQpO1xuICAgICAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFNUQVRFLlRPVUNIX0RPTExZX1JPVEFURTpcbiAgICAgICAgICBpZiAoc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UgJiYgc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICBoYW5kbGVUb3VjaE1vdmVEb2xseVJvdGF0ZShldmVudCk7XG4gICAgICAgICAgc2NvcGUudXBkYXRlKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgc3RhdGUgPSBTVEFURS5OT05FO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvbkNvbnRleHRNZW51KGV2ZW50KSB7XG4gICAgICBpZiAoc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGFkZFBvaW50ZXIoZXZlbnQpIHtcbiAgICAgIHBvaW50ZXJzLnB1c2goZXZlbnQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiByZW1vdmVQb2ludGVyKGV2ZW50KSB7XG4gICAgICBkZWxldGUgcG9pbnRlclBvc2l0aW9uc1tldmVudC5wb2ludGVySWRdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocG9pbnRlcnNbaV0ucG9pbnRlcklkID09IGV2ZW50LnBvaW50ZXJJZCkge1xuICAgICAgICAgIHBvaW50ZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gdHJhY2tQb2ludGVyKGV2ZW50KSB7XG4gICAgICBsZXQgcG9zaXRpb24gPSBwb2ludGVyUG9zaXRpb25zW2V2ZW50LnBvaW50ZXJJZF07XG4gICAgICBpZiAocG9zaXRpb24gPT09IHZvaWQgMCkge1xuICAgICAgICBwb3NpdGlvbiA9IG5ldyBWZWN0b3IyKCk7XG4gICAgICAgIHBvaW50ZXJQb3NpdGlvbnNbZXZlbnQucG9pbnRlcklkXSA9IHBvc2l0aW9uO1xuICAgICAgfVxuICAgICAgcG9zaXRpb24uc2V0KGV2ZW50LnBhZ2VYLCBldmVudC5wYWdlWSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldFNlY29uZFBvaW50ZXJQb3NpdGlvbihldmVudCkge1xuICAgICAgY29uc3QgcG9pbnRlciA9IGV2ZW50LnBvaW50ZXJJZCA9PT0gcG9pbnRlcnNbMF0ucG9pbnRlcklkID8gcG9pbnRlcnNbMV0gOiBwb2ludGVyc1swXTtcbiAgICAgIHJldHVybiBwb2ludGVyUG9zaXRpb25zW3BvaW50ZXIucG9pbnRlcklkXTtcbiAgICB9XG4gICAgaWYgKGRvbUVsZW1lbnQgIT09IHZvaWQgMClcbiAgICAgIHRoaXMuY29ubmVjdChkb21FbGVtZW50KTtcbiAgICB0aGlzLnVwZGF0ZSgpO1xuICB9XG59XG5jbGFzcyBNYXBDb250cm9scyBleHRlbmRzIE9yYml0Q29udHJvbHMge1xuICBjb25zdHJ1Y3RvcihvYmplY3QsIGRvbUVsZW1lbnQpIHtcbiAgICBzdXBlcihvYmplY3QsIGRvbUVsZW1lbnQpO1xuICAgIHRoaXMuc2NyZWVuU3BhY2VQYW5uaW5nID0gZmFsc2U7XG4gICAgdGhpcy5tb3VzZUJ1dHRvbnMuTEVGVCA9IE1PVVNFLlBBTjtcbiAgICB0aGlzLm1vdXNlQnV0dG9ucy5SSUdIVCA9IE1PVVNFLlJPVEFURTtcbiAgICB0aGlzLnRvdWNoZXMuT05FID0gVE9VQ0guUEFOO1xuICAgIHRoaXMudG91Y2hlcy5UV08gPSBUT1VDSC5ET0xMWV9ST1RBVEU7XG4gIH1cbn1cbmV4cG9ydCB7XG4gIE1hcENvbnRyb2xzLFxuICBPcmJpdENvbnRyb2xzXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9T3JiaXRDb250cm9scy5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/three-stdlib/controls/OrbitControls.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/three-stdlib/controls/TransformControls.js":
/*!*****************************************************************!*\
  !*** ./node_modules/three-stdlib/controls/TransformControls.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TransformControls: () => (/* binding */ TransformControls),\n/* harmony export */   TransformControlsGizmo: () => (/* binding */ TransformControlsGizmo),\n/* harmony export */   TransformControlsPlane: () => (/* binding */ TransformControlsPlane)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\nvar __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\n\nclass TransformControls extends three__WEBPACK_IMPORTED_MODULE_0__.Object3D {\n  constructor(camera, domElement) {\n    super();\n    __publicField(this, \"isTransformControls\", true);\n    __publicField(this, \"visible\", false);\n    __publicField(this, \"domElement\");\n    __publicField(this, \"raycaster\", new three__WEBPACK_IMPORTED_MODULE_0__.Raycaster());\n    __publicField(this, \"gizmo\");\n    __publicField(this, \"plane\");\n    __publicField(this, \"tempVector\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"tempVector2\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"tempQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"unit\", {\n      X: new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(1, 0, 0),\n      Y: new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 1, 0),\n      Z: new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 0, 1)\n    });\n    __publicField(this, \"pointStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"pointEnd\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"offset\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"rotationAxis\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"startNorm\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"endNorm\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"rotationAngle\", 0);\n    __publicField(this, \"cameraPosition\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"cameraQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"cameraScale\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"parentPosition\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"parentQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"parentQuaternionInv\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"parentScale\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldPositionStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldQuaternionStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"worldScaleStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldPosition\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"worldQuaternionInv\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"worldScale\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"eye\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"positionStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"quaternionStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"scaleStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"camera\");\n    __publicField(this, \"object\");\n    __publicField(this, \"enabled\", true);\n    __publicField(this, \"axis\", null);\n    __publicField(this, \"mode\", \"translate\");\n    __publicField(this, \"translationSnap\", null);\n    __publicField(this, \"rotationSnap\", null);\n    __publicField(this, \"scaleSnap\", null);\n    __publicField(this, \"space\", \"world\");\n    __publicField(this, \"size\", 1);\n    __publicField(this, \"dragging\", false);\n    __publicField(this, \"showX\", true);\n    __publicField(this, \"showY\", true);\n    __publicField(this, \"showZ\", true);\n    // events\n    __publicField(this, \"changeEvent\", { type: \"change\" });\n    __publicField(this, \"mouseDownEvent\", { type: \"mouseDown\", mode: this.mode });\n    __publicField(this, \"mouseUpEvent\", { type: \"mouseUp\", mode: this.mode });\n    __publicField(this, \"objectChangeEvent\", { type: \"objectChange\" });\n    __publicField(this, \"intersectObjectWithRay\", (object, raycaster, includeInvisible) => {\n      const allIntersections = raycaster.intersectObject(object, true);\n      for (let i = 0; i < allIntersections.length; i++) {\n        if (allIntersections[i].object.visible || includeInvisible) {\n          return allIntersections[i];\n        }\n      }\n      return false;\n    });\n    // Set current object\n    __publicField(this, \"attach\", (object) => {\n      this.object = object;\n      this.visible = true;\n      return this;\n    });\n    // Detatch from object\n    __publicField(this, \"detach\", () => {\n      this.object = void 0;\n      this.visible = false;\n      this.axis = null;\n      return this;\n    });\n    // Reset\n    __publicField(this, \"reset\", () => {\n      if (!this.enabled)\n        return this;\n      if (this.dragging) {\n        if (this.object !== void 0) {\n          this.object.position.copy(this.positionStart);\n          this.object.quaternion.copy(this.quaternionStart);\n          this.object.scale.copy(this.scaleStart);\n          this.dispatchEvent(this.changeEvent);\n          this.dispatchEvent(this.objectChangeEvent);\n          this.pointStart.copy(this.pointEnd);\n        }\n      }\n      return this;\n    });\n    __publicField(this, \"updateMatrixWorld\", () => {\n      if (this.object !== void 0) {\n        this.object.updateMatrixWorld();\n        if (this.object.parent === null) {\n          console.error(\"TransformControls: The attached 3D object must be a part of the scene graph.\");\n        } else {\n          this.object.parent.matrixWorld.decompose(this.parentPosition, this.parentQuaternion, this.parentScale);\n        }\n        this.object.matrixWorld.decompose(this.worldPosition, this.worldQuaternion, this.worldScale);\n        this.parentQuaternionInv.copy(this.parentQuaternion).invert();\n        this.worldQuaternionInv.copy(this.worldQuaternion).invert();\n      }\n      this.camera.updateMatrixWorld();\n      this.camera.matrixWorld.decompose(this.cameraPosition, this.cameraQuaternion, this.cameraScale);\n      this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize();\n      super.updateMatrixWorld();\n    });\n    __publicField(this, \"pointerHover\", (pointer) => {\n      if (this.object === void 0 || this.dragging === true)\n        return;\n      this.raycaster.setFromCamera(pointer, this.camera);\n      const intersect = this.intersectObjectWithRay(this.gizmo.picker[this.mode], this.raycaster);\n      if (intersect) {\n        this.axis = intersect.object.name;\n      } else {\n        this.axis = null;\n      }\n    });\n    __publicField(this, \"pointerDown\", (pointer) => {\n      if (this.object === void 0 || this.dragging === true || pointer.button !== 0)\n        return;\n      if (this.axis !== null) {\n        this.raycaster.setFromCamera(pointer, this.camera);\n        const planeIntersect = this.intersectObjectWithRay(this.plane, this.raycaster, true);\n        if (planeIntersect) {\n          let space = this.space;\n          if (this.mode === \"scale\") {\n            space = \"local\";\n          } else if (this.axis === \"E\" || this.axis === \"XYZE\" || this.axis === \"XYZ\") {\n            space = \"world\";\n          }\n          if (space === \"local\" && this.mode === \"rotate\") {\n            const snap = this.rotationSnap;\n            if (this.axis === \"X\" && snap)\n              this.object.rotation.x = Math.round(this.object.rotation.x / snap) * snap;\n            if (this.axis === \"Y\" && snap)\n              this.object.rotation.y = Math.round(this.object.rotation.y / snap) * snap;\n            if (this.axis === \"Z\" && snap)\n              this.object.rotation.z = Math.round(this.object.rotation.z / snap) * snap;\n          }\n          this.object.updateMatrixWorld();\n          if (this.object.parent) {\n            this.object.parent.updateMatrixWorld();\n          }\n          this.positionStart.copy(this.object.position);\n          this.quaternionStart.copy(this.object.quaternion);\n          this.scaleStart.copy(this.object.scale);\n          this.object.matrixWorld.decompose(this.worldPositionStart, this.worldQuaternionStart, this.worldScaleStart);\n          this.pointStart.copy(planeIntersect.point).sub(this.worldPositionStart);\n        }\n        this.dragging = true;\n        this.mouseDownEvent.mode = this.mode;\n        this.dispatchEvent(this.mouseDownEvent);\n      }\n    });\n    __publicField(this, \"pointerMove\", (pointer) => {\n      const axis = this.axis;\n      const mode = this.mode;\n      const object = this.object;\n      let space = this.space;\n      if (mode === \"scale\") {\n        space = \"local\";\n      } else if (axis === \"E\" || axis === \"XYZE\" || axis === \"XYZ\") {\n        space = \"world\";\n      }\n      if (object === void 0 || axis === null || this.dragging === false || pointer.button !== -1)\n        return;\n      this.raycaster.setFromCamera(pointer, this.camera);\n      const planeIntersect = this.intersectObjectWithRay(this.plane, this.raycaster, true);\n      if (!planeIntersect)\n        return;\n      this.pointEnd.copy(planeIntersect.point).sub(this.worldPositionStart);\n      if (mode === \"translate\") {\n        this.offset.copy(this.pointEnd).sub(this.pointStart);\n        if (space === \"local\" && axis !== \"XYZ\") {\n          this.offset.applyQuaternion(this.worldQuaternionInv);\n        }\n        if (axis.indexOf(\"X\") === -1)\n          this.offset.x = 0;\n        if (axis.indexOf(\"Y\") === -1)\n          this.offset.y = 0;\n        if (axis.indexOf(\"Z\") === -1)\n          this.offset.z = 0;\n        if (space === \"local\" && axis !== \"XYZ\") {\n          this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale);\n        } else {\n          this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale);\n        }\n        object.position.copy(this.offset).add(this.positionStart);\n        if (this.translationSnap) {\n          if (space === \"local\") {\n            object.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert());\n            if (axis.search(\"X\") !== -1) {\n              object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;\n            }\n            if (axis.search(\"Y\") !== -1) {\n              object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;\n            }\n            if (axis.search(\"Z\") !== -1) {\n              object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;\n            }\n            object.position.applyQuaternion(this.quaternionStart);\n          }\n          if (space === \"world\") {\n            if (object.parent) {\n              object.position.add(this.tempVector.setFromMatrixPosition(object.parent.matrixWorld));\n            }\n            if (axis.search(\"X\") !== -1) {\n              object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;\n            }\n            if (axis.search(\"Y\") !== -1) {\n              object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;\n            }\n            if (axis.search(\"Z\") !== -1) {\n              object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;\n            }\n            if (object.parent) {\n              object.position.sub(this.tempVector.setFromMatrixPosition(object.parent.matrixWorld));\n            }\n          }\n        }\n      } else if (mode === \"scale\") {\n        if (axis.search(\"XYZ\") !== -1) {\n          let d = this.pointEnd.length() / this.pointStart.length();\n          if (this.pointEnd.dot(this.pointStart) < 0)\n            d *= -1;\n          this.tempVector2.set(d, d, d);\n        } else {\n          this.tempVector.copy(this.pointStart);\n          this.tempVector2.copy(this.pointEnd);\n          this.tempVector.applyQuaternion(this.worldQuaternionInv);\n          this.tempVector2.applyQuaternion(this.worldQuaternionInv);\n          this.tempVector2.divide(this.tempVector);\n          if (axis.search(\"X\") === -1) {\n            this.tempVector2.x = 1;\n          }\n          if (axis.search(\"Y\") === -1) {\n            this.tempVector2.y = 1;\n          }\n          if (axis.search(\"Z\") === -1) {\n            this.tempVector2.z = 1;\n          }\n        }\n        object.scale.copy(this.scaleStart).multiply(this.tempVector2);\n        if (this.scaleSnap && this.object) {\n          if (axis.search(\"X\") !== -1) {\n            this.object.scale.x = Math.round(object.scale.x / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\n          }\n          if (axis.search(\"Y\") !== -1) {\n            object.scale.y = Math.round(object.scale.y / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\n          }\n          if (axis.search(\"Z\") !== -1) {\n            object.scale.z = Math.round(object.scale.z / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\n          }\n        }\n      } else if (mode === \"rotate\") {\n        this.offset.copy(this.pointEnd).sub(this.pointStart);\n        const ROTATION_SPEED = 20 / this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));\n        if (axis === \"E\") {\n          this.rotationAxis.copy(this.eye);\n          this.rotationAngle = this.pointEnd.angleTo(this.pointStart);\n          this.startNorm.copy(this.pointStart).normalize();\n          this.endNorm.copy(this.pointEnd).normalize();\n          this.rotationAngle *= this.endNorm.cross(this.startNorm).dot(this.eye) < 0 ? 1 : -1;\n        } else if (axis === \"XYZE\") {\n          this.rotationAxis.copy(this.offset).cross(this.eye).normalize();\n          this.rotationAngle = this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye)) * ROTATION_SPEED;\n        } else if (axis === \"X\" || axis === \"Y\" || axis === \"Z\") {\n          this.rotationAxis.copy(this.unit[axis]);\n          this.tempVector.copy(this.unit[axis]);\n          if (space === \"local\") {\n            this.tempVector.applyQuaternion(this.worldQuaternion);\n          }\n          this.rotationAngle = this.offset.dot(this.tempVector.cross(this.eye).normalize()) * ROTATION_SPEED;\n        }\n        if (this.rotationSnap) {\n          this.rotationAngle = Math.round(this.rotationAngle / this.rotationSnap) * this.rotationSnap;\n        }\n        if (space === \"local\" && axis !== \"E\" && axis !== \"XYZE\") {\n          object.quaternion.copy(this.quaternionStart);\n          object.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis, this.rotationAngle)).normalize();\n        } else {\n          this.rotationAxis.applyQuaternion(this.parentQuaternionInv);\n          object.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis, this.rotationAngle));\n          object.quaternion.multiply(this.quaternionStart).normalize();\n        }\n      }\n      this.dispatchEvent(this.changeEvent);\n      this.dispatchEvent(this.objectChangeEvent);\n    });\n    __publicField(this, \"pointerUp\", (pointer) => {\n      if (pointer.button !== 0)\n        return;\n      if (this.dragging && this.axis !== null) {\n        this.mouseUpEvent.mode = this.mode;\n        this.dispatchEvent(this.mouseUpEvent);\n      }\n      this.dragging = false;\n      this.axis = null;\n    });\n    __publicField(this, \"getPointer\", (event) => {\n      var _a;\n      if (this.domElement && ((_a = this.domElement.ownerDocument) == null ? void 0 : _a.pointerLockElement)) {\n        return {\n          x: 0,\n          y: 0,\n          button: event.button\n        };\n      } else {\n        const pointer = event.changedTouches ? event.changedTouches[0] : event;\n        const rect = this.domElement.getBoundingClientRect();\n        return {\n          x: (pointer.clientX - rect.left) / rect.width * 2 - 1,\n          y: -(pointer.clientY - rect.top) / rect.height * 2 + 1,\n          button: event.button\n        };\n      }\n    });\n    __publicField(this, \"onPointerHover\", (event) => {\n      if (!this.enabled)\n        return;\n      switch (event.pointerType) {\n        case \"mouse\":\n        case \"pen\":\n          this.pointerHover(this.getPointer(event));\n          break;\n      }\n    });\n    __publicField(this, \"onPointerDown\", (event) => {\n      if (!this.enabled || !this.domElement)\n        return;\n      this.domElement.style.touchAction = \"none\";\n      this.domElement.ownerDocument.addEventListener(\"pointermove\", this.onPointerMove);\n      this.pointerHover(this.getPointer(event));\n      this.pointerDown(this.getPointer(event));\n    });\n    __publicField(this, \"onPointerMove\", (event) => {\n      if (!this.enabled)\n        return;\n      this.pointerMove(this.getPointer(event));\n    });\n    __publicField(this, \"onPointerUp\", (event) => {\n      if (!this.enabled || !this.domElement)\n        return;\n      this.domElement.style.touchAction = \"\";\n      this.domElement.ownerDocument.removeEventListener(\"pointermove\", this.onPointerMove);\n      this.pointerUp(this.getPointer(event));\n    });\n    __publicField(this, \"getMode\", () => this.mode);\n    __publicField(this, \"setMode\", (mode) => {\n      this.mode = mode;\n    });\n    __publicField(this, \"setTranslationSnap\", (translationSnap) => {\n      this.translationSnap = translationSnap;\n    });\n    __publicField(this, \"setRotationSnap\", (rotationSnap) => {\n      this.rotationSnap = rotationSnap;\n    });\n    __publicField(this, \"setScaleSnap\", (scaleSnap) => {\n      this.scaleSnap = scaleSnap;\n    });\n    __publicField(this, \"setSize\", (size) => {\n      this.size = size;\n    });\n    __publicField(this, \"setSpace\", (space) => {\n      this.space = space;\n    });\n    __publicField(this, \"update\", () => {\n      console.warn(\n        \"THREE.TransformControls: update function has no more functionality and therefore has been deprecated.\"\n      );\n    });\n    __publicField(this, \"connect\", (domElement) => {\n      if (domElement === document) {\n        console.error(\n          'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.'\n        );\n      }\n      this.domElement = domElement;\n      this.domElement.addEventListener(\"pointerdown\", this.onPointerDown);\n      this.domElement.addEventListener(\"pointermove\", this.onPointerHover);\n      this.domElement.ownerDocument.addEventListener(\"pointerup\", this.onPointerUp);\n    });\n    __publicField(this, \"dispose\", () => {\n      var _a, _b, _c, _d, _e, _f;\n      (_a = this.domElement) == null ? void 0 : _a.removeEventListener(\"pointerdown\", this.onPointerDown);\n      (_b = this.domElement) == null ? void 0 : _b.removeEventListener(\"pointermove\", this.onPointerHover);\n      (_d = (_c = this.domElement) == null ? void 0 : _c.ownerDocument) == null ? void 0 : _d.removeEventListener(\"pointermove\", this.onPointerMove);\n      (_f = (_e = this.domElement) == null ? void 0 : _e.ownerDocument) == null ? void 0 : _f.removeEventListener(\"pointerup\", this.onPointerUp);\n      this.traverse((child) => {\n        const mesh = child;\n        if (mesh.geometry) {\n          mesh.geometry.dispose();\n        }\n        if (mesh.material) {\n          mesh.material.dispose();\n        }\n      });\n    });\n    this.domElement = domElement;\n    this.camera = camera;\n    this.gizmo = new TransformControlsGizmo();\n    this.add(this.gizmo);\n    this.plane = new TransformControlsPlane();\n    this.add(this.plane);\n    const defineProperty = (propName, defaultValue) => {\n      let propValue = defaultValue;\n      Object.defineProperty(this, propName, {\n        get: function() {\n          return propValue !== void 0 ? propValue : defaultValue;\n        },\n        set: function(value) {\n          if (propValue !== value) {\n            propValue = value;\n            this.plane[propName] = value;\n            this.gizmo[propName] = value;\n            this.dispatchEvent({ type: propName + \"-changed\", value });\n            this.dispatchEvent(this.changeEvent);\n          }\n        }\n      });\n      this[propName] = defaultValue;\n      this.plane[propName] = defaultValue;\n      this.gizmo[propName] = defaultValue;\n    };\n    defineProperty(\"camera\", this.camera);\n    defineProperty(\"object\", this.object);\n    defineProperty(\"enabled\", this.enabled);\n    defineProperty(\"axis\", this.axis);\n    defineProperty(\"mode\", this.mode);\n    defineProperty(\"translationSnap\", this.translationSnap);\n    defineProperty(\"rotationSnap\", this.rotationSnap);\n    defineProperty(\"scaleSnap\", this.scaleSnap);\n    defineProperty(\"space\", this.space);\n    defineProperty(\"size\", this.size);\n    defineProperty(\"dragging\", this.dragging);\n    defineProperty(\"showX\", this.showX);\n    defineProperty(\"showY\", this.showY);\n    defineProperty(\"showZ\", this.showZ);\n    defineProperty(\"worldPosition\", this.worldPosition);\n    defineProperty(\"worldPositionStart\", this.worldPositionStart);\n    defineProperty(\"worldQuaternion\", this.worldQuaternion);\n    defineProperty(\"worldQuaternionStart\", this.worldQuaternionStart);\n    defineProperty(\"cameraPosition\", this.cameraPosition);\n    defineProperty(\"cameraQuaternion\", this.cameraQuaternion);\n    defineProperty(\"pointStart\", this.pointStart);\n    defineProperty(\"pointEnd\", this.pointEnd);\n    defineProperty(\"rotationAxis\", this.rotationAxis);\n    defineProperty(\"rotationAngle\", this.rotationAngle);\n    defineProperty(\"eye\", this.eye);\n    if (domElement !== void 0)\n      this.connect(domElement);\n  }\n}\nclass TransformControlsGizmo extends three__WEBPACK_IMPORTED_MODULE_0__.Object3D {\n  constructor() {\n    super();\n    __publicField(this, \"isTransformControlsGizmo\", true);\n    __publicField(this, \"type\", \"TransformControlsGizmo\");\n    __publicField(this, \"tempVector\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 0, 0));\n    __publicField(this, \"tempEuler\", new three__WEBPACK_IMPORTED_MODULE_0__.Euler());\n    __publicField(this, \"alignVector\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 1, 0));\n    __publicField(this, \"zeroVector\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 0, 0));\n    __publicField(this, \"lookAtMatrix\", new three__WEBPACK_IMPORTED_MODULE_0__.Matrix4());\n    __publicField(this, \"tempQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"tempQuaternion2\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"identityQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"unitX\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(1, 0, 0));\n    __publicField(this, \"unitY\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 1, 0));\n    __publicField(this, \"unitZ\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 0, 1));\n    __publicField(this, \"gizmo\");\n    __publicField(this, \"picker\");\n    __publicField(this, \"helper\");\n    // these are set from parent class TransformControls\n    __publicField(this, \"rotationAxis\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"cameraPosition\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldPositionStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldQuaternionStart\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"worldPosition\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"eye\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"camera\", null);\n    __publicField(this, \"enabled\", true);\n    __publicField(this, \"axis\", null);\n    __publicField(this, \"mode\", \"translate\");\n    __publicField(this, \"space\", \"world\");\n    __publicField(this, \"size\", 1);\n    __publicField(this, \"dragging\", false);\n    __publicField(this, \"showX\", true);\n    __publicField(this, \"showY\", true);\n    __publicField(this, \"showZ\", true);\n    // updateMatrixWorld will update transformations and appearance of individual handles\n    __publicField(this, \"updateMatrixWorld\", () => {\n      let space = this.space;\n      if (this.mode === \"scale\") {\n        space = \"local\";\n      }\n      const quaternion = space === \"local\" ? this.worldQuaternion : this.identityQuaternion;\n      this.gizmo[\"translate\"].visible = this.mode === \"translate\";\n      this.gizmo[\"rotate\"].visible = this.mode === \"rotate\";\n      this.gizmo[\"scale\"].visible = this.mode === \"scale\";\n      this.helper[\"translate\"].visible = this.mode === \"translate\";\n      this.helper[\"rotate\"].visible = this.mode === \"rotate\";\n      this.helper[\"scale\"].visible = this.mode === \"scale\";\n      let handles = [];\n      handles = handles.concat(this.picker[this.mode].children);\n      handles = handles.concat(this.gizmo[this.mode].children);\n      handles = handles.concat(this.helper[this.mode].children);\n      for (let i = 0; i < handles.length; i++) {\n        const handle = handles[i];\n        handle.visible = true;\n        handle.rotation.set(0, 0, 0);\n        handle.position.copy(this.worldPosition);\n        let factor;\n        if (this.camera.isOrthographicCamera) {\n          factor = (this.camera.top - this.camera.bottom) / this.camera.zoom;\n        } else {\n          factor = this.worldPosition.distanceTo(this.cameraPosition) * Math.min(1.9 * Math.tan(Math.PI * this.camera.fov / 360) / this.camera.zoom, 7);\n        }\n        handle.scale.set(1, 1, 1).multiplyScalar(factor * this.size / 7);\n        if (handle.tag === \"helper\") {\n          handle.visible = false;\n          if (handle.name === \"AXIS\") {\n            handle.position.copy(this.worldPositionStart);\n            handle.visible = !!this.axis;\n            if (this.axis === \"X\") {\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, 0, 0));\n              handle.quaternion.copy(quaternion).multiply(this.tempQuaternion);\n              if (Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\n                handle.visible = false;\n              }\n            }\n            if (this.axis === \"Y\") {\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, 0, Math.PI / 2));\n              handle.quaternion.copy(quaternion).multiply(this.tempQuaternion);\n              if (Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\n                handle.visible = false;\n              }\n            }\n            if (this.axis === \"Z\") {\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, Math.PI / 2, 0));\n              handle.quaternion.copy(quaternion).multiply(this.tempQuaternion);\n              if (Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\n                handle.visible = false;\n              }\n            }\n            if (this.axis === \"XYZE\") {\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, Math.PI / 2, 0));\n              this.alignVector.copy(this.rotationAxis);\n              handle.quaternion.setFromRotationMatrix(\n                this.lookAtMatrix.lookAt(this.zeroVector, this.alignVector, this.unitY)\n              );\n              handle.quaternion.multiply(this.tempQuaternion);\n              handle.visible = this.dragging;\n            }\n            if (this.axis === \"E\") {\n              handle.visible = false;\n            }\n          } else if (handle.name === \"START\") {\n            handle.position.copy(this.worldPositionStart);\n            handle.visible = this.dragging;\n          } else if (handle.name === \"END\") {\n            handle.position.copy(this.worldPosition);\n            handle.visible = this.dragging;\n          } else if (handle.name === \"DELTA\") {\n            handle.position.copy(this.worldPositionStart);\n            handle.quaternion.copy(this.worldQuaternionStart);\n            this.tempVector.set(1e-10, 1e-10, 1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1);\n            this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert());\n            handle.scale.copy(this.tempVector);\n            handle.visible = this.dragging;\n          } else {\n            handle.quaternion.copy(quaternion);\n            if (this.dragging) {\n              handle.position.copy(this.worldPositionStart);\n            } else {\n              handle.position.copy(this.worldPosition);\n            }\n            if (this.axis) {\n              handle.visible = this.axis.search(handle.name) !== -1;\n            }\n          }\n          continue;\n        }\n        handle.quaternion.copy(quaternion);\n        if (this.mode === \"translate\" || this.mode === \"scale\") {\n          const AXIS_HIDE_TRESHOLD = 0.99;\n          const PLANE_HIDE_TRESHOLD = 0.2;\n          const AXIS_FLIP_TRESHOLD = 0;\n          if (handle.name === \"X\" || handle.name === \"XYZX\") {\n            if (Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n          if (handle.name === \"Y\" || handle.name === \"XYZY\") {\n            if (Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n          if (handle.name === \"Z\" || handle.name === \"XYZZ\") {\n            if (Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n          if (handle.name === \"XY\") {\n            if (Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n          if (handle.name === \"YZ\") {\n            if (Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n          if (handle.name === \"XZ\") {\n            if (Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n          if (handle.name.search(\"X\") !== -1) {\n            if (this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\n              if (handle.tag === \"fwd\") {\n                handle.visible = false;\n              } else {\n                handle.scale.x *= -1;\n              }\n            } else if (handle.tag === \"bwd\") {\n              handle.visible = false;\n            }\n          }\n          if (handle.name.search(\"Y\") !== -1) {\n            if (this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\n              if (handle.tag === \"fwd\") {\n                handle.visible = false;\n              } else {\n                handle.scale.y *= -1;\n              }\n            } else if (handle.tag === \"bwd\") {\n              handle.visible = false;\n            }\n          }\n          if (handle.name.search(\"Z\") !== -1) {\n            if (this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\n              if (handle.tag === \"fwd\") {\n                handle.visible = false;\n              } else {\n                handle.scale.z *= -1;\n              }\n            } else if (handle.tag === \"bwd\") {\n              handle.visible = false;\n            }\n          }\n        } else if (this.mode === \"rotate\") {\n          this.tempQuaternion2.copy(quaternion);\n          this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(quaternion).invert());\n          if (handle.name.search(\"E\") !== -1) {\n            handle.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye, this.zeroVector, this.unitY));\n          }\n          if (handle.name === \"X\") {\n            this.tempQuaternion.setFromAxisAngle(this.unitX, Math.atan2(-this.alignVector.y, this.alignVector.z));\n            this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2, this.tempQuaternion);\n            handle.quaternion.copy(this.tempQuaternion);\n          }\n          if (handle.name === \"Y\") {\n            this.tempQuaternion.setFromAxisAngle(this.unitY, Math.atan2(this.alignVector.x, this.alignVector.z));\n            this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2, this.tempQuaternion);\n            handle.quaternion.copy(this.tempQuaternion);\n          }\n          if (handle.name === \"Z\") {\n            this.tempQuaternion.setFromAxisAngle(this.unitZ, Math.atan2(this.alignVector.y, this.alignVector.x));\n            this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2, this.tempQuaternion);\n            handle.quaternion.copy(this.tempQuaternion);\n          }\n        }\n        handle.visible = handle.visible && (handle.name.indexOf(\"X\") === -1 || this.showX);\n        handle.visible = handle.visible && (handle.name.indexOf(\"Y\") === -1 || this.showY);\n        handle.visible = handle.visible && (handle.name.indexOf(\"Z\") === -1 || this.showZ);\n        handle.visible = handle.visible && (handle.name.indexOf(\"E\") === -1 || this.showX && this.showY && this.showZ);\n        handle.material.tempOpacity = handle.material.tempOpacity || handle.material.opacity;\n        handle.material.tempColor = handle.material.tempColor || handle.material.color.clone();\n        handle.material.color.copy(handle.material.tempColor);\n        handle.material.opacity = handle.material.tempOpacity;\n        if (!this.enabled) {\n          handle.material.opacity *= 0.5;\n          handle.material.color.lerp(new three__WEBPACK_IMPORTED_MODULE_0__.Color(1, 1, 1), 0.5);\n        } else if (this.axis) {\n          if (handle.name === this.axis) {\n            handle.material.opacity = 1;\n            handle.material.color.lerp(new three__WEBPACK_IMPORTED_MODULE_0__.Color(1, 1, 1), 0.5);\n          } else if (this.axis.split(\"\").some(function(a) {\n            return handle.name === a;\n          })) {\n            handle.material.opacity = 1;\n            handle.material.color.lerp(new three__WEBPACK_IMPORTED_MODULE_0__.Color(1, 1, 1), 0.5);\n          } else {\n            handle.material.opacity *= 0.25;\n            handle.material.color.lerp(new three__WEBPACK_IMPORTED_MODULE_0__.Color(1, 1, 1), 0.5);\n          }\n        }\n      }\n      super.updateMatrixWorld();\n    });\n    const gizmoMaterial = new three__WEBPACK_IMPORTED_MODULE_0__.MeshBasicMaterial({\n      depthTest: false,\n      depthWrite: false,\n      transparent: true,\n      side: three__WEBPACK_IMPORTED_MODULE_0__.DoubleSide,\n      fog: false,\n      toneMapped: false\n    });\n    const gizmoLineMaterial = new three__WEBPACK_IMPORTED_MODULE_0__.LineBasicMaterial({\n      depthTest: false,\n      depthWrite: false,\n      transparent: true,\n      linewidth: 1,\n      fog: false,\n      toneMapped: false\n    });\n    const matInvisible = gizmoMaterial.clone();\n    matInvisible.opacity = 0.15;\n    const matHelper = gizmoMaterial.clone();\n    matHelper.opacity = 0.33;\n    const matRed = gizmoMaterial.clone();\n    matRed.color.set(16711680);\n    const matGreen = gizmoMaterial.clone();\n    matGreen.color.set(65280);\n    const matBlue = gizmoMaterial.clone();\n    matBlue.color.set(255);\n    const matWhiteTransparent = gizmoMaterial.clone();\n    matWhiteTransparent.opacity = 0.25;\n    const matYellowTransparent = matWhiteTransparent.clone();\n    matYellowTransparent.color.set(16776960);\n    const matCyanTransparent = matWhiteTransparent.clone();\n    matCyanTransparent.color.set(65535);\n    const matMagentaTransparent = matWhiteTransparent.clone();\n    matMagentaTransparent.color.set(16711935);\n    const matYellow = gizmoMaterial.clone();\n    matYellow.color.set(16776960);\n    const matLineRed = gizmoLineMaterial.clone();\n    matLineRed.color.set(16711680);\n    const matLineGreen = gizmoLineMaterial.clone();\n    matLineGreen.color.set(65280);\n    const matLineBlue = gizmoLineMaterial.clone();\n    matLineBlue.color.set(255);\n    const matLineCyan = gizmoLineMaterial.clone();\n    matLineCyan.color.set(65535);\n    const matLineMagenta = gizmoLineMaterial.clone();\n    matLineMagenta.color.set(16711935);\n    const matLineYellow = gizmoLineMaterial.clone();\n    matLineYellow.color.set(16776960);\n    const matLineGray = gizmoLineMaterial.clone();\n    matLineGray.color.set(7895160);\n    const matLineYellowTransparent = matLineYellow.clone();\n    matLineYellowTransparent.opacity = 0.25;\n    const arrowGeometry = new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0, 0.05, 0.2, 12, 1, false);\n    const scaleHandleGeometry = new three__WEBPACK_IMPORTED_MODULE_0__.BoxGeometry(0.125, 0.125, 0.125);\n    const lineGeometry = new three__WEBPACK_IMPORTED_MODULE_0__.BufferGeometry();\n    lineGeometry.setAttribute(\"position\", new three__WEBPACK_IMPORTED_MODULE_0__.Float32BufferAttribute([0, 0, 0, 1, 0, 0], 3));\n    const CircleGeometry = (radius, arc) => {\n      const geometry = new three__WEBPACK_IMPORTED_MODULE_0__.BufferGeometry();\n      const vertices = [];\n      for (let i = 0; i <= 64 * arc; ++i) {\n        vertices.push(0, Math.cos(i / 32 * Math.PI) * radius, Math.sin(i / 32 * Math.PI) * radius);\n      }\n      geometry.setAttribute(\"position\", new three__WEBPACK_IMPORTED_MODULE_0__.Float32BufferAttribute(vertices, 3));\n      return geometry;\n    };\n    const TranslateHelperGeometry = () => {\n      const geometry = new three__WEBPACK_IMPORTED_MODULE_0__.BufferGeometry();\n      geometry.setAttribute(\"position\", new three__WEBPACK_IMPORTED_MODULE_0__.Float32BufferAttribute([0, 0, 0, 1, 1, 1], 3));\n      return geometry;\n    };\n    const gizmoTranslate = {\n      X: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, -Math.PI / 2], null, \"fwd\"],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, Math.PI / 2], null, \"bwd\"],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineRed)]\n      ],\n      Y: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(arrowGeometry, matGreen), [0, 1, 0], null, null, \"fwd\"],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(arrowGeometry, matGreen), [0, 1, 0], [Math.PI, 0, 0], null, \"bwd\"],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2]]\n      ],\n      Z: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(arrowGeometry, matBlue), [0, 0, 1], [Math.PI / 2, 0, 0], null, \"fwd\"],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(arrowGeometry, matBlue), [0, 0, 1], [-Math.PI / 2, 0, 0], null, \"bwd\"],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0]]\n      ],\n      XYZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.OctahedronGeometry(0.1, 0), matWhiteTransparent.clone()), [0, 0, 0], [0, 0, 0]]],\n      XY: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.PlaneGeometry(0.295, 0.295), matYellowTransparent.clone()), [0.15, 0.15, 0]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineYellow), [0.18, 0.3, 0], null, [0.125, 1, 1]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineYellow), [0.3, 0.18, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]\n      ],\n      YZ: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.PlaneGeometry(0.295, 0.295), matCyanTransparent.clone()), [0, 0.15, 0.15], [0, Math.PI / 2, 0]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineCyan), [0, 0.18, 0.3], [0, 0, Math.PI / 2], [0.125, 1, 1]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineCyan), [0, 0.3, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]\n      ],\n      XZ: [\n        [\n          new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.PlaneGeometry(0.295, 0.295), matMagentaTransparent.clone()),\n          [0.15, 0, 0.15],\n          [-Math.PI / 2, 0, 0]\n        ],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineMagenta), [0.18, 0, 0.3], null, [0.125, 1, 1]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineMagenta), [0.3, 0, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]\n      ]\n    };\n    const pickerTranslate = {\n      X: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0.6, 0, 0], [0, 0, -Math.PI / 2]]],\n      Y: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0.6, 0]]],\n      Z: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0, 0.6], [Math.PI / 2, 0, 0]]],\n      XYZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.OctahedronGeometry(0.2, 0), matInvisible)]],\n      XY: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.PlaneGeometry(0.4, 0.4), matInvisible), [0.2, 0.2, 0]]],\n      YZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.PlaneGeometry(0.4, 0.4), matInvisible), [0, 0.2, 0.2], [0, Math.PI / 2, 0]]],\n      XZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.PlaneGeometry(0.4, 0.4), matInvisible), [0.2, 0, 0.2], [-Math.PI / 2, 0, 0]]]\n    };\n    const helperTranslate = {\n      START: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.OctahedronGeometry(0.01, 2), matHelper), null, null, null, \"helper\"]],\n      END: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.OctahedronGeometry(0.01, 2), matHelper), null, null, null, \"helper\"]],\n      DELTA: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(TranslateHelperGeometry(), matHelper), null, null, null, \"helper\"]],\n      X: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], \"helper\"]],\n      Y: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], \"helper\"]],\n      Z: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], \"helper\"]]\n    };\n    const gizmoRotate = {\n      X: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(CircleGeometry(1, 0.5), matLineRed)],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.OctahedronGeometry(0.04, 0), matRed), [0, 0, 0.99], null, [1, 3, 1]]\n      ],\n      Y: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(CircleGeometry(1, 0.5), matLineGreen), null, [0, 0, -Math.PI / 2]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.OctahedronGeometry(0.04, 0), matGreen), [0, 0, 0.99], null, [3, 1, 1]]\n      ],\n      Z: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(CircleGeometry(1, 0.5), matLineBlue), null, [0, Math.PI / 2, 0]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.OctahedronGeometry(0.04, 0), matBlue), [0.99, 0, 0], null, [1, 3, 1]]\n      ],\n      E: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(CircleGeometry(1.25, 1), matLineYellowTransparent), null, [0, Math.PI / 2, 0]],\n        [\n          new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\n          [1.17, 0, 0],\n          [0, 0, -Math.PI / 2],\n          [1, 1, 1e-3]\n        ],\n        [\n          new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\n          [-1.17, 0, 0],\n          [0, 0, Math.PI / 2],\n          [1, 1, 1e-3]\n        ],\n        [\n          new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\n          [0, -1.17, 0],\n          [Math.PI, 0, 0],\n          [1, 1, 1e-3]\n        ],\n        [\n          new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\n          [0, 1.17, 0],\n          [0, 0, 0],\n          [1, 1, 1e-3]\n        ]\n      ],\n      XYZE: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(CircleGeometry(1, 1), matLineGray), null, [0, Math.PI / 2, 0]]]\n    };\n    const helperRotate = {\n      AXIS: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], \"helper\"]]\n    };\n    const pickerRotate = {\n      X: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, -Math.PI / 2, -Math.PI / 2]]],\n      Y: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [Math.PI / 2, 0, 0]]],\n      Z: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, 0, -Math.PI / 2]]],\n      E: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.TorusGeometry(1.25, 0.1, 2, 24), matInvisible)]],\n      XYZE: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.SphereGeometry(0.7, 10, 8), matInvisible)]]\n    };\n    const gizmoScale = {\n      X: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matRed), [0.8, 0, 0], [0, 0, -Math.PI / 2]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineRed), null, null, [0.8, 1, 1]]\n      ],\n      Y: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matGreen), [0, 0.8, 0]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2], [0.8, 1, 1]]\n      ],\n      Z: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matBlue), [0, 0, 0.8], [Math.PI / 2, 0, 0]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0], [0.8, 1, 1]]\n      ],\n      XY: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matYellowTransparent), [0.85, 0.85, 0], null, [2, 2, 0.2]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineYellow), [0.855, 0.98, 0], null, [0.125, 1, 1]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineYellow), [0.98, 0.855, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]\n      ],\n      YZ: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matCyanTransparent), [0, 0.85, 0.85], null, [0.2, 2, 2]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineCyan), [0, 0.855, 0.98], [0, 0, Math.PI / 2], [0.125, 1, 1]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineCyan), [0, 0.98, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]\n      ],\n      XZ: [\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matMagentaTransparent), [0.85, 0, 0.85], null, [2, 0.2, 2]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineMagenta), [0.855, 0, 0.98], null, [0.125, 1, 1]],\n        [new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matLineMagenta), [0.98, 0, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]\n      ],\n      XYZX: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [1.1, 0, 0]]],\n      XYZY: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 1.1, 0]]],\n      XYZZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 0, 1.1]]]\n    };\n    const pickerScale = {\n      X: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0.5, 0, 0], [0, 0, -Math.PI / 2]]],\n      Y: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0.5, 0]]],\n      Z: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0, 0.5], [Math.PI / 2, 0, 0]]],\n      XY: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matInvisible), [0.85, 0.85, 0], null, [3, 3, 0.2]]],\n      YZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matInvisible), [0, 0.85, 0.85], null, [0.2, 3, 3]]],\n      XZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(scaleHandleGeometry, matInvisible), [0.85, 0, 0.85], null, [3, 0.2, 3]]],\n      XYZX: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.BoxGeometry(0.2, 0.2, 0.2), matInvisible), [1.1, 0, 0]]],\n      XYZY: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.BoxGeometry(0.2, 0.2, 0.2), matInvisible), [0, 1.1, 0]]],\n      XYZZ: [[new three__WEBPACK_IMPORTED_MODULE_0__.Mesh(new three__WEBPACK_IMPORTED_MODULE_0__.BoxGeometry(0.2, 0.2, 0.2), matInvisible), [0, 0, 1.1]]]\n    };\n    const helperScale = {\n      X: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], \"helper\"]],\n      Y: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], \"helper\"]],\n      Z: [[new three__WEBPACK_IMPORTED_MODULE_0__.Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], \"helper\"]]\n    };\n    const setupGizmo = (gizmoMap) => {\n      const gizmo = new three__WEBPACK_IMPORTED_MODULE_0__.Object3D();\n      for (let name in gizmoMap) {\n        for (let i = gizmoMap[name].length; i--; ) {\n          const object = gizmoMap[name][i][0].clone();\n          const position = gizmoMap[name][i][1];\n          const rotation = gizmoMap[name][i][2];\n          const scale = gizmoMap[name][i][3];\n          const tag = gizmoMap[name][i][4];\n          object.name = name;\n          object.tag = tag;\n          if (position) {\n            object.position.set(position[0], position[1], position[2]);\n          }\n          if (rotation) {\n            object.rotation.set(rotation[0], rotation[1], rotation[2]);\n          }\n          if (scale) {\n            object.scale.set(scale[0], scale[1], scale[2]);\n          }\n          object.updateMatrix();\n          const tempGeometry = object.geometry.clone();\n          tempGeometry.applyMatrix4(object.matrix);\n          object.geometry = tempGeometry;\n          object.renderOrder = Infinity;\n          object.position.set(0, 0, 0);\n          object.rotation.set(0, 0, 0);\n          object.scale.set(1, 1, 1);\n          gizmo.add(object);\n        }\n      }\n      return gizmo;\n    };\n    this.gizmo = {};\n    this.picker = {};\n    this.helper = {};\n    this.add(this.gizmo[\"translate\"] = setupGizmo(gizmoTranslate));\n    this.add(this.gizmo[\"rotate\"] = setupGizmo(gizmoRotate));\n    this.add(this.gizmo[\"scale\"] = setupGizmo(gizmoScale));\n    this.add(this.picker[\"translate\"] = setupGizmo(pickerTranslate));\n    this.add(this.picker[\"rotate\"] = setupGizmo(pickerRotate));\n    this.add(this.picker[\"scale\"] = setupGizmo(pickerScale));\n    this.add(this.helper[\"translate\"] = setupGizmo(helperTranslate));\n    this.add(this.helper[\"rotate\"] = setupGizmo(helperRotate));\n    this.add(this.helper[\"scale\"] = setupGizmo(helperScale));\n    this.picker[\"translate\"].visible = false;\n    this.picker[\"rotate\"].visible = false;\n    this.picker[\"scale\"].visible = false;\n  }\n}\nclass TransformControlsPlane extends three__WEBPACK_IMPORTED_MODULE_0__.Mesh {\n  constructor() {\n    super(\n      new three__WEBPACK_IMPORTED_MODULE_0__.PlaneGeometry(1e5, 1e5, 2, 2),\n      new three__WEBPACK_IMPORTED_MODULE_0__.MeshBasicMaterial({\n        visible: false,\n        wireframe: true,\n        side: three__WEBPACK_IMPORTED_MODULE_0__.DoubleSide,\n        transparent: true,\n        opacity: 0.1,\n        toneMapped: false\n      })\n    );\n    __publicField(this, \"isTransformControlsPlane\", true);\n    __publicField(this, \"type\", \"TransformControlsPlane\");\n    __publicField(this, \"unitX\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(1, 0, 0));\n    __publicField(this, \"unitY\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 1, 0));\n    __publicField(this, \"unitZ\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3(0, 0, 1));\n    __publicField(this, \"tempVector\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"dirVector\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"alignVector\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"tempMatrix\", new three__WEBPACK_IMPORTED_MODULE_0__.Matrix4());\n    __publicField(this, \"identityQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    // these are set from parent class TransformControls\n    __publicField(this, \"cameraQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"worldPosition\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"worldQuaternion\", new three__WEBPACK_IMPORTED_MODULE_0__.Quaternion());\n    __publicField(this, \"eye\", new three__WEBPACK_IMPORTED_MODULE_0__.Vector3());\n    __publicField(this, \"axis\", null);\n    __publicField(this, \"mode\", \"translate\");\n    __publicField(this, \"space\", \"world\");\n    __publicField(this, \"updateMatrixWorld\", () => {\n      let space = this.space;\n      this.position.copy(this.worldPosition);\n      if (this.mode === \"scale\")\n        space = \"local\";\n      this.unitX.set(1, 0, 0).applyQuaternion(space === \"local\" ? this.worldQuaternion : this.identityQuaternion);\n      this.unitY.set(0, 1, 0).applyQuaternion(space === \"local\" ? this.worldQuaternion : this.identityQuaternion);\n      this.unitZ.set(0, 0, 1).applyQuaternion(space === \"local\" ? this.worldQuaternion : this.identityQuaternion);\n      this.alignVector.copy(this.unitY);\n      switch (this.mode) {\n        case \"translate\":\n        case \"scale\":\n          switch (this.axis) {\n            case \"X\":\n              this.alignVector.copy(this.eye).cross(this.unitX);\n              this.dirVector.copy(this.unitX).cross(this.alignVector);\n              break;\n            case \"Y\":\n              this.alignVector.copy(this.eye).cross(this.unitY);\n              this.dirVector.copy(this.unitY).cross(this.alignVector);\n              break;\n            case \"Z\":\n              this.alignVector.copy(this.eye).cross(this.unitZ);\n              this.dirVector.copy(this.unitZ).cross(this.alignVector);\n              break;\n            case \"XY\":\n              this.dirVector.copy(this.unitZ);\n              break;\n            case \"YZ\":\n              this.dirVector.copy(this.unitX);\n              break;\n            case \"XZ\":\n              this.alignVector.copy(this.unitZ);\n              this.dirVector.copy(this.unitY);\n              break;\n            case \"XYZ\":\n            case \"E\":\n              this.dirVector.set(0, 0, 0);\n              break;\n          }\n          break;\n        case \"rotate\":\n        default:\n          this.dirVector.set(0, 0, 0);\n      }\n      if (this.dirVector.length() === 0) {\n        this.quaternion.copy(this.cameraQuaternion);\n      } else {\n        this.tempMatrix.lookAt(this.tempVector.set(0, 0, 0), this.dirVector, this.alignVector);\n        this.quaternion.setFromRotationMatrix(this.tempMatrix);\n      }\n      super.updateMatrixWorld();\n    });\n  }\n}\n\n//# sourceMappingURL=TransformControls.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvdGhyZWUtc3RkbGliL2NvbnRyb2xzL1RyYW5zZm9ybUNvbnRyb2xzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBLDhFQUE4RSw2REFBNkQ7QUFDM0k7QUFDQTtBQUNBO0FBQ0E7QUFDK1I7QUFDL1IsZ0NBQWdDLDJDQUFRO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsNENBQVM7QUFDbEQ7QUFDQTtBQUNBLDBDQUEwQywwQ0FBTztBQUNqRCwyQ0FBMkMsMENBQU87QUFDbEQsOENBQThDLDZDQUFVO0FBQ3hEO0FBQ0EsYUFBYSwwQ0FBTztBQUNwQixhQUFhLDBDQUFPO0FBQ3BCLGFBQWEsMENBQU87QUFDcEIsS0FBSztBQUNMLDBDQUEwQywwQ0FBTztBQUNqRCx3Q0FBd0MsMENBQU87QUFDL0Msc0NBQXNDLDBDQUFPO0FBQzdDLDRDQUE0QywwQ0FBTztBQUNuRCx5Q0FBeUMsMENBQU87QUFDaEQsdUNBQXVDLDBDQUFPO0FBQzlDO0FBQ0EsOENBQThDLDBDQUFPO0FBQ3JELGdEQUFnRCw2Q0FBVTtBQUMxRCwyQ0FBMkMsMENBQU87QUFDbEQsOENBQThDLDBDQUFPO0FBQ3JELGdEQUFnRCw2Q0FBVTtBQUMxRCxtREFBbUQsNkNBQVU7QUFDN0QsMkNBQTJDLDBDQUFPO0FBQ2xELGtEQUFrRCwwQ0FBTztBQUN6RCxvREFBb0QsNkNBQVU7QUFDOUQsK0NBQStDLDBDQUFPO0FBQ3RELDZDQUE2QywwQ0FBTztBQUNwRCwrQ0FBK0MsNkNBQVU7QUFDekQsa0RBQWtELDZDQUFVO0FBQzVELDBDQUEwQywwQ0FBTztBQUNqRCxtQ0FBbUMsMENBQU87QUFDMUMsNkNBQTZDLDBDQUFPO0FBQ3BELCtDQUErQyw2Q0FBVTtBQUN6RCwwQ0FBMEMsMENBQU87QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLGdCQUFnQjtBQUN6RCw0Q0FBNEMsb0NBQW9DO0FBQ2hGLDBDQUEwQyxrQ0FBa0M7QUFDNUUsK0NBQStDLHNCQUFzQjtBQUNyRTtBQUNBO0FBQ0Esc0JBQXNCLDZCQUE2QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG9DQUFvQztBQUNyRTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDJDQUFRO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDBDQUFPO0FBQ2pELHlDQUF5Qyx3Q0FBSztBQUM5QywyQ0FBMkMsMENBQU87QUFDbEQsMENBQTBDLDBDQUFPO0FBQ2pELDRDQUE0QywwQ0FBTztBQUNuRCw4Q0FBOEMsNkNBQVU7QUFDeEQsK0NBQStDLDZDQUFVO0FBQ3pELGtEQUFrRCw2Q0FBVTtBQUM1RCxxQ0FBcUMsMENBQU87QUFDNUMscUNBQXFDLDBDQUFPO0FBQzVDLHFDQUFxQywwQ0FBTztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QywwQ0FBTztBQUNuRCw4Q0FBOEMsMENBQU87QUFDckQsa0RBQWtELDBDQUFPO0FBQ3pELG9EQUFvRCw2Q0FBVTtBQUM5RCw2Q0FBNkMsMENBQU87QUFDcEQsK0NBQStDLDZDQUFVO0FBQ3pELG1DQUFtQywwQ0FBTztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isb0JBQW9CO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsd0NBQUs7QUFDOUMsVUFBVTtBQUNWO0FBQ0E7QUFDQSwyQ0FBMkMsd0NBQUs7QUFDaEQsWUFBWTtBQUNaO0FBQ0EsV0FBVztBQUNYO0FBQ0EsMkNBQTJDLHdDQUFLO0FBQ2hELFlBQVk7QUFDWjtBQUNBLDJDQUEyQyx3Q0FBSztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCw4QkFBOEIsb0RBQWlCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLFlBQVksNkNBQVU7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0Msb0RBQWlCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsbURBQWdCO0FBQzlDLG9DQUFvQyw4Q0FBVztBQUMvQyw2QkFBNkIsaURBQWM7QUFDM0MsOENBQThDLHlEQUFzQjtBQUNwRTtBQUNBLDJCQUEyQixpREFBYztBQUN6QztBQUNBLHNCQUFzQixlQUFlO0FBQ3JDO0FBQ0E7QUFDQSw0Q0FBNEMseURBQXNCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpREFBYztBQUN6Qyw0Q0FBNEMseURBQXNCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1Q0FBSTtBQUNqQixhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUk7QUFDakI7QUFDQTtBQUNBLGFBQWEsdUNBQUk7QUFDakIsYUFBYSx1Q0FBSTtBQUNqQixhQUFhLHVDQUFJO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUk7QUFDakIsYUFBYSx1Q0FBSTtBQUNqQjtBQUNBLGlCQUFpQix1Q0FBSSxLQUFLLHFEQUFrQjtBQUM1QztBQUNBLGFBQWEsdUNBQUksS0FBSyxnREFBYTtBQUNuQyxhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUk7QUFDakI7QUFDQTtBQUNBLGFBQWEsdUNBQUksS0FBSyxnREFBYTtBQUNuQyxhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUk7QUFDakI7QUFDQTtBQUNBO0FBQ0EsY0FBYyx1Q0FBSSxLQUFLLGdEQUFhO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGFBQWEsdUNBQUk7QUFDakIsYUFBYSx1Q0FBSTtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxlQUFlLHVDQUFJLEtBQUssbURBQWdCO0FBQ3hDLGVBQWUsdUNBQUksS0FBSyxtREFBZ0I7QUFDeEMsZUFBZSx1Q0FBSSxLQUFLLG1EQUFnQjtBQUN4QyxpQkFBaUIsdUNBQUksS0FBSyxxREFBa0I7QUFDNUMsZ0JBQWdCLHVDQUFJLEtBQUssZ0RBQWE7QUFDdEMsZ0JBQWdCLHVDQUFJLEtBQUssZ0RBQWE7QUFDdEMsZ0JBQWdCLHVDQUFJLEtBQUssZ0RBQWE7QUFDdEM7QUFDQTtBQUNBLG1CQUFtQix1Q0FBSSxLQUFLLHFEQUFrQjtBQUM5QyxpQkFBaUIsdUNBQUksS0FBSyxxREFBa0I7QUFDNUMsbUJBQW1CLHVDQUFJO0FBQ3ZCLGVBQWUsdUNBQUk7QUFDbkIsZUFBZSx1Q0FBSTtBQUNuQixlQUFlLHVDQUFJO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLGFBQWEsdUNBQUk7QUFDakIsYUFBYSx1Q0FBSSxLQUFLLHFEQUFrQjtBQUN4QztBQUNBO0FBQ0EsYUFBYSx1Q0FBSTtBQUNqQixhQUFhLHVDQUFJLEtBQUsscURBQWtCO0FBQ3hDO0FBQ0E7QUFDQSxhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUksS0FBSyxxREFBa0I7QUFDeEM7QUFDQTtBQUNBLGFBQWEsdUNBQUk7QUFDakI7QUFDQSxjQUFjLHVDQUFJLEtBQUssbURBQWdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHVDQUFJLEtBQUssbURBQWdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHVDQUFJLEtBQUssbURBQWdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHVDQUFJLEtBQUssbURBQWdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsdUNBQUk7QUFDdEI7QUFDQTtBQUNBLGtCQUFrQix1Q0FBSTtBQUN0QjtBQUNBO0FBQ0EsZUFBZSx1Q0FBSSxLQUFLLGdEQUFhO0FBQ3JDLGVBQWUsdUNBQUksS0FBSyxnREFBYTtBQUNyQyxlQUFlLHVDQUFJLEtBQUssZ0RBQWE7QUFDckMsZUFBZSx1Q0FBSSxLQUFLLGdEQUFhO0FBQ3JDLGtCQUFrQix1Q0FBSSxLQUFLLGlEQUFjO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLGFBQWEsdUNBQUk7QUFDakIsYUFBYSx1Q0FBSTtBQUNqQjtBQUNBO0FBQ0EsYUFBYSx1Q0FBSTtBQUNqQixhQUFhLHVDQUFJO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUk7QUFDakI7QUFDQTtBQUNBLGFBQWEsdUNBQUk7QUFDakIsYUFBYSx1Q0FBSTtBQUNqQixhQUFhLHVDQUFJO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUk7QUFDakIsYUFBYSx1Q0FBSTtBQUNqQjtBQUNBO0FBQ0EsYUFBYSx1Q0FBSTtBQUNqQixhQUFhLHVDQUFJO0FBQ2pCLGFBQWEsdUNBQUk7QUFDakI7QUFDQSxrQkFBa0IsdUNBQUksS0FBSyw4Q0FBVztBQUN0QyxrQkFBa0IsdUNBQUksS0FBSyw4Q0FBVztBQUN0QyxrQkFBa0IsdUNBQUksS0FBSyw4Q0FBVztBQUN0QztBQUNBO0FBQ0EsZUFBZSx1Q0FBSSxLQUFLLG1EQUFnQjtBQUN4QyxlQUFlLHVDQUFJLEtBQUssbURBQWdCO0FBQ3hDLGVBQWUsdUNBQUksS0FBSyxtREFBZ0I7QUFDeEMsZ0JBQWdCLHVDQUFJO0FBQ3BCLGdCQUFnQix1Q0FBSTtBQUNwQixnQkFBZ0IsdUNBQUk7QUFDcEIsa0JBQWtCLHVDQUFJLEtBQUssOENBQVc7QUFDdEMsa0JBQWtCLHVDQUFJLEtBQUssOENBQVc7QUFDdEMsa0JBQWtCLHVDQUFJLEtBQUssOENBQVc7QUFDdEM7QUFDQTtBQUNBLGVBQWUsdUNBQUk7QUFDbkIsZUFBZSx1Q0FBSTtBQUNuQixlQUFlLHVDQUFJO0FBQ25CO0FBQ0E7QUFDQSx3QkFBd0IsMkNBQVE7QUFDaEM7QUFDQSw0Q0FBNEMsS0FBSztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx1Q0FBSTtBQUN6QztBQUNBO0FBQ0EsVUFBVSxnREFBYTtBQUN2QixVQUFVLG9EQUFpQjtBQUMzQjtBQUNBO0FBQ0EsY0FBYyw2Q0FBVTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDBDQUFPO0FBQzVDLHFDQUFxQywwQ0FBTztBQUM1QyxxQ0FBcUMsMENBQU87QUFDNUMsMENBQTBDLDBDQUFPO0FBQ2pELHlDQUF5QywwQ0FBTztBQUNoRCwyQ0FBMkMsMENBQU87QUFDbEQsMENBQTBDLDBDQUFPO0FBQ2pELGtEQUFrRCw2Q0FBVTtBQUM1RDtBQUNBLGdEQUFnRCw2Q0FBVTtBQUMxRCw2Q0FBNkMsMENBQU87QUFDcEQsK0NBQStDLDZDQUFVO0FBQ3pELG1DQUFtQywwQ0FBTztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFLRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VuYXJ0X3NpdGUvLi9ub2RlX21vZHVsZXMvdGhyZWUtc3RkbGliL2NvbnRyb2xzL1RyYW5zZm9ybUNvbnRyb2xzLmpzPzEzOTUiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3B1YmxpY0ZpZWxkID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ge1xuICBfX2RlZk5vcm1hbFByb3Aob2JqLCB0eXBlb2Yga2V5ICE9PSBcInN5bWJvbFwiID8ga2V5ICsgXCJcIiA6IGtleSwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xuaW1wb3J0IHsgT2JqZWN0M0QsIFJheWNhc3RlciwgVmVjdG9yMywgUXVhdGVybmlvbiwgRXVsZXIsIE1hdHJpeDQsIE1lc2hCYXNpY01hdGVyaWFsLCBEb3VibGVTaWRlLCBMaW5lQmFzaWNNYXRlcmlhbCwgQ3lsaW5kZXJHZW9tZXRyeSwgQm94R2VvbWV0cnksIEJ1ZmZlckdlb21ldHJ5LCBGbG9hdDMyQnVmZmVyQXR0cmlidXRlLCBNZXNoLCBMaW5lLCBPY3RhaGVkcm9uR2VvbWV0cnksIFBsYW5lR2VvbWV0cnksIFRvcnVzR2VvbWV0cnksIFNwaGVyZUdlb21ldHJ5LCBDb2xvciB9IGZyb20gXCJ0aHJlZVwiO1xuY2xhc3MgVHJhbnNmb3JtQ29udHJvbHMgZXh0ZW5kcyBPYmplY3QzRCB7XG4gIGNvbnN0cnVjdG9yKGNhbWVyYSwgZG9tRWxlbWVudCkge1xuICAgIHN1cGVyKCk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImlzVHJhbnNmb3JtQ29udHJvbHNcIiwgdHJ1ZSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInZpc2libGVcIiwgZmFsc2UpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJkb21FbGVtZW50XCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJyYXljYXN0ZXJcIiwgbmV3IFJheWNhc3RlcigpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZ2l6bW9cIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInBsYW5lXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0ZW1wVmVjdG9yXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0ZW1wVmVjdG9yMlwiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwidGVtcFF1YXRlcm5pb25cIiwgbmV3IFF1YXRlcm5pb24oKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInVuaXRcIiwge1xuICAgICAgWDogbmV3IFZlY3RvcjMoMSwgMCwgMCksXG4gICAgICBZOiBuZXcgVmVjdG9yMygwLCAxLCAwKSxcbiAgICAgIFo6IG5ldyBWZWN0b3IzKDAsIDAsIDEpXG4gICAgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInBvaW50U3RhcnRcIiwgbmV3IFZlY3RvcjMoKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInBvaW50RW5kXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJvZmZzZXRcIiwgbmV3IFZlY3RvcjMoKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInJvdGF0aW9uQXhpc1wiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic3RhcnROb3JtXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJlbmROb3JtXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJyb3RhdGlvbkFuZ2xlXCIsIDApO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJjYW1lcmFQb3NpdGlvblwiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiY2FtZXJhUXVhdGVybmlvblwiLCBuZXcgUXVhdGVybmlvbigpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiY2FtZXJhU2NhbGVcIiwgbmV3IFZlY3RvcjMoKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInBhcmVudFBvc2l0aW9uXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwYXJlbnRRdWF0ZXJuaW9uXCIsIG5ldyBRdWF0ZXJuaW9uKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwYXJlbnRRdWF0ZXJuaW9uSW52XCIsIG5ldyBRdWF0ZXJuaW9uKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwYXJlbnRTY2FsZVwiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwid29ybGRQb3NpdGlvblN0YXJ0XCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ3b3JsZFF1YXRlcm5pb25TdGFydFwiLCBuZXcgUXVhdGVybmlvbigpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwid29ybGRTY2FsZVN0YXJ0XCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ3b3JsZFBvc2l0aW9uXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ3b3JsZFF1YXRlcm5pb25cIiwgbmV3IFF1YXRlcm5pb24oKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIndvcmxkUXVhdGVybmlvbkludlwiLCBuZXcgUXVhdGVybmlvbigpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwid29ybGRTY2FsZVwiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZXllXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwb3NpdGlvblN0YXJ0XCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJxdWF0ZXJuaW9uU3RhcnRcIiwgbmV3IFF1YXRlcm5pb24oKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInNjYWxlU3RhcnRcIiwgbmV3IFZlY3RvcjMoKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImNhbWVyYVwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwib2JqZWN0XCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJlbmFibGVkXCIsIHRydWUpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJheGlzXCIsIG51bGwpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJtb2RlXCIsIFwidHJhbnNsYXRlXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0cmFuc2xhdGlvblNuYXBcIiwgbnVsbCk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInJvdGF0aW9uU25hcFwiLCBudWxsKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic2NhbGVTbmFwXCIsIG51bGwpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzcGFjZVwiLCBcIndvcmxkXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzaXplXCIsIDEpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJkcmFnZ2luZ1wiLCBmYWxzZSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInNob3dYXCIsIHRydWUpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzaG93WVwiLCB0cnVlKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic2hvd1pcIiwgdHJ1ZSk7XG4gICAgLy8gZXZlbnRzXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImNoYW5nZUV2ZW50XCIsIHsgdHlwZTogXCJjaGFuZ2VcIiB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwibW91c2VEb3duRXZlbnRcIiwgeyB0eXBlOiBcIm1vdXNlRG93blwiLCBtb2RlOiB0aGlzLm1vZGUgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm1vdXNlVXBFdmVudFwiLCB7IHR5cGU6IFwibW91c2VVcFwiLCBtb2RlOiB0aGlzLm1vZGUgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm9iamVjdENoYW5nZUV2ZW50XCIsIHsgdHlwZTogXCJvYmplY3RDaGFuZ2VcIiB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiaW50ZXJzZWN0T2JqZWN0V2l0aFJheVwiLCAob2JqZWN0LCByYXljYXN0ZXIsIGluY2x1ZGVJbnZpc2libGUpID0+IHtcbiAgICAgIGNvbnN0IGFsbEludGVyc2VjdGlvbnMgPSByYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0KG9iamVjdCwgdHJ1ZSk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbEludGVyc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFsbEludGVyc2VjdGlvbnNbaV0ub2JqZWN0LnZpc2libGUgfHwgaW5jbHVkZUludmlzaWJsZSkge1xuICAgICAgICAgIHJldHVybiBhbGxJbnRlcnNlY3Rpb25zW2ldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgLy8gU2V0IGN1cnJlbnQgb2JqZWN0XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImF0dGFjaFwiLCAob2JqZWN0KSA9PiB7XG4gICAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9KTtcbiAgICAvLyBEZXRhdGNoIGZyb20gb2JqZWN0XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImRldGFjaFwiLCAoKSA9PiB7XG4gICAgICB0aGlzLm9iamVjdCA9IHZvaWQgMDtcbiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgdGhpcy5heGlzID0gbnVsbDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0pO1xuICAgIC8vIFJlc2V0XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInJlc2V0XCIsICgpID0+IHtcbiAgICAgIGlmICghdGhpcy5lbmFibGVkKVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIGlmICh0aGlzLmRyYWdnaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLm9iamVjdCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgdGhpcy5vYmplY3QucG9zaXRpb24uY29weSh0aGlzLnBvc2l0aW9uU3RhcnQpO1xuICAgICAgICAgIHRoaXMub2JqZWN0LnF1YXRlcm5pb24uY29weSh0aGlzLnF1YXRlcm5pb25TdGFydCk7XG4gICAgICAgICAgdGhpcy5vYmplY3Quc2NhbGUuY29weSh0aGlzLnNjYWxlU3RhcnQpO1xuICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCh0aGlzLmNoYW5nZUV2ZW50KTtcbiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5vYmplY3RDaGFuZ2VFdmVudCk7XG4gICAgICAgICAgdGhpcy5wb2ludFN0YXJ0LmNvcHkodGhpcy5wb2ludEVuZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ1cGRhdGVNYXRyaXhXb3JsZFwiLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5vYmplY3QgIT09IHZvaWQgMCkge1xuICAgICAgICB0aGlzLm9iamVjdC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgICAgICBpZiAodGhpcy5vYmplY3QucGFyZW50ID09PSBudWxsKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIlRyYW5zZm9ybUNvbnRyb2xzOiBUaGUgYXR0YWNoZWQgM0Qgb2JqZWN0IG11c3QgYmUgYSBwYXJ0IG9mIHRoZSBzY2VuZSBncmFwaC5cIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5vYmplY3QucGFyZW50Lm1hdHJpeFdvcmxkLmRlY29tcG9zZSh0aGlzLnBhcmVudFBvc2l0aW9uLCB0aGlzLnBhcmVudFF1YXRlcm5pb24sIHRoaXMucGFyZW50U2NhbGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub2JqZWN0Lm1hdHJpeFdvcmxkLmRlY29tcG9zZSh0aGlzLndvcmxkUG9zaXRpb24sIHRoaXMud29ybGRRdWF0ZXJuaW9uLCB0aGlzLndvcmxkU2NhbGUpO1xuICAgICAgICB0aGlzLnBhcmVudFF1YXRlcm5pb25JbnYuY29weSh0aGlzLnBhcmVudFF1YXRlcm5pb24pLmludmVydCgpO1xuICAgICAgICB0aGlzLndvcmxkUXVhdGVybmlvbkludi5jb3B5KHRoaXMud29ybGRRdWF0ZXJuaW9uKS5pbnZlcnQoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2FtZXJhLnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG4gICAgICB0aGlzLmNhbWVyYS5tYXRyaXhXb3JsZC5kZWNvbXBvc2UodGhpcy5jYW1lcmFQb3NpdGlvbiwgdGhpcy5jYW1lcmFRdWF0ZXJuaW9uLCB0aGlzLmNhbWVyYVNjYWxlKTtcbiAgICAgIHRoaXMuZXllLmNvcHkodGhpcy5jYW1lcmFQb3NpdGlvbikuc3ViKHRoaXMud29ybGRQb3NpdGlvbikubm9ybWFsaXplKCk7XG4gICAgICBzdXBlci51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwb2ludGVySG92ZXJcIiwgKHBvaW50ZXIpID0+IHtcbiAgICAgIGlmICh0aGlzLm9iamVjdCA9PT0gdm9pZCAwIHx8IHRoaXMuZHJhZ2dpbmcgPT09IHRydWUpXG4gICAgICAgIHJldHVybjtcbiAgICAgIHRoaXMucmF5Y2FzdGVyLnNldEZyb21DYW1lcmEocG9pbnRlciwgdGhpcy5jYW1lcmEpO1xuICAgICAgY29uc3QgaW50ZXJzZWN0ID0gdGhpcy5pbnRlcnNlY3RPYmplY3RXaXRoUmF5KHRoaXMuZ2l6bW8ucGlja2VyW3RoaXMubW9kZV0sIHRoaXMucmF5Y2FzdGVyKTtcbiAgICAgIGlmIChpbnRlcnNlY3QpIHtcbiAgICAgICAgdGhpcy5heGlzID0gaW50ZXJzZWN0Lm9iamVjdC5uYW1lO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5heGlzID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwicG9pbnRlckRvd25cIiwgKHBvaW50ZXIpID0+IHtcbiAgICAgIGlmICh0aGlzLm9iamVjdCA9PT0gdm9pZCAwIHx8IHRoaXMuZHJhZ2dpbmcgPT09IHRydWUgfHwgcG9pbnRlci5idXR0b24gIT09IDApXG4gICAgICAgIHJldHVybjtcbiAgICAgIGlmICh0aGlzLmF4aXMgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYShwb2ludGVyLCB0aGlzLmNhbWVyYSk7XG4gICAgICAgIGNvbnN0IHBsYW5lSW50ZXJzZWN0ID0gdGhpcy5pbnRlcnNlY3RPYmplY3RXaXRoUmF5KHRoaXMucGxhbmUsIHRoaXMucmF5Y2FzdGVyLCB0cnVlKTtcbiAgICAgICAgaWYgKHBsYW5lSW50ZXJzZWN0KSB7XG4gICAgICAgICAgbGV0IHNwYWNlID0gdGhpcy5zcGFjZTtcbiAgICAgICAgICBpZiAodGhpcy5tb2RlID09PSBcInNjYWxlXCIpIHtcbiAgICAgICAgICAgIHNwYWNlID0gXCJsb2NhbFwiO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5heGlzID09PSBcIkVcIiB8fCB0aGlzLmF4aXMgPT09IFwiWFlaRVwiIHx8IHRoaXMuYXhpcyA9PT0gXCJYWVpcIikge1xuICAgICAgICAgICAgc3BhY2UgPSBcIndvcmxkXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzcGFjZSA9PT0gXCJsb2NhbFwiICYmIHRoaXMubW9kZSA9PT0gXCJyb3RhdGVcIikge1xuICAgICAgICAgICAgY29uc3Qgc25hcCA9IHRoaXMucm90YXRpb25TbmFwO1xuICAgICAgICAgICAgaWYgKHRoaXMuYXhpcyA9PT0gXCJYXCIgJiYgc25hcClcbiAgICAgICAgICAgICAgdGhpcy5vYmplY3Qucm90YXRpb24ueCA9IE1hdGgucm91bmQodGhpcy5vYmplY3Qucm90YXRpb24ueCAvIHNuYXApICogc25hcDtcbiAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09IFwiWVwiICYmIHNuYXApXG4gICAgICAgICAgICAgIHRoaXMub2JqZWN0LnJvdGF0aW9uLnkgPSBNYXRoLnJvdW5kKHRoaXMub2JqZWN0LnJvdGF0aW9uLnkgLyBzbmFwKSAqIHNuYXA7XG4gICAgICAgICAgICBpZiAodGhpcy5heGlzID09PSBcIlpcIiAmJiBzbmFwKVxuICAgICAgICAgICAgICB0aGlzLm9iamVjdC5yb3RhdGlvbi56ID0gTWF0aC5yb3VuZCh0aGlzLm9iamVjdC5yb3RhdGlvbi56IC8gc25hcCkgKiBzbmFwO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLm9iamVjdC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgICAgICAgIGlmICh0aGlzLm9iamVjdC5wYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMub2JqZWN0LnBhcmVudC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnBvc2l0aW9uU3RhcnQuY29weSh0aGlzLm9iamVjdC5wb3NpdGlvbik7XG4gICAgICAgICAgdGhpcy5xdWF0ZXJuaW9uU3RhcnQuY29weSh0aGlzLm9iamVjdC5xdWF0ZXJuaW9uKTtcbiAgICAgICAgICB0aGlzLnNjYWxlU3RhcnQuY29weSh0aGlzLm9iamVjdC5zY2FsZSk7XG4gICAgICAgICAgdGhpcy5vYmplY3QubWF0cml4V29ybGQuZGVjb21wb3NlKHRoaXMud29ybGRQb3NpdGlvblN0YXJ0LCB0aGlzLndvcmxkUXVhdGVybmlvblN0YXJ0LCB0aGlzLndvcmxkU2NhbGVTdGFydCk7XG4gICAgICAgICAgdGhpcy5wb2ludFN0YXJ0LmNvcHkocGxhbmVJbnRlcnNlY3QucG9pbnQpLnN1Yih0aGlzLndvcmxkUG9zaXRpb25TdGFydCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kcmFnZ2luZyA9IHRydWU7XG4gICAgICAgIHRoaXMubW91c2VEb3duRXZlbnQubW9kZSA9IHRoaXMubW9kZTtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMubW91c2VEb3duRXZlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwb2ludGVyTW92ZVwiLCAocG9pbnRlcikgPT4ge1xuICAgICAgY29uc3QgYXhpcyA9IHRoaXMuYXhpcztcbiAgICAgIGNvbnN0IG1vZGUgPSB0aGlzLm1vZGU7XG4gICAgICBjb25zdCBvYmplY3QgPSB0aGlzLm9iamVjdDtcbiAgICAgIGxldCBzcGFjZSA9IHRoaXMuc3BhY2U7XG4gICAgICBpZiAobW9kZSA9PT0gXCJzY2FsZVwiKSB7XG4gICAgICAgIHNwYWNlID0gXCJsb2NhbFwiO1xuICAgICAgfSBlbHNlIGlmIChheGlzID09PSBcIkVcIiB8fCBheGlzID09PSBcIlhZWkVcIiB8fCBheGlzID09PSBcIlhZWlwiKSB7XG4gICAgICAgIHNwYWNlID0gXCJ3b3JsZFwiO1xuICAgICAgfVxuICAgICAgaWYgKG9iamVjdCA9PT0gdm9pZCAwIHx8IGF4aXMgPT09IG51bGwgfHwgdGhpcy5kcmFnZ2luZyA9PT0gZmFsc2UgfHwgcG9pbnRlci5idXR0b24gIT09IC0xKVxuICAgICAgICByZXR1cm47XG4gICAgICB0aGlzLnJheWNhc3Rlci5zZXRGcm9tQ2FtZXJhKHBvaW50ZXIsIHRoaXMuY2FtZXJhKTtcbiAgICAgIGNvbnN0IHBsYW5lSW50ZXJzZWN0ID0gdGhpcy5pbnRlcnNlY3RPYmplY3RXaXRoUmF5KHRoaXMucGxhbmUsIHRoaXMucmF5Y2FzdGVyLCB0cnVlKTtcbiAgICAgIGlmICghcGxhbmVJbnRlcnNlY3QpXG4gICAgICAgIHJldHVybjtcbiAgICAgIHRoaXMucG9pbnRFbmQuY29weShwbGFuZUludGVyc2VjdC5wb2ludCkuc3ViKHRoaXMud29ybGRQb3NpdGlvblN0YXJ0KTtcbiAgICAgIGlmIChtb2RlID09PSBcInRyYW5zbGF0ZVwiKSB7XG4gICAgICAgIHRoaXMub2Zmc2V0LmNvcHkodGhpcy5wb2ludEVuZCkuc3ViKHRoaXMucG9pbnRTdGFydCk7XG4gICAgICAgIGlmIChzcGFjZSA9PT0gXCJsb2NhbFwiICYmIGF4aXMgIT09IFwiWFlaXCIpIHtcbiAgICAgICAgICB0aGlzLm9mZnNldC5hcHBseVF1YXRlcm5pb24odGhpcy53b3JsZFF1YXRlcm5pb25JbnYpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChheGlzLmluZGV4T2YoXCJYXCIpID09PSAtMSlcbiAgICAgICAgICB0aGlzLm9mZnNldC54ID0gMDtcbiAgICAgICAgaWYgKGF4aXMuaW5kZXhPZihcIllcIikgPT09IC0xKVxuICAgICAgICAgIHRoaXMub2Zmc2V0LnkgPSAwO1xuICAgICAgICBpZiAoYXhpcy5pbmRleE9mKFwiWlwiKSA9PT0gLTEpXG4gICAgICAgICAgdGhpcy5vZmZzZXQueiA9IDA7XG4gICAgICAgIGlmIChzcGFjZSA9PT0gXCJsb2NhbFwiICYmIGF4aXMgIT09IFwiWFlaXCIpIHtcbiAgICAgICAgICB0aGlzLm9mZnNldC5hcHBseVF1YXRlcm5pb24odGhpcy5xdWF0ZXJuaW9uU3RhcnQpLmRpdmlkZSh0aGlzLnBhcmVudFNjYWxlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm9mZnNldC5hcHBseVF1YXRlcm5pb24odGhpcy5wYXJlbnRRdWF0ZXJuaW9uSW52KS5kaXZpZGUodGhpcy5wYXJlbnRTY2FsZSk7XG4gICAgICAgIH1cbiAgICAgICAgb2JqZWN0LnBvc2l0aW9uLmNvcHkodGhpcy5vZmZzZXQpLmFkZCh0aGlzLnBvc2l0aW9uU3RhcnQpO1xuICAgICAgICBpZiAodGhpcy50cmFuc2xhdGlvblNuYXApIHtcbiAgICAgICAgICBpZiAoc3BhY2UgPT09IFwibG9jYWxcIikge1xuICAgICAgICAgICAgb2JqZWN0LnBvc2l0aW9uLmFwcGx5UXVhdGVybmlvbih0aGlzLnRlbXBRdWF0ZXJuaW9uLmNvcHkodGhpcy5xdWF0ZXJuaW9uU3RhcnQpLmludmVydCgpKTtcbiAgICAgICAgICAgIGlmIChheGlzLnNlYXJjaChcIlhcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgIG9iamVjdC5wb3NpdGlvbi54ID0gTWF0aC5yb3VuZChvYmplY3QucG9zaXRpb24ueCAvIHRoaXMudHJhbnNsYXRpb25TbmFwKSAqIHRoaXMudHJhbnNsYXRpb25TbmFwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF4aXMuc2VhcmNoKFwiWVwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgb2JqZWN0LnBvc2l0aW9uLnkgPSBNYXRoLnJvdW5kKG9iamVjdC5wb3NpdGlvbi55IC8gdGhpcy50cmFuc2xhdGlvblNuYXApICogdGhpcy50cmFuc2xhdGlvblNuYXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXhpcy5zZWFyY2goXCJaXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICBvYmplY3QucG9zaXRpb24ueiA9IE1hdGgucm91bmQob2JqZWN0LnBvc2l0aW9uLnogLyB0aGlzLnRyYW5zbGF0aW9uU25hcCkgKiB0aGlzLnRyYW5zbGF0aW9uU25hcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9iamVjdC5wb3NpdGlvbi5hcHBseVF1YXRlcm5pb24odGhpcy5xdWF0ZXJuaW9uU3RhcnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoc3BhY2UgPT09IFwid29ybGRcIikge1xuICAgICAgICAgICAgaWYgKG9iamVjdC5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgb2JqZWN0LnBvc2l0aW9uLmFkZCh0aGlzLnRlbXBWZWN0b3Iuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKG9iamVjdC5wYXJlbnQubWF0cml4V29ybGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChheGlzLnNlYXJjaChcIlhcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgIG9iamVjdC5wb3NpdGlvbi54ID0gTWF0aC5yb3VuZChvYmplY3QucG9zaXRpb24ueCAvIHRoaXMudHJhbnNsYXRpb25TbmFwKSAqIHRoaXMudHJhbnNsYXRpb25TbmFwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF4aXMuc2VhcmNoKFwiWVwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgb2JqZWN0LnBvc2l0aW9uLnkgPSBNYXRoLnJvdW5kKG9iamVjdC5wb3NpdGlvbi55IC8gdGhpcy50cmFuc2xhdGlvblNuYXApICogdGhpcy50cmFuc2xhdGlvblNuYXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXhpcy5zZWFyY2goXCJaXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICBvYmplY3QucG9zaXRpb24ueiA9IE1hdGgucm91bmQob2JqZWN0LnBvc2l0aW9uLnogLyB0aGlzLnRyYW5zbGF0aW9uU25hcCkgKiB0aGlzLnRyYW5zbGF0aW9uU25hcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvYmplY3QucGFyZW50KSB7XG4gICAgICAgICAgICAgIG9iamVjdC5wb3NpdGlvbi5zdWIodGhpcy50ZW1wVmVjdG9yLnNldEZyb21NYXRyaXhQb3NpdGlvbihvYmplY3QucGFyZW50Lm1hdHJpeFdvcmxkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG1vZGUgPT09IFwic2NhbGVcIikge1xuICAgICAgICBpZiAoYXhpcy5zZWFyY2goXCJYWVpcIikgIT09IC0xKSB7XG4gICAgICAgICAgbGV0IGQgPSB0aGlzLnBvaW50RW5kLmxlbmd0aCgpIC8gdGhpcy5wb2ludFN0YXJ0Lmxlbmd0aCgpO1xuICAgICAgICAgIGlmICh0aGlzLnBvaW50RW5kLmRvdCh0aGlzLnBvaW50U3RhcnQpIDwgMClcbiAgICAgICAgICAgIGQgKj0gLTE7XG4gICAgICAgICAgdGhpcy50ZW1wVmVjdG9yMi5zZXQoZCwgZCwgZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50ZW1wVmVjdG9yLmNvcHkodGhpcy5wb2ludFN0YXJ0KTtcbiAgICAgICAgICB0aGlzLnRlbXBWZWN0b3IyLmNvcHkodGhpcy5wb2ludEVuZCk7XG4gICAgICAgICAgdGhpcy50ZW1wVmVjdG9yLmFwcGx5UXVhdGVybmlvbih0aGlzLndvcmxkUXVhdGVybmlvbkludik7XG4gICAgICAgICAgdGhpcy50ZW1wVmVjdG9yMi5hcHBseVF1YXRlcm5pb24odGhpcy53b3JsZFF1YXRlcm5pb25JbnYpO1xuICAgICAgICAgIHRoaXMudGVtcFZlY3RvcjIuZGl2aWRlKHRoaXMudGVtcFZlY3Rvcik7XG4gICAgICAgICAgaWYgKGF4aXMuc2VhcmNoKFwiWFwiKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcFZlY3RvcjIueCA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChheGlzLnNlYXJjaChcIllcIikgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnRlbXBWZWN0b3IyLnkgPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoYXhpcy5zZWFyY2goXCJaXCIpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy50ZW1wVmVjdG9yMi56ID0gMTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb2JqZWN0LnNjYWxlLmNvcHkodGhpcy5zY2FsZVN0YXJ0KS5tdWx0aXBseSh0aGlzLnRlbXBWZWN0b3IyKTtcbiAgICAgICAgaWYgKHRoaXMuc2NhbGVTbmFwICYmIHRoaXMub2JqZWN0KSB7XG4gICAgICAgICAgaWYgKGF4aXMuc2VhcmNoKFwiWFwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMub2JqZWN0LnNjYWxlLnggPSBNYXRoLnJvdW5kKG9iamVjdC5zY2FsZS54IC8gdGhpcy5zY2FsZVNuYXApICogdGhpcy5zY2FsZVNuYXAgfHwgdGhpcy5zY2FsZVNuYXA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChheGlzLnNlYXJjaChcIllcIikgIT09IC0xKSB7XG4gICAgICAgICAgICBvYmplY3Quc2NhbGUueSA9IE1hdGgucm91bmQob2JqZWN0LnNjYWxlLnkgLyB0aGlzLnNjYWxlU25hcCkgKiB0aGlzLnNjYWxlU25hcCB8fCB0aGlzLnNjYWxlU25hcDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGF4aXMuc2VhcmNoKFwiWlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIG9iamVjdC5zY2FsZS56ID0gTWF0aC5yb3VuZChvYmplY3Quc2NhbGUueiAvIHRoaXMuc2NhbGVTbmFwKSAqIHRoaXMuc2NhbGVTbmFwIHx8IHRoaXMuc2NhbGVTbmFwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChtb2RlID09PSBcInJvdGF0ZVwiKSB7XG4gICAgICAgIHRoaXMub2Zmc2V0LmNvcHkodGhpcy5wb2ludEVuZCkuc3ViKHRoaXMucG9pbnRTdGFydCk7XG4gICAgICAgIGNvbnN0IFJPVEFUSU9OX1NQRUVEID0gMjAgLyB0aGlzLndvcmxkUG9zaXRpb24uZGlzdGFuY2VUbyh0aGlzLnRlbXBWZWN0b3Iuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHRoaXMuY2FtZXJhLm1hdHJpeFdvcmxkKSk7XG4gICAgICAgIGlmIChheGlzID09PSBcIkVcIikge1xuICAgICAgICAgIHRoaXMucm90YXRpb25BeGlzLmNvcHkodGhpcy5leWUpO1xuICAgICAgICAgIHRoaXMucm90YXRpb25BbmdsZSA9IHRoaXMucG9pbnRFbmQuYW5nbGVUbyh0aGlzLnBvaW50U3RhcnQpO1xuICAgICAgICAgIHRoaXMuc3RhcnROb3JtLmNvcHkodGhpcy5wb2ludFN0YXJ0KS5ub3JtYWxpemUoKTtcbiAgICAgICAgICB0aGlzLmVuZE5vcm0uY29weSh0aGlzLnBvaW50RW5kKS5ub3JtYWxpemUoKTtcbiAgICAgICAgICB0aGlzLnJvdGF0aW9uQW5nbGUgKj0gdGhpcy5lbmROb3JtLmNyb3NzKHRoaXMuc3RhcnROb3JtKS5kb3QodGhpcy5leWUpIDwgMCA/IDEgOiAtMTtcbiAgICAgICAgfSBlbHNlIGlmIChheGlzID09PSBcIlhZWkVcIikge1xuICAgICAgICAgIHRoaXMucm90YXRpb25BeGlzLmNvcHkodGhpcy5vZmZzZXQpLmNyb3NzKHRoaXMuZXllKS5ub3JtYWxpemUoKTtcbiAgICAgICAgICB0aGlzLnJvdGF0aW9uQW5nbGUgPSB0aGlzLm9mZnNldC5kb3QodGhpcy50ZW1wVmVjdG9yLmNvcHkodGhpcy5yb3RhdGlvbkF4aXMpLmNyb3NzKHRoaXMuZXllKSkgKiBST1RBVElPTl9TUEVFRDtcbiAgICAgICAgfSBlbHNlIGlmIChheGlzID09PSBcIlhcIiB8fCBheGlzID09PSBcIllcIiB8fCBheGlzID09PSBcIlpcIikge1xuICAgICAgICAgIHRoaXMucm90YXRpb25BeGlzLmNvcHkodGhpcy51bml0W2F4aXNdKTtcbiAgICAgICAgICB0aGlzLnRlbXBWZWN0b3IuY29weSh0aGlzLnVuaXRbYXhpc10pO1xuICAgICAgICAgIGlmIChzcGFjZSA9PT0gXCJsb2NhbFwiKSB7XG4gICAgICAgICAgICB0aGlzLnRlbXBWZWN0b3IuYXBwbHlRdWF0ZXJuaW9uKHRoaXMud29ybGRRdWF0ZXJuaW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5yb3RhdGlvbkFuZ2xlID0gdGhpcy5vZmZzZXQuZG90KHRoaXMudGVtcFZlY3Rvci5jcm9zcyh0aGlzLmV5ZSkubm9ybWFsaXplKCkpICogUk9UQVRJT05fU1BFRUQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucm90YXRpb25TbmFwKSB7XG4gICAgICAgICAgdGhpcy5yb3RhdGlvbkFuZ2xlID0gTWF0aC5yb3VuZCh0aGlzLnJvdGF0aW9uQW5nbGUgLyB0aGlzLnJvdGF0aW9uU25hcCkgKiB0aGlzLnJvdGF0aW9uU25hcDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3BhY2UgPT09IFwibG9jYWxcIiAmJiBheGlzICE9PSBcIkVcIiAmJiBheGlzICE9PSBcIlhZWkVcIikge1xuICAgICAgICAgIG9iamVjdC5xdWF0ZXJuaW9uLmNvcHkodGhpcy5xdWF0ZXJuaW9uU3RhcnQpO1xuICAgICAgICAgIG9iamVjdC5xdWF0ZXJuaW9uLm11bHRpcGx5KHRoaXMudGVtcFF1YXRlcm5pb24uc2V0RnJvbUF4aXNBbmdsZSh0aGlzLnJvdGF0aW9uQXhpcywgdGhpcy5yb3RhdGlvbkFuZ2xlKSkubm9ybWFsaXplKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5yb3RhdGlvbkF4aXMuYXBwbHlRdWF0ZXJuaW9uKHRoaXMucGFyZW50UXVhdGVybmlvbkludik7XG4gICAgICAgICAgb2JqZWN0LnF1YXRlcm5pb24uY29weSh0aGlzLnRlbXBRdWF0ZXJuaW9uLnNldEZyb21BeGlzQW5nbGUodGhpcy5yb3RhdGlvbkF4aXMsIHRoaXMucm90YXRpb25BbmdsZSkpO1xuICAgICAgICAgIG9iamVjdC5xdWF0ZXJuaW9uLm11bHRpcGx5KHRoaXMucXVhdGVybmlvblN0YXJ0KS5ub3JtYWxpemUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMuY2hhbmdlRXZlbnQpO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMub2JqZWN0Q2hhbmdlRXZlbnQpO1xuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwb2ludGVyVXBcIiwgKHBvaW50ZXIpID0+IHtcbiAgICAgIGlmIChwb2ludGVyLmJ1dHRvbiAhPT0gMClcbiAgICAgICAgcmV0dXJuO1xuICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgJiYgdGhpcy5heGlzICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMubW91c2VVcEV2ZW50Lm1vZGUgPSB0aGlzLm1vZGU7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCh0aGlzLm1vdXNlVXBFdmVudCk7XG4gICAgICB9XG4gICAgICB0aGlzLmRyYWdnaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLmF4aXMgPSBudWxsO1xuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJnZXRQb2ludGVyXCIsIChldmVudCkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgaWYgKHRoaXMuZG9tRWxlbWVudCAmJiAoKF9hID0gdGhpcy5kb21FbGVtZW50Lm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYS5wb2ludGVyTG9ja0VsZW1lbnQpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIGJ1dHRvbjogZXZlbnQuYnV0dG9uXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBwb2ludGVyID0gZXZlbnQuY2hhbmdlZFRvdWNoZXMgPyBldmVudC5jaGFuZ2VkVG91Y2hlc1swXSA6IGV2ZW50O1xuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5kb21FbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHg6IChwb2ludGVyLmNsaWVudFggLSByZWN0LmxlZnQpIC8gcmVjdC53aWR0aCAqIDIgLSAxLFxuICAgICAgICAgIHk6IC0ocG9pbnRlci5jbGllbnRZIC0gcmVjdC50b3ApIC8gcmVjdC5oZWlnaHQgKiAyICsgMSxcbiAgICAgICAgICBidXR0b246IGV2ZW50LmJ1dHRvblxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJvblBvaW50ZXJIb3ZlclwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmICghdGhpcy5lbmFibGVkKVxuICAgICAgICByZXR1cm47XG4gICAgICBzd2l0Y2ggKGV2ZW50LnBvaW50ZXJUeXBlKSB7XG4gICAgICAgIGNhc2UgXCJtb3VzZVwiOlxuICAgICAgICBjYXNlIFwicGVuXCI6XG4gICAgICAgICAgdGhpcy5wb2ludGVySG92ZXIodGhpcy5nZXRQb2ludGVyKGV2ZW50KSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm9uUG9pbnRlckRvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZW5hYmxlZCB8fCAhdGhpcy5kb21FbGVtZW50KVxuICAgICAgICByZXR1cm47XG4gICAgICB0aGlzLmRvbUVsZW1lbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcIm5vbmVcIjtcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5vd25lckRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLm9uUG9pbnRlck1vdmUpO1xuICAgICAgdGhpcy5wb2ludGVySG92ZXIodGhpcy5nZXRQb2ludGVyKGV2ZW50KSk7XG4gICAgICB0aGlzLnBvaW50ZXJEb3duKHRoaXMuZ2V0UG9pbnRlcihldmVudCkpO1xuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJvblBvaW50ZXJNb3ZlXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpXG4gICAgICAgIHJldHVybjtcbiAgICAgIHRoaXMucG9pbnRlck1vdmUodGhpcy5nZXRQb2ludGVyKGV2ZW50KSk7XG4gICAgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm9uUG9pbnRlclVwXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmVuYWJsZWQgfHwgIXRoaXMuZG9tRWxlbWVudClcbiAgICAgICAgcmV0dXJuO1xuICAgICAgdGhpcy5kb21FbGVtZW50LnN0eWxlLnRvdWNoQWN0aW9uID0gXCJcIjtcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5vd25lckRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLm9uUG9pbnRlck1vdmUpO1xuICAgICAgdGhpcy5wb2ludGVyVXAodGhpcy5nZXRQb2ludGVyKGV2ZW50KSk7XG4gICAgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImdldE1vZGVcIiwgKCkgPT4gdGhpcy5tb2RlKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic2V0TW9kZVwiLCAobW9kZSkgPT4ge1xuICAgICAgdGhpcy5tb2RlID0gbW9kZTtcbiAgICB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic2V0VHJhbnNsYXRpb25TbmFwXCIsICh0cmFuc2xhdGlvblNuYXApID0+IHtcbiAgICAgIHRoaXMudHJhbnNsYXRpb25TbmFwID0gdHJhbnNsYXRpb25TbmFwO1xuICAgIH0pO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzZXRSb3RhdGlvblNuYXBcIiwgKHJvdGF0aW9uU25hcCkgPT4ge1xuICAgICAgdGhpcy5yb3RhdGlvblNuYXAgPSByb3RhdGlvblNuYXA7XG4gICAgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInNldFNjYWxlU25hcFwiLCAoc2NhbGVTbmFwKSA9PiB7XG4gICAgICB0aGlzLnNjYWxlU25hcCA9IHNjYWxlU25hcDtcbiAgICB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic2V0U2l6ZVwiLCAoc2l6ZSkgPT4ge1xuICAgICAgdGhpcy5zaXplID0gc2l6ZTtcbiAgICB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic2V0U3BhY2VcIiwgKHNwYWNlKSA9PiB7XG4gICAgICB0aGlzLnNwYWNlID0gc3BhY2U7XG4gICAgfSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInVwZGF0ZVwiLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiVEhSRUUuVHJhbnNmb3JtQ29udHJvbHM6IHVwZGF0ZSBmdW5jdGlvbiBoYXMgbm8gbW9yZSBmdW5jdGlvbmFsaXR5IGFuZCB0aGVyZWZvcmUgaGFzIGJlZW4gZGVwcmVjYXRlZC5cIlxuICAgICAgKTtcbiAgICB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiY29ubmVjdFwiLCAoZG9tRWxlbWVudCkgPT4ge1xuICAgICAgaWYgKGRvbUVsZW1lbnQgPT09IGRvY3VtZW50KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgJ1RIUkVFLk9yYml0Q29udHJvbHM6IFwiZG9jdW1lbnRcIiBzaG91bGQgbm90IGJlIHVzZWQgYXMgdGhlIHRhcmdldCBcImRvbUVsZW1lbnRcIi4gUGxlYXNlIHVzZSBcInJlbmRlcmVyLmRvbUVsZW1lbnRcIiBpbnN0ZWFkLidcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZG9tRWxlbWVudCA9IGRvbUVsZW1lbnQ7XG4gICAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIHRoaXMub25Qb2ludGVyRG93bik7XG4gICAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIHRoaXMub25Qb2ludGVySG92ZXIpO1xuICAgICAgdGhpcy5kb21FbGVtZW50Lm93bmVyRG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCB0aGlzLm9uUG9pbnRlclVwKTtcbiAgICB9KTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZGlzcG9zZVwiLCAoKSA9PiB7XG4gICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjtcbiAgICAgIChfYSA9IHRoaXMuZG9tRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCB0aGlzLm9uUG9pbnRlckRvd24pO1xuICAgICAgKF9iID0gdGhpcy5kb21FbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2IucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIHRoaXMub25Qb2ludGVySG92ZXIpO1xuICAgICAgKF9kID0gKF9jID0gdGhpcy5kb21FbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2Mub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9kLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLm9uUG9pbnRlck1vdmUpO1xuICAgICAgKF9mID0gKF9lID0gdGhpcy5kb21FbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2Uub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9mLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgdGhpcy5vblBvaW50ZXJVcCk7XG4gICAgICB0aGlzLnRyYXZlcnNlKChjaGlsZCkgPT4ge1xuICAgICAgICBjb25zdCBtZXNoID0gY2hpbGQ7XG4gICAgICAgIGlmIChtZXNoLmdlb21ldHJ5KSB7XG4gICAgICAgICAgbWVzaC5nZW9tZXRyeS5kaXNwb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lc2gubWF0ZXJpYWwpIHtcbiAgICAgICAgICBtZXNoLm1hdGVyaWFsLmRpc3Bvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5kb21FbGVtZW50ID0gZG9tRWxlbWVudDtcbiAgICB0aGlzLmNhbWVyYSA9IGNhbWVyYTtcbiAgICB0aGlzLmdpem1vID0gbmV3IFRyYW5zZm9ybUNvbnRyb2xzR2l6bW8oKTtcbiAgICB0aGlzLmFkZCh0aGlzLmdpem1vKTtcbiAgICB0aGlzLnBsYW5lID0gbmV3IFRyYW5zZm9ybUNvbnRyb2xzUGxhbmUoKTtcbiAgICB0aGlzLmFkZCh0aGlzLnBsYW5lKTtcbiAgICBjb25zdCBkZWZpbmVQcm9wZXJ0eSA9IChwcm9wTmFtZSwgZGVmYXVsdFZhbHVlKSA9PiB7XG4gICAgICBsZXQgcHJvcFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIHByb3BOYW1lLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHByb3BWYWx1ZSAhPT0gdm9pZCAwID8gcHJvcFZhbHVlIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKHByb3BWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHByb3BWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5wbGFuZVtwcm9wTmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZ2l6bW9bcHJvcE5hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoeyB0eXBlOiBwcm9wTmFtZSArIFwiLWNoYW5nZWRcIiwgdmFsdWUgfSk7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5jaGFuZ2VFdmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHRoaXNbcHJvcE5hbWVdID0gZGVmYXVsdFZhbHVlO1xuICAgICAgdGhpcy5wbGFuZVtwcm9wTmFtZV0gPSBkZWZhdWx0VmFsdWU7XG4gICAgICB0aGlzLmdpem1vW3Byb3BOYW1lXSA9IGRlZmF1bHRWYWx1ZTtcbiAgICB9O1xuICAgIGRlZmluZVByb3BlcnR5KFwiY2FtZXJhXCIsIHRoaXMuY2FtZXJhKTtcbiAgICBkZWZpbmVQcm9wZXJ0eShcIm9iamVjdFwiLCB0aGlzLm9iamVjdCk7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJlbmFibGVkXCIsIHRoaXMuZW5hYmxlZCk7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJheGlzXCIsIHRoaXMuYXhpcyk7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJtb2RlXCIsIHRoaXMubW9kZSk7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJ0cmFuc2xhdGlvblNuYXBcIiwgdGhpcy50cmFuc2xhdGlvblNuYXApO1xuICAgIGRlZmluZVByb3BlcnR5KFwicm90YXRpb25TbmFwXCIsIHRoaXMucm90YXRpb25TbmFwKTtcbiAgICBkZWZpbmVQcm9wZXJ0eShcInNjYWxlU25hcFwiLCB0aGlzLnNjYWxlU25hcCk7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJzcGFjZVwiLCB0aGlzLnNwYWNlKTtcbiAgICBkZWZpbmVQcm9wZXJ0eShcInNpemVcIiwgdGhpcy5zaXplKTtcbiAgICBkZWZpbmVQcm9wZXJ0eShcImRyYWdnaW5nXCIsIHRoaXMuZHJhZ2dpbmcpO1xuICAgIGRlZmluZVByb3BlcnR5KFwic2hvd1hcIiwgdGhpcy5zaG93WCk7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJzaG93WVwiLCB0aGlzLnNob3dZKTtcbiAgICBkZWZpbmVQcm9wZXJ0eShcInNob3daXCIsIHRoaXMuc2hvd1opO1xuICAgIGRlZmluZVByb3BlcnR5KFwid29ybGRQb3NpdGlvblwiLCB0aGlzLndvcmxkUG9zaXRpb24pO1xuICAgIGRlZmluZVByb3BlcnR5KFwid29ybGRQb3NpdGlvblN0YXJ0XCIsIHRoaXMud29ybGRQb3NpdGlvblN0YXJ0KTtcbiAgICBkZWZpbmVQcm9wZXJ0eShcIndvcmxkUXVhdGVybmlvblwiLCB0aGlzLndvcmxkUXVhdGVybmlvbik7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJ3b3JsZFF1YXRlcm5pb25TdGFydFwiLCB0aGlzLndvcmxkUXVhdGVybmlvblN0YXJ0KTtcbiAgICBkZWZpbmVQcm9wZXJ0eShcImNhbWVyYVBvc2l0aW9uXCIsIHRoaXMuY2FtZXJhUG9zaXRpb24pO1xuICAgIGRlZmluZVByb3BlcnR5KFwiY2FtZXJhUXVhdGVybmlvblwiLCB0aGlzLmNhbWVyYVF1YXRlcm5pb24pO1xuICAgIGRlZmluZVByb3BlcnR5KFwicG9pbnRTdGFydFwiLCB0aGlzLnBvaW50U3RhcnQpO1xuICAgIGRlZmluZVByb3BlcnR5KFwicG9pbnRFbmRcIiwgdGhpcy5wb2ludEVuZCk7XG4gICAgZGVmaW5lUHJvcGVydHkoXCJyb3RhdGlvbkF4aXNcIiwgdGhpcy5yb3RhdGlvbkF4aXMpO1xuICAgIGRlZmluZVByb3BlcnR5KFwicm90YXRpb25BbmdsZVwiLCB0aGlzLnJvdGF0aW9uQW5nbGUpO1xuICAgIGRlZmluZVByb3BlcnR5KFwiZXllXCIsIHRoaXMuZXllKTtcbiAgICBpZiAoZG9tRWxlbWVudCAhPT0gdm9pZCAwKVxuICAgICAgdGhpcy5jb25uZWN0KGRvbUVsZW1lbnQpO1xuICB9XG59XG5jbGFzcyBUcmFuc2Zvcm1Db250cm9sc0dpem1vIGV4dGVuZHMgT2JqZWN0M0Qge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJpc1RyYW5zZm9ybUNvbnRyb2xzR2l6bW9cIiwgdHJ1ZSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInR5cGVcIiwgXCJUcmFuc2Zvcm1Db250cm9sc0dpem1vXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0ZW1wVmVjdG9yXCIsIG5ldyBWZWN0b3IzKDAsIDAsIDApKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwidGVtcEV1bGVyXCIsIG5ldyBFdWxlcigpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiYWxpZ25WZWN0b3JcIiwgbmV3IFZlY3RvcjMoMCwgMSwgMCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ6ZXJvVmVjdG9yXCIsIG5ldyBWZWN0b3IzKDAsIDAsIDApKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwibG9va0F0TWF0cml4XCIsIG5ldyBNYXRyaXg0KCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0ZW1wUXVhdGVybmlvblwiLCBuZXcgUXVhdGVybmlvbigpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwidGVtcFF1YXRlcm5pb24yXCIsIG5ldyBRdWF0ZXJuaW9uKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJpZGVudGl0eVF1YXRlcm5pb25cIiwgbmV3IFF1YXRlcm5pb24oKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInVuaXRYXCIsIG5ldyBWZWN0b3IzKDEsIDAsIDApKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwidW5pdFlcIiwgbmV3IFZlY3RvcjMoMCwgMSwgMCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ1bml0WlwiLCBuZXcgVmVjdG9yMygwLCAwLCAxKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImdpem1vXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJwaWNrZXJcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImhlbHBlclwiKTtcbiAgICAvLyB0aGVzZSBhcmUgc2V0IGZyb20gcGFyZW50IGNsYXNzIFRyYW5zZm9ybUNvbnRyb2xzXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInJvdGF0aW9uQXhpc1wiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiY2FtZXJhUG9zaXRpb25cIiwgbmV3IFZlY3RvcjMoKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIndvcmxkUG9zaXRpb25TdGFydFwiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwid29ybGRRdWF0ZXJuaW9uU3RhcnRcIiwgbmV3IFF1YXRlcm5pb24oKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIndvcmxkUG9zaXRpb25cIiwgbmV3IFZlY3RvcjMoKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIndvcmxkUXVhdGVybmlvblwiLCBuZXcgUXVhdGVybmlvbigpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZXllXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJjYW1lcmFcIiwgbnVsbCk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImVuYWJsZWRcIiwgdHJ1ZSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImF4aXNcIiwgbnVsbCk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcIm1vZGVcIiwgXCJ0cmFuc2xhdGVcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInNwYWNlXCIsIFwid29ybGRcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInNpemVcIiwgMSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImRyYWdnaW5nXCIsIGZhbHNlKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic2hvd1hcIiwgdHJ1ZSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInNob3dZXCIsIHRydWUpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJzaG93WlwiLCB0cnVlKTtcbiAgICAvLyB1cGRhdGVNYXRyaXhXb3JsZCB3aWxsIHVwZGF0ZSB0cmFuc2Zvcm1hdGlvbnMgYW5kIGFwcGVhcmFuY2Ugb2YgaW5kaXZpZHVhbCBoYW5kbGVzXG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInVwZGF0ZU1hdHJpeFdvcmxkXCIsICgpID0+IHtcbiAgICAgIGxldCBzcGFjZSA9IHRoaXMuc3BhY2U7XG4gICAgICBpZiAodGhpcy5tb2RlID09PSBcInNjYWxlXCIpIHtcbiAgICAgICAgc3BhY2UgPSBcImxvY2FsXCI7XG4gICAgICB9XG4gICAgICBjb25zdCBxdWF0ZXJuaW9uID0gc3BhY2UgPT09IFwibG9jYWxcIiA/IHRoaXMud29ybGRRdWF0ZXJuaW9uIDogdGhpcy5pZGVudGl0eVF1YXRlcm5pb247XG4gICAgICB0aGlzLmdpem1vW1widHJhbnNsYXRlXCJdLnZpc2libGUgPSB0aGlzLm1vZGUgPT09IFwidHJhbnNsYXRlXCI7XG4gICAgICB0aGlzLmdpem1vW1wicm90YXRlXCJdLnZpc2libGUgPSB0aGlzLm1vZGUgPT09IFwicm90YXRlXCI7XG4gICAgICB0aGlzLmdpem1vW1wic2NhbGVcIl0udmlzaWJsZSA9IHRoaXMubW9kZSA9PT0gXCJzY2FsZVwiO1xuICAgICAgdGhpcy5oZWxwZXJbXCJ0cmFuc2xhdGVcIl0udmlzaWJsZSA9IHRoaXMubW9kZSA9PT0gXCJ0cmFuc2xhdGVcIjtcbiAgICAgIHRoaXMuaGVscGVyW1wicm90YXRlXCJdLnZpc2libGUgPSB0aGlzLm1vZGUgPT09IFwicm90YXRlXCI7XG4gICAgICB0aGlzLmhlbHBlcltcInNjYWxlXCJdLnZpc2libGUgPSB0aGlzLm1vZGUgPT09IFwic2NhbGVcIjtcbiAgICAgIGxldCBoYW5kbGVzID0gW107XG4gICAgICBoYW5kbGVzID0gaGFuZGxlcy5jb25jYXQodGhpcy5waWNrZXJbdGhpcy5tb2RlXS5jaGlsZHJlbik7XG4gICAgICBoYW5kbGVzID0gaGFuZGxlcy5jb25jYXQodGhpcy5naXptb1t0aGlzLm1vZGVdLmNoaWxkcmVuKTtcbiAgICAgIGhhbmRsZXMgPSBoYW5kbGVzLmNvbmNhdCh0aGlzLmhlbHBlclt0aGlzLm1vZGVdLmNoaWxkcmVuKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaGFuZGxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBoYW5kbGUgPSBoYW5kbGVzW2ldO1xuICAgICAgICBoYW5kbGUudmlzaWJsZSA9IHRydWU7XG4gICAgICAgIGhhbmRsZS5yb3RhdGlvbi5zZXQoMCwgMCwgMCk7XG4gICAgICAgIGhhbmRsZS5wb3NpdGlvbi5jb3B5KHRoaXMud29ybGRQb3NpdGlvbik7XG4gICAgICAgIGxldCBmYWN0b3I7XG4gICAgICAgIGlmICh0aGlzLmNhbWVyYS5pc09ydGhvZ3JhcGhpY0NhbWVyYSkge1xuICAgICAgICAgIGZhY3RvciA9ICh0aGlzLmNhbWVyYS50b3AgLSB0aGlzLmNhbWVyYS5ib3R0b20pIC8gdGhpcy5jYW1lcmEuem9vbTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmYWN0b3IgPSB0aGlzLndvcmxkUG9zaXRpb24uZGlzdGFuY2VUbyh0aGlzLmNhbWVyYVBvc2l0aW9uKSAqIE1hdGgubWluKDEuOSAqIE1hdGgudGFuKE1hdGguUEkgKiB0aGlzLmNhbWVyYS5mb3YgLyAzNjApIC8gdGhpcy5jYW1lcmEuem9vbSwgNyk7XG4gICAgICAgIH1cbiAgICAgICAgaGFuZGxlLnNjYWxlLnNldCgxLCAxLCAxKS5tdWx0aXBseVNjYWxhcihmYWN0b3IgKiB0aGlzLnNpemUgLyA3KTtcbiAgICAgICAgaWYgKGhhbmRsZS50YWcgPT09IFwiaGVscGVyXCIpIHtcbiAgICAgICAgICBoYW5kbGUudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgIGlmIChoYW5kbGUubmFtZSA9PT0gXCJBWElTXCIpIHtcbiAgICAgICAgICAgIGhhbmRsZS5wb3NpdGlvbi5jb3B5KHRoaXMud29ybGRQb3NpdGlvblN0YXJ0KTtcbiAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gISF0aGlzLmF4aXM7XG4gICAgICAgICAgICBpZiAodGhpcy5heGlzID09PSBcIlhcIikge1xuICAgICAgICAgICAgICB0aGlzLnRlbXBRdWF0ZXJuaW9uLnNldEZyb21FdWxlcih0aGlzLnRlbXBFdWxlci5zZXQoMCwgMCwgMCkpO1xuICAgICAgICAgICAgICBoYW5kbGUucXVhdGVybmlvbi5jb3B5KHF1YXRlcm5pb24pLm11bHRpcGx5KHRoaXMudGVtcFF1YXRlcm5pb24pO1xuICAgICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5hbGlnblZlY3Rvci5jb3B5KHRoaXMudW5pdFgpLmFwcGx5UXVhdGVybmlvbihxdWF0ZXJuaW9uKS5kb3QodGhpcy5leWUpKSA+IDAuOSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09IFwiWVwiKSB7XG4gICAgICAgICAgICAgIHRoaXMudGVtcFF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKHRoaXMudGVtcEV1bGVyLnNldCgwLCAwLCBNYXRoLlBJIC8gMikpO1xuICAgICAgICAgICAgICBoYW5kbGUucXVhdGVybmlvbi5jb3B5KHF1YXRlcm5pb24pLm11bHRpcGx5KHRoaXMudGVtcFF1YXRlcm5pb24pO1xuICAgICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5hbGlnblZlY3Rvci5jb3B5KHRoaXMudW5pdFkpLmFwcGx5UXVhdGVybmlvbihxdWF0ZXJuaW9uKS5kb3QodGhpcy5leWUpKSA+IDAuOSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09IFwiWlwiKSB7XG4gICAgICAgICAgICAgIHRoaXMudGVtcFF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKHRoaXMudGVtcEV1bGVyLnNldCgwLCBNYXRoLlBJIC8gMiwgMCkpO1xuICAgICAgICAgICAgICBoYW5kbGUucXVhdGVybmlvbi5jb3B5KHF1YXRlcm5pb24pLm11bHRpcGx5KHRoaXMudGVtcFF1YXRlcm5pb24pO1xuICAgICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5hbGlnblZlY3Rvci5jb3B5KHRoaXMudW5pdFopLmFwcGx5UXVhdGVybmlvbihxdWF0ZXJuaW9uKS5kb3QodGhpcy5leWUpKSA+IDAuOSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09IFwiWFlaRVwiKSB7XG4gICAgICAgICAgICAgIHRoaXMudGVtcFF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKHRoaXMudGVtcEV1bGVyLnNldCgwLCBNYXRoLlBJIC8gMiwgMCkpO1xuICAgICAgICAgICAgICB0aGlzLmFsaWduVmVjdG9yLmNvcHkodGhpcy5yb3RhdGlvbkF4aXMpO1xuICAgICAgICAgICAgICBoYW5kbGUucXVhdGVybmlvbi5zZXRGcm9tUm90YXRpb25NYXRyaXgoXG4gICAgICAgICAgICAgICAgdGhpcy5sb29rQXRNYXRyaXgubG9va0F0KHRoaXMuemVyb1ZlY3RvciwgdGhpcy5hbGlnblZlY3RvciwgdGhpcy51bml0WSlcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgaGFuZGxlLnF1YXRlcm5pb24ubXVsdGlwbHkodGhpcy50ZW1wUXVhdGVybmlvbik7XG4gICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gdGhpcy5kcmFnZ2luZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmF4aXMgPT09IFwiRVwiKSB7XG4gICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGUubmFtZSA9PT0gXCJTVEFSVFwiKSB7XG4gICAgICAgICAgICBoYW5kbGUucG9zaXRpb24uY29weSh0aGlzLndvcmxkUG9zaXRpb25TdGFydCk7XG4gICAgICAgICAgICBoYW5kbGUudmlzaWJsZSA9IHRoaXMuZHJhZ2dpbmc7XG4gICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGUubmFtZSA9PT0gXCJFTkRcIikge1xuICAgICAgICAgICAgaGFuZGxlLnBvc2l0aW9uLmNvcHkodGhpcy53b3JsZFBvc2l0aW9uKTtcbiAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gdGhpcy5kcmFnZ2luZztcbiAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZS5uYW1lID09PSBcIkRFTFRBXCIpIHtcbiAgICAgICAgICAgIGhhbmRsZS5wb3NpdGlvbi5jb3B5KHRoaXMud29ybGRQb3NpdGlvblN0YXJ0KTtcbiAgICAgICAgICAgIGhhbmRsZS5xdWF0ZXJuaW9uLmNvcHkodGhpcy53b3JsZFF1YXRlcm5pb25TdGFydCk7XG4gICAgICAgICAgICB0aGlzLnRlbXBWZWN0b3Iuc2V0KDFlLTEwLCAxZS0xMCwgMWUtMTApLmFkZCh0aGlzLndvcmxkUG9zaXRpb25TdGFydCkuc3ViKHRoaXMud29ybGRQb3NpdGlvbikubXVsdGlwbHlTY2FsYXIoLTEpO1xuICAgICAgICAgICAgdGhpcy50ZW1wVmVjdG9yLmFwcGx5UXVhdGVybmlvbih0aGlzLndvcmxkUXVhdGVybmlvblN0YXJ0LmNsb25lKCkuaW52ZXJ0KCkpO1xuICAgICAgICAgICAgaGFuZGxlLnNjYWxlLmNvcHkodGhpcy50ZW1wVmVjdG9yKTtcbiAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gdGhpcy5kcmFnZ2luZztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGFuZGxlLnF1YXRlcm5pb24uY29weShxdWF0ZXJuaW9uKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRyYWdnaW5nKSB7XG4gICAgICAgICAgICAgIGhhbmRsZS5wb3NpdGlvbi5jb3B5KHRoaXMud29ybGRQb3NpdGlvblN0YXJ0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGhhbmRsZS5wb3NpdGlvbi5jb3B5KHRoaXMud29ybGRQb3NpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5heGlzKSB7XG4gICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gdGhpcy5heGlzLnNlYXJjaChoYW5kbGUubmFtZSkgIT09IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGUucXVhdGVybmlvbi5jb3B5KHF1YXRlcm5pb24pO1xuICAgICAgICBpZiAodGhpcy5tb2RlID09PSBcInRyYW5zbGF0ZVwiIHx8IHRoaXMubW9kZSA9PT0gXCJzY2FsZVwiKSB7XG4gICAgICAgICAgY29uc3QgQVhJU19ISURFX1RSRVNIT0xEID0gMC45OTtcbiAgICAgICAgICBjb25zdCBQTEFORV9ISURFX1RSRVNIT0xEID0gMC4yO1xuICAgICAgICAgIGNvbnN0IEFYSVNfRkxJUF9UUkVTSE9MRCA9IDA7XG4gICAgICAgICAgaWYgKGhhbmRsZS5uYW1lID09PSBcIlhcIiB8fCBoYW5kbGUubmFtZSA9PT0gXCJYWVpYXCIpIHtcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLmFsaWduVmVjdG9yLmNvcHkodGhpcy51bml0WCkuYXBwbHlRdWF0ZXJuaW9uKHF1YXRlcm5pb24pLmRvdCh0aGlzLmV5ZSkpID4gQVhJU19ISURFX1RSRVNIT0xEKSB7XG4gICAgICAgICAgICAgIGhhbmRsZS5zY2FsZS5zZXQoMWUtMTAsIDFlLTEwLCAxZS0xMCk7XG4gICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYW5kbGUubmFtZSA9PT0gXCJZXCIgfHwgaGFuZGxlLm5hbWUgPT09IFwiWFlaWVwiKSB7XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5hbGlnblZlY3Rvci5jb3B5KHRoaXMudW5pdFkpLmFwcGx5UXVhdGVybmlvbihxdWF0ZXJuaW9uKS5kb3QodGhpcy5leWUpKSA+IEFYSVNfSElERV9UUkVTSE9MRCkge1xuICAgICAgICAgICAgICBoYW5kbGUuc2NhbGUuc2V0KDFlLTEwLCAxZS0xMCwgMWUtMTApO1xuICAgICAgICAgICAgICBoYW5kbGUudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaGFuZGxlLm5hbWUgPT09IFwiWlwiIHx8IGhhbmRsZS5uYW1lID09PSBcIlhZWlpcIikge1xuICAgICAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMuYWxpZ25WZWN0b3IuY29weSh0aGlzLnVuaXRaKS5hcHBseVF1YXRlcm5pb24ocXVhdGVybmlvbikuZG90KHRoaXMuZXllKSkgPiBBWElTX0hJREVfVFJFU0hPTEQpIHtcbiAgICAgICAgICAgICAgaGFuZGxlLnNjYWxlLnNldCgxZS0xMCwgMWUtMTAsIDFlLTEwKTtcbiAgICAgICAgICAgICAgaGFuZGxlLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGhhbmRsZS5uYW1lID09PSBcIlhZXCIpIHtcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLmFsaWduVmVjdG9yLmNvcHkodGhpcy51bml0WikuYXBwbHlRdWF0ZXJuaW9uKHF1YXRlcm5pb24pLmRvdCh0aGlzLmV5ZSkpIDwgUExBTkVfSElERV9UUkVTSE9MRCkge1xuICAgICAgICAgICAgICBoYW5kbGUuc2NhbGUuc2V0KDFlLTEwLCAxZS0xMCwgMWUtMTApO1xuICAgICAgICAgICAgICBoYW5kbGUudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaGFuZGxlLm5hbWUgPT09IFwiWVpcIikge1xuICAgICAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMuYWxpZ25WZWN0b3IuY29weSh0aGlzLnVuaXRYKS5hcHBseVF1YXRlcm5pb24ocXVhdGVybmlvbikuZG90KHRoaXMuZXllKSkgPCBQTEFORV9ISURFX1RSRVNIT0xEKSB7XG4gICAgICAgICAgICAgIGhhbmRsZS5zY2FsZS5zZXQoMWUtMTAsIDFlLTEwLCAxZS0xMCk7XG4gICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYW5kbGUubmFtZSA9PT0gXCJYWlwiKSB7XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5hbGlnblZlY3Rvci5jb3B5KHRoaXMudW5pdFkpLmFwcGx5UXVhdGVybmlvbihxdWF0ZXJuaW9uKS5kb3QodGhpcy5leWUpKSA8IFBMQU5FX0hJREVfVFJFU0hPTEQpIHtcbiAgICAgICAgICAgICAgaGFuZGxlLnNjYWxlLnNldCgxZS0xMCwgMWUtMTAsIDFlLTEwKTtcbiAgICAgICAgICAgICAgaGFuZGxlLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGhhbmRsZS5uYW1lLnNlYXJjaChcIlhcIikgIT09IC0xKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbGlnblZlY3Rvci5jb3B5KHRoaXMudW5pdFgpLmFwcGx5UXVhdGVybmlvbihxdWF0ZXJuaW9uKS5kb3QodGhpcy5leWUpIDwgQVhJU19GTElQX1RSRVNIT0xEKSB7XG4gICAgICAgICAgICAgIGlmIChoYW5kbGUudGFnID09PSBcImZ3ZFwiKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYW5kbGUuc2NhbGUueCAqPSAtMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGUudGFnID09PSBcImJ3ZFwiKSB7XG4gICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYW5kbGUubmFtZS5zZWFyY2goXCJZXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYWxpZ25WZWN0b3IuY29weSh0aGlzLnVuaXRZKS5hcHBseVF1YXRlcm5pb24ocXVhdGVybmlvbikuZG90KHRoaXMuZXllKSA8IEFYSVNfRkxJUF9UUkVTSE9MRCkge1xuICAgICAgICAgICAgICBpZiAoaGFuZGxlLnRhZyA9PT0gXCJmd2RcIikge1xuICAgICAgICAgICAgICAgIGhhbmRsZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlLnNjYWxlLnkgKj0gLTE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlLnRhZyA9PT0gXCJid2RcIikge1xuICAgICAgICAgICAgICBoYW5kbGUudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaGFuZGxlLm5hbWUuc2VhcmNoKFwiWlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFsaWduVmVjdG9yLmNvcHkodGhpcy51bml0WikuYXBwbHlRdWF0ZXJuaW9uKHF1YXRlcm5pb24pLmRvdCh0aGlzLmV5ZSkgPCBBWElTX0ZMSVBfVFJFU0hPTEQpIHtcbiAgICAgICAgICAgICAgaWYgKGhhbmRsZS50YWcgPT09IFwiZndkXCIpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGUudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhhbmRsZS5zY2FsZS56ICo9IC0xO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZS50YWcgPT09IFwiYndkXCIpIHtcbiAgICAgICAgICAgICAgaGFuZGxlLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09PSBcInJvdGF0ZVwiKSB7XG4gICAgICAgICAgdGhpcy50ZW1wUXVhdGVybmlvbjIuY29weShxdWF0ZXJuaW9uKTtcbiAgICAgICAgICB0aGlzLmFsaWduVmVjdG9yLmNvcHkodGhpcy5leWUpLmFwcGx5UXVhdGVybmlvbih0aGlzLnRlbXBRdWF0ZXJuaW9uLmNvcHkocXVhdGVybmlvbikuaW52ZXJ0KCkpO1xuICAgICAgICAgIGlmIChoYW5kbGUubmFtZS5zZWFyY2goXCJFXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgaGFuZGxlLnF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4KHRoaXMubG9va0F0TWF0cml4Lmxvb2tBdCh0aGlzLmV5ZSwgdGhpcy56ZXJvVmVjdG9yLCB0aGlzLnVuaXRZKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYW5kbGUubmFtZSA9PT0gXCJYXCIpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcFF1YXRlcm5pb24uc2V0RnJvbUF4aXNBbmdsZSh0aGlzLnVuaXRYLCBNYXRoLmF0YW4yKC10aGlzLmFsaWduVmVjdG9yLnksIHRoaXMuYWxpZ25WZWN0b3IueikpO1xuICAgICAgICAgICAgdGhpcy50ZW1wUXVhdGVybmlvbi5tdWx0aXBseVF1YXRlcm5pb25zKHRoaXMudGVtcFF1YXRlcm5pb24yLCB0aGlzLnRlbXBRdWF0ZXJuaW9uKTtcbiAgICAgICAgICAgIGhhbmRsZS5xdWF0ZXJuaW9uLmNvcHkodGhpcy50ZW1wUXVhdGVybmlvbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYW5kbGUubmFtZSA9PT0gXCJZXCIpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcFF1YXRlcm5pb24uc2V0RnJvbUF4aXNBbmdsZSh0aGlzLnVuaXRZLCBNYXRoLmF0YW4yKHRoaXMuYWxpZ25WZWN0b3IueCwgdGhpcy5hbGlnblZlY3Rvci56KSk7XG4gICAgICAgICAgICB0aGlzLnRlbXBRdWF0ZXJuaW9uLm11bHRpcGx5UXVhdGVybmlvbnModGhpcy50ZW1wUXVhdGVybmlvbjIsIHRoaXMudGVtcFF1YXRlcm5pb24pO1xuICAgICAgICAgICAgaGFuZGxlLnF1YXRlcm5pb24uY29weSh0aGlzLnRlbXBRdWF0ZXJuaW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGhhbmRsZS5uYW1lID09PSBcIlpcIikge1xuICAgICAgICAgICAgdGhpcy50ZW1wUXVhdGVybmlvbi5zZXRGcm9tQXhpc0FuZ2xlKHRoaXMudW5pdFosIE1hdGguYXRhbjIodGhpcy5hbGlnblZlY3Rvci55LCB0aGlzLmFsaWduVmVjdG9yLngpKTtcbiAgICAgICAgICAgIHRoaXMudGVtcFF1YXRlcm5pb24ubXVsdGlwbHlRdWF0ZXJuaW9ucyh0aGlzLnRlbXBRdWF0ZXJuaW9uMiwgdGhpcy50ZW1wUXVhdGVybmlvbik7XG4gICAgICAgICAgICBoYW5kbGUucXVhdGVybmlvbi5jb3B5KHRoaXMudGVtcFF1YXRlcm5pb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBoYW5kbGUudmlzaWJsZSA9IGhhbmRsZS52aXNpYmxlICYmIChoYW5kbGUubmFtZS5pbmRleE9mKFwiWFwiKSA9PT0gLTEgfHwgdGhpcy5zaG93WCk7XG4gICAgICAgIGhhbmRsZS52aXNpYmxlID0gaGFuZGxlLnZpc2libGUgJiYgKGhhbmRsZS5uYW1lLmluZGV4T2YoXCJZXCIpID09PSAtMSB8fCB0aGlzLnNob3dZKTtcbiAgICAgICAgaGFuZGxlLnZpc2libGUgPSBoYW5kbGUudmlzaWJsZSAmJiAoaGFuZGxlLm5hbWUuaW5kZXhPZihcIlpcIikgPT09IC0xIHx8IHRoaXMuc2hvd1opO1xuICAgICAgICBoYW5kbGUudmlzaWJsZSA9IGhhbmRsZS52aXNpYmxlICYmIChoYW5kbGUubmFtZS5pbmRleE9mKFwiRVwiKSA9PT0gLTEgfHwgdGhpcy5zaG93WCAmJiB0aGlzLnNob3dZICYmIHRoaXMuc2hvd1opO1xuICAgICAgICBoYW5kbGUubWF0ZXJpYWwudGVtcE9wYWNpdHkgPSBoYW5kbGUubWF0ZXJpYWwudGVtcE9wYWNpdHkgfHwgaGFuZGxlLm1hdGVyaWFsLm9wYWNpdHk7XG4gICAgICAgIGhhbmRsZS5tYXRlcmlhbC50ZW1wQ29sb3IgPSBoYW5kbGUubWF0ZXJpYWwudGVtcENvbG9yIHx8IGhhbmRsZS5tYXRlcmlhbC5jb2xvci5jbG9uZSgpO1xuICAgICAgICBoYW5kbGUubWF0ZXJpYWwuY29sb3IuY29weShoYW5kbGUubWF0ZXJpYWwudGVtcENvbG9yKTtcbiAgICAgICAgaGFuZGxlLm1hdGVyaWFsLm9wYWNpdHkgPSBoYW5kbGUubWF0ZXJpYWwudGVtcE9wYWNpdHk7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgaGFuZGxlLm1hdGVyaWFsLm9wYWNpdHkgKj0gMC41O1xuICAgICAgICAgIGhhbmRsZS5tYXRlcmlhbC5jb2xvci5sZXJwKG5ldyBDb2xvcigxLCAxLCAxKSwgMC41KTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmF4aXMpIHtcbiAgICAgICAgICBpZiAoaGFuZGxlLm5hbWUgPT09IHRoaXMuYXhpcykge1xuICAgICAgICAgICAgaGFuZGxlLm1hdGVyaWFsLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgaGFuZGxlLm1hdGVyaWFsLmNvbG9yLmxlcnAobmV3IENvbG9yKDEsIDEsIDEpLCAwLjUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5heGlzLnNwbGl0KFwiXCIpLnNvbWUoZnVuY3Rpb24oYSkge1xuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZS5uYW1lID09PSBhO1xuICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICBoYW5kbGUubWF0ZXJpYWwub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICBoYW5kbGUubWF0ZXJpYWwuY29sb3IubGVycChuZXcgQ29sb3IoMSwgMSwgMSksIDAuNSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhhbmRsZS5tYXRlcmlhbC5vcGFjaXR5ICo9IDAuMjU7XG4gICAgICAgICAgICBoYW5kbGUubWF0ZXJpYWwuY29sb3IubGVycChuZXcgQ29sb3IoMSwgMSwgMSksIDAuNSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzdXBlci51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgIH0pO1xuICAgIGNvbnN0IGdpem1vTWF0ZXJpYWwgPSBuZXcgTWVzaEJhc2ljTWF0ZXJpYWwoe1xuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICBzaWRlOiBEb3VibGVTaWRlLFxuICAgICAgZm9nOiBmYWxzZSxcbiAgICAgIHRvbmVNYXBwZWQ6IGZhbHNlXG4gICAgfSk7XG4gICAgY29uc3QgZ2l6bW9MaW5lTWF0ZXJpYWwgPSBuZXcgTGluZUJhc2ljTWF0ZXJpYWwoe1xuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICBsaW5ld2lkdGg6IDEsXG4gICAgICBmb2c6IGZhbHNlLFxuICAgICAgdG9uZU1hcHBlZDogZmFsc2VcbiAgICB9KTtcbiAgICBjb25zdCBtYXRJbnZpc2libGUgPSBnaXptb01hdGVyaWFsLmNsb25lKCk7XG4gICAgbWF0SW52aXNpYmxlLm9wYWNpdHkgPSAwLjE1O1xuICAgIGNvbnN0IG1hdEhlbHBlciA9IGdpem1vTWF0ZXJpYWwuY2xvbmUoKTtcbiAgICBtYXRIZWxwZXIub3BhY2l0eSA9IDAuMzM7XG4gICAgY29uc3QgbWF0UmVkID0gZ2l6bW9NYXRlcmlhbC5jbG9uZSgpO1xuICAgIG1hdFJlZC5jb2xvci5zZXQoMTY3MTE2ODApO1xuICAgIGNvbnN0IG1hdEdyZWVuID0gZ2l6bW9NYXRlcmlhbC5jbG9uZSgpO1xuICAgIG1hdEdyZWVuLmNvbG9yLnNldCg2NTI4MCk7XG4gICAgY29uc3QgbWF0Qmx1ZSA9IGdpem1vTWF0ZXJpYWwuY2xvbmUoKTtcbiAgICBtYXRCbHVlLmNvbG9yLnNldCgyNTUpO1xuICAgIGNvbnN0IG1hdFdoaXRlVHJhbnNwYXJlbnQgPSBnaXptb01hdGVyaWFsLmNsb25lKCk7XG4gICAgbWF0V2hpdGVUcmFuc3BhcmVudC5vcGFjaXR5ID0gMC4yNTtcbiAgICBjb25zdCBtYXRZZWxsb3dUcmFuc3BhcmVudCA9IG1hdFdoaXRlVHJhbnNwYXJlbnQuY2xvbmUoKTtcbiAgICBtYXRZZWxsb3dUcmFuc3BhcmVudC5jb2xvci5zZXQoMTY3NzY5NjApO1xuICAgIGNvbnN0IG1hdEN5YW5UcmFuc3BhcmVudCA9IG1hdFdoaXRlVHJhbnNwYXJlbnQuY2xvbmUoKTtcbiAgICBtYXRDeWFuVHJhbnNwYXJlbnQuY29sb3Iuc2V0KDY1NTM1KTtcbiAgICBjb25zdCBtYXRNYWdlbnRhVHJhbnNwYXJlbnQgPSBtYXRXaGl0ZVRyYW5zcGFyZW50LmNsb25lKCk7XG4gICAgbWF0TWFnZW50YVRyYW5zcGFyZW50LmNvbG9yLnNldCgxNjcxMTkzNSk7XG4gICAgY29uc3QgbWF0WWVsbG93ID0gZ2l6bW9NYXRlcmlhbC5jbG9uZSgpO1xuICAgIG1hdFllbGxvdy5jb2xvci5zZXQoMTY3NzY5NjApO1xuICAgIGNvbnN0IG1hdExpbmVSZWQgPSBnaXptb0xpbmVNYXRlcmlhbC5jbG9uZSgpO1xuICAgIG1hdExpbmVSZWQuY29sb3Iuc2V0KDE2NzExNjgwKTtcbiAgICBjb25zdCBtYXRMaW5lR3JlZW4gPSBnaXptb0xpbmVNYXRlcmlhbC5jbG9uZSgpO1xuICAgIG1hdExpbmVHcmVlbi5jb2xvci5zZXQoNjUyODApO1xuICAgIGNvbnN0IG1hdExpbmVCbHVlID0gZ2l6bW9MaW5lTWF0ZXJpYWwuY2xvbmUoKTtcbiAgICBtYXRMaW5lQmx1ZS5jb2xvci5zZXQoMjU1KTtcbiAgICBjb25zdCBtYXRMaW5lQ3lhbiA9IGdpem1vTGluZU1hdGVyaWFsLmNsb25lKCk7XG4gICAgbWF0TGluZUN5YW4uY29sb3Iuc2V0KDY1NTM1KTtcbiAgICBjb25zdCBtYXRMaW5lTWFnZW50YSA9IGdpem1vTGluZU1hdGVyaWFsLmNsb25lKCk7XG4gICAgbWF0TGluZU1hZ2VudGEuY29sb3Iuc2V0KDE2NzExOTM1KTtcbiAgICBjb25zdCBtYXRMaW5lWWVsbG93ID0gZ2l6bW9MaW5lTWF0ZXJpYWwuY2xvbmUoKTtcbiAgICBtYXRMaW5lWWVsbG93LmNvbG9yLnNldCgxNjc3Njk2MCk7XG4gICAgY29uc3QgbWF0TGluZUdyYXkgPSBnaXptb0xpbmVNYXRlcmlhbC5jbG9uZSgpO1xuICAgIG1hdExpbmVHcmF5LmNvbG9yLnNldCg3ODk1MTYwKTtcbiAgICBjb25zdCBtYXRMaW5lWWVsbG93VHJhbnNwYXJlbnQgPSBtYXRMaW5lWWVsbG93LmNsb25lKCk7XG4gICAgbWF0TGluZVllbGxvd1RyYW5zcGFyZW50Lm9wYWNpdHkgPSAwLjI1O1xuICAgIGNvbnN0IGFycm93R2VvbWV0cnkgPSBuZXcgQ3lsaW5kZXJHZW9tZXRyeSgwLCAwLjA1LCAwLjIsIDEyLCAxLCBmYWxzZSk7XG4gICAgY29uc3Qgc2NhbGVIYW5kbGVHZW9tZXRyeSA9IG5ldyBCb3hHZW9tZXRyeSgwLjEyNSwgMC4xMjUsIDAuMTI1KTtcbiAgICBjb25zdCBsaW5lR2VvbWV0cnkgPSBuZXcgQnVmZmVyR2VvbWV0cnkoKTtcbiAgICBsaW5lR2VvbWV0cnkuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoWzAsIDAsIDAsIDEsIDAsIDBdLCAzKSk7XG4gICAgY29uc3QgQ2lyY2xlR2VvbWV0cnkgPSAocmFkaXVzLCBhcmMpID0+IHtcbiAgICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7XG4gICAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gNjQgKiBhcmM7ICsraSkge1xuICAgICAgICB2ZXJ0aWNlcy5wdXNoKDAsIE1hdGguY29zKGkgLyAzMiAqIE1hdGguUEkpICogcmFkaXVzLCBNYXRoLnNpbihpIC8gMzIgKiBNYXRoLlBJKSAqIHJhZGl1cyk7XG4gICAgICB9XG4gICAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoXCJwb3NpdGlvblwiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlcywgMykpO1xuICAgICAgcmV0dXJuIGdlb21ldHJ5O1xuICAgIH07XG4gICAgY29uc3QgVHJhbnNsYXRlSGVscGVyR2VvbWV0cnkgPSAoKSA9PiB7XG4gICAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBCdWZmZXJHZW9tZXRyeSgpO1xuICAgICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoWzAsIDAsIDAsIDEsIDEsIDFdLCAzKSk7XG4gICAgICByZXR1cm4gZ2VvbWV0cnk7XG4gICAgfTtcbiAgICBjb25zdCBnaXptb1RyYW5zbGF0ZSA9IHtcbiAgICAgIFg6IFtcbiAgICAgICAgW25ldyBNZXNoKGFycm93R2VvbWV0cnksIG1hdFJlZCksIFsxLCAwLCAwXSwgWzAsIDAsIC1NYXRoLlBJIC8gMl0sIG51bGwsIFwiZndkXCJdLFxuICAgICAgICBbbmV3IE1lc2goYXJyb3dHZW9tZXRyeSwgbWF0UmVkKSwgWzEsIDAsIDBdLCBbMCwgMCwgTWF0aC5QSSAvIDJdLCBudWxsLCBcImJ3ZFwiXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZVJlZCldXG4gICAgICBdLFxuICAgICAgWTogW1xuICAgICAgICBbbmV3IE1lc2goYXJyb3dHZW9tZXRyeSwgbWF0R3JlZW4pLCBbMCwgMSwgMF0sIG51bGwsIG51bGwsIFwiZndkXCJdLFxuICAgICAgICBbbmV3IE1lc2goYXJyb3dHZW9tZXRyeSwgbWF0R3JlZW4pLCBbMCwgMSwgMF0sIFtNYXRoLlBJLCAwLCAwXSwgbnVsbCwgXCJid2RcIl0sXG4gICAgICAgIFtuZXcgTGluZShsaW5lR2VvbWV0cnksIG1hdExpbmVHcmVlbiksIG51bGwsIFswLCAwLCBNYXRoLlBJIC8gMl1dXG4gICAgICBdLFxuICAgICAgWjogW1xuICAgICAgICBbbmV3IE1lc2goYXJyb3dHZW9tZXRyeSwgbWF0Qmx1ZSksIFswLCAwLCAxXSwgW01hdGguUEkgLyAyLCAwLCAwXSwgbnVsbCwgXCJmd2RcIl0sXG4gICAgICAgIFtuZXcgTWVzaChhcnJvd0dlb21ldHJ5LCBtYXRCbHVlKSwgWzAsIDAsIDFdLCBbLU1hdGguUEkgLyAyLCAwLCAwXSwgbnVsbCwgXCJid2RcIl0sXG4gICAgICAgIFtuZXcgTGluZShsaW5lR2VvbWV0cnksIG1hdExpbmVCbHVlKSwgbnVsbCwgWzAsIC1NYXRoLlBJIC8gMiwgMF1dXG4gICAgICBdLFxuICAgICAgWFlaOiBbW25ldyBNZXNoKG5ldyBPY3RhaGVkcm9uR2VvbWV0cnkoMC4xLCAwKSwgbWF0V2hpdGVUcmFuc3BhcmVudC5jbG9uZSgpKSwgWzAsIDAsIDBdLCBbMCwgMCwgMF1dXSxcbiAgICAgIFhZOiBbXG4gICAgICAgIFtuZXcgTWVzaChuZXcgUGxhbmVHZW9tZXRyeSgwLjI5NSwgMC4yOTUpLCBtYXRZZWxsb3dUcmFuc3BhcmVudC5jbG9uZSgpKSwgWzAuMTUsIDAuMTUsIDBdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZVllbGxvdyksIFswLjE4LCAwLjMsIDBdLCBudWxsLCBbMC4xMjUsIDEsIDFdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZVllbGxvdyksIFswLjMsIDAuMTgsIDBdLCBbMCwgMCwgTWF0aC5QSSAvIDJdLCBbMC4xMjUsIDEsIDFdXVxuICAgICAgXSxcbiAgICAgIFlaOiBbXG4gICAgICAgIFtuZXcgTWVzaChuZXcgUGxhbmVHZW9tZXRyeSgwLjI5NSwgMC4yOTUpLCBtYXRDeWFuVHJhbnNwYXJlbnQuY2xvbmUoKSksIFswLCAwLjE1LCAwLjE1XSwgWzAsIE1hdGguUEkgLyAyLCAwXV0sXG4gICAgICAgIFtuZXcgTGluZShsaW5lR2VvbWV0cnksIG1hdExpbmVDeWFuKSwgWzAsIDAuMTgsIDAuM10sIFswLCAwLCBNYXRoLlBJIC8gMl0sIFswLjEyNSwgMSwgMV1dLFxuICAgICAgICBbbmV3IExpbmUobGluZUdlb21ldHJ5LCBtYXRMaW5lQ3lhbiksIFswLCAwLjMsIDAuMThdLCBbMCwgLU1hdGguUEkgLyAyLCAwXSwgWzAuMTI1LCAxLCAxXV1cbiAgICAgIF0sXG4gICAgICBYWjogW1xuICAgICAgICBbXG4gICAgICAgICAgbmV3IE1lc2gobmV3IFBsYW5lR2VvbWV0cnkoMC4yOTUsIDAuMjk1KSwgbWF0TWFnZW50YVRyYW5zcGFyZW50LmNsb25lKCkpLFxuICAgICAgICAgIFswLjE1LCAwLCAwLjE1XSxcbiAgICAgICAgICBbLU1hdGguUEkgLyAyLCAwLCAwXVxuICAgICAgICBdLFxuICAgICAgICBbbmV3IExpbmUobGluZUdlb21ldHJ5LCBtYXRMaW5lTWFnZW50YSksIFswLjE4LCAwLCAwLjNdLCBudWxsLCBbMC4xMjUsIDEsIDFdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZU1hZ2VudGEpLCBbMC4zLCAwLCAwLjE4XSwgWzAsIC1NYXRoLlBJIC8gMiwgMF0sIFswLjEyNSwgMSwgMV1dXG4gICAgICBdXG4gICAgfTtcbiAgICBjb25zdCBwaWNrZXJUcmFuc2xhdGUgPSB7XG4gICAgICBYOiBbW25ldyBNZXNoKG5ldyBDeWxpbmRlckdlb21ldHJ5KDAuMiwgMCwgMSwgNCwgMSwgZmFsc2UpLCBtYXRJbnZpc2libGUpLCBbMC42LCAwLCAwXSwgWzAsIDAsIC1NYXRoLlBJIC8gMl1dXSxcbiAgICAgIFk6IFtbbmV3IE1lc2gobmV3IEN5bGluZGVyR2VvbWV0cnkoMC4yLCAwLCAxLCA0LCAxLCBmYWxzZSksIG1hdEludmlzaWJsZSksIFswLCAwLjYsIDBdXV0sXG4gICAgICBaOiBbW25ldyBNZXNoKG5ldyBDeWxpbmRlckdlb21ldHJ5KDAuMiwgMCwgMSwgNCwgMSwgZmFsc2UpLCBtYXRJbnZpc2libGUpLCBbMCwgMCwgMC42XSwgW01hdGguUEkgLyAyLCAwLCAwXV1dLFxuICAgICAgWFlaOiBbW25ldyBNZXNoKG5ldyBPY3RhaGVkcm9uR2VvbWV0cnkoMC4yLCAwKSwgbWF0SW52aXNpYmxlKV1dLFxuICAgICAgWFk6IFtbbmV3IE1lc2gobmV3IFBsYW5lR2VvbWV0cnkoMC40LCAwLjQpLCBtYXRJbnZpc2libGUpLCBbMC4yLCAwLjIsIDBdXV0sXG4gICAgICBZWjogW1tuZXcgTWVzaChuZXcgUGxhbmVHZW9tZXRyeSgwLjQsIDAuNCksIG1hdEludmlzaWJsZSksIFswLCAwLjIsIDAuMl0sIFswLCBNYXRoLlBJIC8gMiwgMF1dXSxcbiAgICAgIFhaOiBbW25ldyBNZXNoKG5ldyBQbGFuZUdlb21ldHJ5KDAuNCwgMC40KSwgbWF0SW52aXNpYmxlKSwgWzAuMiwgMCwgMC4yXSwgWy1NYXRoLlBJIC8gMiwgMCwgMF1dXVxuICAgIH07XG4gICAgY29uc3QgaGVscGVyVHJhbnNsYXRlID0ge1xuICAgICAgU1RBUlQ6IFtbbmV3IE1lc2gobmV3IE9jdGFoZWRyb25HZW9tZXRyeSgwLjAxLCAyKSwgbWF0SGVscGVyKSwgbnVsbCwgbnVsbCwgbnVsbCwgXCJoZWxwZXJcIl1dLFxuICAgICAgRU5EOiBbW25ldyBNZXNoKG5ldyBPY3RhaGVkcm9uR2VvbWV0cnkoMC4wMSwgMiksIG1hdEhlbHBlciksIG51bGwsIG51bGwsIG51bGwsIFwiaGVscGVyXCJdXSxcbiAgICAgIERFTFRBOiBbW25ldyBMaW5lKFRyYW5zbGF0ZUhlbHBlckdlb21ldHJ5KCksIG1hdEhlbHBlciksIG51bGwsIG51bGwsIG51bGwsIFwiaGVscGVyXCJdXSxcbiAgICAgIFg6IFtbbmV3IExpbmUobGluZUdlb21ldHJ5LCBtYXRIZWxwZXIuY2xvbmUoKSksIFstMWUzLCAwLCAwXSwgbnVsbCwgWzFlNiwgMSwgMV0sIFwiaGVscGVyXCJdXSxcbiAgICAgIFk6IFtbbmV3IExpbmUobGluZUdlb21ldHJ5LCBtYXRIZWxwZXIuY2xvbmUoKSksIFswLCAtMWUzLCAwXSwgWzAsIDAsIE1hdGguUEkgLyAyXSwgWzFlNiwgMSwgMV0sIFwiaGVscGVyXCJdXSxcbiAgICAgIFo6IFtbbmV3IExpbmUobGluZUdlb21ldHJ5LCBtYXRIZWxwZXIuY2xvbmUoKSksIFswLCAwLCAtMWUzXSwgWzAsIC1NYXRoLlBJIC8gMiwgMF0sIFsxZTYsIDEsIDFdLCBcImhlbHBlclwiXV1cbiAgICB9O1xuICAgIGNvbnN0IGdpem1vUm90YXRlID0ge1xuICAgICAgWDogW1xuICAgICAgICBbbmV3IExpbmUoQ2lyY2xlR2VvbWV0cnkoMSwgMC41KSwgbWF0TGluZVJlZCldLFxuICAgICAgICBbbmV3IE1lc2gobmV3IE9jdGFoZWRyb25HZW9tZXRyeSgwLjA0LCAwKSwgbWF0UmVkKSwgWzAsIDAsIDAuOTldLCBudWxsLCBbMSwgMywgMV1dXG4gICAgICBdLFxuICAgICAgWTogW1xuICAgICAgICBbbmV3IExpbmUoQ2lyY2xlR2VvbWV0cnkoMSwgMC41KSwgbWF0TGluZUdyZWVuKSwgbnVsbCwgWzAsIDAsIC1NYXRoLlBJIC8gMl1dLFxuICAgICAgICBbbmV3IE1lc2gobmV3IE9jdGFoZWRyb25HZW9tZXRyeSgwLjA0LCAwKSwgbWF0R3JlZW4pLCBbMCwgMCwgMC45OV0sIG51bGwsIFszLCAxLCAxXV1cbiAgICAgIF0sXG4gICAgICBaOiBbXG4gICAgICAgIFtuZXcgTGluZShDaXJjbGVHZW9tZXRyeSgxLCAwLjUpLCBtYXRMaW5lQmx1ZSksIG51bGwsIFswLCBNYXRoLlBJIC8gMiwgMF1dLFxuICAgICAgICBbbmV3IE1lc2gobmV3IE9jdGFoZWRyb25HZW9tZXRyeSgwLjA0LCAwKSwgbWF0Qmx1ZSksIFswLjk5LCAwLCAwXSwgbnVsbCwgWzEsIDMsIDFdXVxuICAgICAgXSxcbiAgICAgIEU6IFtcbiAgICAgICAgW25ldyBMaW5lKENpcmNsZUdlb21ldHJ5KDEuMjUsIDEpLCBtYXRMaW5lWWVsbG93VHJhbnNwYXJlbnQpLCBudWxsLCBbMCwgTWF0aC5QSSAvIDIsIDBdXSxcbiAgICAgICAgW1xuICAgICAgICAgIG5ldyBNZXNoKG5ldyBDeWxpbmRlckdlb21ldHJ5KDAuMDMsIDAsIDAuMTUsIDQsIDEsIGZhbHNlKSwgbWF0TGluZVllbGxvd1RyYW5zcGFyZW50KSxcbiAgICAgICAgICBbMS4xNywgMCwgMF0sXG4gICAgICAgICAgWzAsIDAsIC1NYXRoLlBJIC8gMl0sXG4gICAgICAgICAgWzEsIDEsIDFlLTNdXG4gICAgICAgIF0sXG4gICAgICAgIFtcbiAgICAgICAgICBuZXcgTWVzaChuZXcgQ3lsaW5kZXJHZW9tZXRyeSgwLjAzLCAwLCAwLjE1LCA0LCAxLCBmYWxzZSksIG1hdExpbmVZZWxsb3dUcmFuc3BhcmVudCksXG4gICAgICAgICAgWy0xLjE3LCAwLCAwXSxcbiAgICAgICAgICBbMCwgMCwgTWF0aC5QSSAvIDJdLFxuICAgICAgICAgIFsxLCAxLCAxZS0zXVxuICAgICAgICBdLFxuICAgICAgICBbXG4gICAgICAgICAgbmV3IE1lc2gobmV3IEN5bGluZGVyR2VvbWV0cnkoMC4wMywgMCwgMC4xNSwgNCwgMSwgZmFsc2UpLCBtYXRMaW5lWWVsbG93VHJhbnNwYXJlbnQpLFxuICAgICAgICAgIFswLCAtMS4xNywgMF0sXG4gICAgICAgICAgW01hdGguUEksIDAsIDBdLFxuICAgICAgICAgIFsxLCAxLCAxZS0zXVxuICAgICAgICBdLFxuICAgICAgICBbXG4gICAgICAgICAgbmV3IE1lc2gobmV3IEN5bGluZGVyR2VvbWV0cnkoMC4wMywgMCwgMC4xNSwgNCwgMSwgZmFsc2UpLCBtYXRMaW5lWWVsbG93VHJhbnNwYXJlbnQpLFxuICAgICAgICAgIFswLCAxLjE3LCAwXSxcbiAgICAgICAgICBbMCwgMCwgMF0sXG4gICAgICAgICAgWzEsIDEsIDFlLTNdXG4gICAgICAgIF1cbiAgICAgIF0sXG4gICAgICBYWVpFOiBbW25ldyBMaW5lKENpcmNsZUdlb21ldHJ5KDEsIDEpLCBtYXRMaW5lR3JheSksIG51bGwsIFswLCBNYXRoLlBJIC8gMiwgMF1dXVxuICAgIH07XG4gICAgY29uc3QgaGVscGVyUm90YXRlID0ge1xuICAgICAgQVhJUzogW1tuZXcgTGluZShsaW5lR2VvbWV0cnksIG1hdEhlbHBlci5jbG9uZSgpKSwgWy0xZTMsIDAsIDBdLCBudWxsLCBbMWU2LCAxLCAxXSwgXCJoZWxwZXJcIl1dXG4gICAgfTtcbiAgICBjb25zdCBwaWNrZXJSb3RhdGUgPSB7XG4gICAgICBYOiBbW25ldyBNZXNoKG5ldyBUb3J1c0dlb21ldHJ5KDEsIDAuMSwgNCwgMjQpLCBtYXRJbnZpc2libGUpLCBbMCwgMCwgMF0sIFswLCAtTWF0aC5QSSAvIDIsIC1NYXRoLlBJIC8gMl1dXSxcbiAgICAgIFk6IFtbbmV3IE1lc2gobmV3IFRvcnVzR2VvbWV0cnkoMSwgMC4xLCA0LCAyNCksIG1hdEludmlzaWJsZSksIFswLCAwLCAwXSwgW01hdGguUEkgLyAyLCAwLCAwXV1dLFxuICAgICAgWjogW1tuZXcgTWVzaChuZXcgVG9ydXNHZW9tZXRyeSgxLCAwLjEsIDQsIDI0KSwgbWF0SW52aXNpYmxlKSwgWzAsIDAsIDBdLCBbMCwgMCwgLU1hdGguUEkgLyAyXV1dLFxuICAgICAgRTogW1tuZXcgTWVzaChuZXcgVG9ydXNHZW9tZXRyeSgxLjI1LCAwLjEsIDIsIDI0KSwgbWF0SW52aXNpYmxlKV1dLFxuICAgICAgWFlaRTogW1tuZXcgTWVzaChuZXcgU3BoZXJlR2VvbWV0cnkoMC43LCAxMCwgOCksIG1hdEludmlzaWJsZSldXVxuICAgIH07XG4gICAgY29uc3QgZ2l6bW9TY2FsZSA9IHtcbiAgICAgIFg6IFtcbiAgICAgICAgW25ldyBNZXNoKHNjYWxlSGFuZGxlR2VvbWV0cnksIG1hdFJlZCksIFswLjgsIDAsIDBdLCBbMCwgMCwgLU1hdGguUEkgLyAyXV0sXG4gICAgICAgIFtuZXcgTGluZShsaW5lR2VvbWV0cnksIG1hdExpbmVSZWQpLCBudWxsLCBudWxsLCBbMC44LCAxLCAxXV1cbiAgICAgIF0sXG4gICAgICBZOiBbXG4gICAgICAgIFtuZXcgTWVzaChzY2FsZUhhbmRsZUdlb21ldHJ5LCBtYXRHcmVlbiksIFswLCAwLjgsIDBdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZUdyZWVuKSwgbnVsbCwgWzAsIDAsIE1hdGguUEkgLyAyXSwgWzAuOCwgMSwgMV1dXG4gICAgICBdLFxuICAgICAgWjogW1xuICAgICAgICBbbmV3IE1lc2goc2NhbGVIYW5kbGVHZW9tZXRyeSwgbWF0Qmx1ZSksIFswLCAwLCAwLjhdLCBbTWF0aC5QSSAvIDIsIDAsIDBdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZUJsdWUpLCBudWxsLCBbMCwgLU1hdGguUEkgLyAyLCAwXSwgWzAuOCwgMSwgMV1dXG4gICAgICBdLFxuICAgICAgWFk6IFtcbiAgICAgICAgW25ldyBNZXNoKHNjYWxlSGFuZGxlR2VvbWV0cnksIG1hdFllbGxvd1RyYW5zcGFyZW50KSwgWzAuODUsIDAuODUsIDBdLCBudWxsLCBbMiwgMiwgMC4yXV0sXG4gICAgICAgIFtuZXcgTGluZShsaW5lR2VvbWV0cnksIG1hdExpbmVZZWxsb3cpLCBbMC44NTUsIDAuOTgsIDBdLCBudWxsLCBbMC4xMjUsIDEsIDFdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZVllbGxvdyksIFswLjk4LCAwLjg1NSwgMF0sIFswLCAwLCBNYXRoLlBJIC8gMl0sIFswLjEyNSwgMSwgMV1dXG4gICAgICBdLFxuICAgICAgWVo6IFtcbiAgICAgICAgW25ldyBNZXNoKHNjYWxlSGFuZGxlR2VvbWV0cnksIG1hdEN5YW5UcmFuc3BhcmVudCksIFswLCAwLjg1LCAwLjg1XSwgbnVsbCwgWzAuMiwgMiwgMl1dLFxuICAgICAgICBbbmV3IExpbmUobGluZUdlb21ldHJ5LCBtYXRMaW5lQ3lhbiksIFswLCAwLjg1NSwgMC45OF0sIFswLCAwLCBNYXRoLlBJIC8gMl0sIFswLjEyNSwgMSwgMV1dLFxuICAgICAgICBbbmV3IExpbmUobGluZUdlb21ldHJ5LCBtYXRMaW5lQ3lhbiksIFswLCAwLjk4LCAwLjg1NV0sIFswLCAtTWF0aC5QSSAvIDIsIDBdLCBbMC4xMjUsIDEsIDFdXVxuICAgICAgXSxcbiAgICAgIFhaOiBbXG4gICAgICAgIFtuZXcgTWVzaChzY2FsZUhhbmRsZUdlb21ldHJ5LCBtYXRNYWdlbnRhVHJhbnNwYXJlbnQpLCBbMC44NSwgMCwgMC44NV0sIG51bGwsIFsyLCAwLjIsIDJdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZU1hZ2VudGEpLCBbMC44NTUsIDAsIDAuOThdLCBudWxsLCBbMC4xMjUsIDEsIDFdXSxcbiAgICAgICAgW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0TGluZU1hZ2VudGEpLCBbMC45OCwgMCwgMC44NTVdLCBbMCwgLU1hdGguUEkgLyAyLCAwXSwgWzAuMTI1LCAxLCAxXV1cbiAgICAgIF0sXG4gICAgICBYWVpYOiBbW25ldyBNZXNoKG5ldyBCb3hHZW9tZXRyeSgwLjEyNSwgMC4xMjUsIDAuMTI1KSwgbWF0V2hpdGVUcmFuc3BhcmVudC5jbG9uZSgpKSwgWzEuMSwgMCwgMF1dXSxcbiAgICAgIFhZWlk6IFtbbmV3IE1lc2gobmV3IEJveEdlb21ldHJ5KDAuMTI1LCAwLjEyNSwgMC4xMjUpLCBtYXRXaGl0ZVRyYW5zcGFyZW50LmNsb25lKCkpLCBbMCwgMS4xLCAwXV1dLFxuICAgICAgWFlaWjogW1tuZXcgTWVzaChuZXcgQm94R2VvbWV0cnkoMC4xMjUsIDAuMTI1LCAwLjEyNSksIG1hdFdoaXRlVHJhbnNwYXJlbnQuY2xvbmUoKSksIFswLCAwLCAxLjFdXV1cbiAgICB9O1xuICAgIGNvbnN0IHBpY2tlclNjYWxlID0ge1xuICAgICAgWDogW1tuZXcgTWVzaChuZXcgQ3lsaW5kZXJHZW9tZXRyeSgwLjIsIDAsIDAuOCwgNCwgMSwgZmFsc2UpLCBtYXRJbnZpc2libGUpLCBbMC41LCAwLCAwXSwgWzAsIDAsIC1NYXRoLlBJIC8gMl1dXSxcbiAgICAgIFk6IFtbbmV3IE1lc2gobmV3IEN5bGluZGVyR2VvbWV0cnkoMC4yLCAwLCAwLjgsIDQsIDEsIGZhbHNlKSwgbWF0SW52aXNpYmxlKSwgWzAsIDAuNSwgMF1dXSxcbiAgICAgIFo6IFtbbmV3IE1lc2gobmV3IEN5bGluZGVyR2VvbWV0cnkoMC4yLCAwLCAwLjgsIDQsIDEsIGZhbHNlKSwgbWF0SW52aXNpYmxlKSwgWzAsIDAsIDAuNV0sIFtNYXRoLlBJIC8gMiwgMCwgMF1dXSxcbiAgICAgIFhZOiBbW25ldyBNZXNoKHNjYWxlSGFuZGxlR2VvbWV0cnksIG1hdEludmlzaWJsZSksIFswLjg1LCAwLjg1LCAwXSwgbnVsbCwgWzMsIDMsIDAuMl1dXSxcbiAgICAgIFlaOiBbW25ldyBNZXNoKHNjYWxlSGFuZGxlR2VvbWV0cnksIG1hdEludmlzaWJsZSksIFswLCAwLjg1LCAwLjg1XSwgbnVsbCwgWzAuMiwgMywgM11dXSxcbiAgICAgIFhaOiBbW25ldyBNZXNoKHNjYWxlSGFuZGxlR2VvbWV0cnksIG1hdEludmlzaWJsZSksIFswLjg1LCAwLCAwLjg1XSwgbnVsbCwgWzMsIDAuMiwgM11dXSxcbiAgICAgIFhZWlg6IFtbbmV3IE1lc2gobmV3IEJveEdlb21ldHJ5KDAuMiwgMC4yLCAwLjIpLCBtYXRJbnZpc2libGUpLCBbMS4xLCAwLCAwXV1dLFxuICAgICAgWFlaWTogW1tuZXcgTWVzaChuZXcgQm94R2VvbWV0cnkoMC4yLCAwLjIsIDAuMiksIG1hdEludmlzaWJsZSksIFswLCAxLjEsIDBdXV0sXG4gICAgICBYWVpaOiBbW25ldyBNZXNoKG5ldyBCb3hHZW9tZXRyeSgwLjIsIDAuMiwgMC4yKSwgbWF0SW52aXNpYmxlKSwgWzAsIDAsIDEuMV1dXVxuICAgIH07XG4gICAgY29uc3QgaGVscGVyU2NhbGUgPSB7XG4gICAgICBYOiBbW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0SGVscGVyLmNsb25lKCkpLCBbLTFlMywgMCwgMF0sIG51bGwsIFsxZTYsIDEsIDFdLCBcImhlbHBlclwiXV0sXG4gICAgICBZOiBbW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0SGVscGVyLmNsb25lKCkpLCBbMCwgLTFlMywgMF0sIFswLCAwLCBNYXRoLlBJIC8gMl0sIFsxZTYsIDEsIDFdLCBcImhlbHBlclwiXV0sXG4gICAgICBaOiBbW25ldyBMaW5lKGxpbmVHZW9tZXRyeSwgbWF0SGVscGVyLmNsb25lKCkpLCBbMCwgMCwgLTFlM10sIFswLCAtTWF0aC5QSSAvIDIsIDBdLCBbMWU2LCAxLCAxXSwgXCJoZWxwZXJcIl1dXG4gICAgfTtcbiAgICBjb25zdCBzZXR1cEdpem1vID0gKGdpem1vTWFwKSA9PiB7XG4gICAgICBjb25zdCBnaXptbyA9IG5ldyBPYmplY3QzRCgpO1xuICAgICAgZm9yIChsZXQgbmFtZSBpbiBnaXptb01hcCkge1xuICAgICAgICBmb3IgKGxldCBpID0gZ2l6bW9NYXBbbmFtZV0ubGVuZ3RoOyBpLS07ICkge1xuICAgICAgICAgIGNvbnN0IG9iamVjdCA9IGdpem1vTWFwW25hbWVdW2ldWzBdLmNsb25lKCk7XG4gICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBnaXptb01hcFtuYW1lXVtpXVsxXTtcbiAgICAgICAgICBjb25zdCByb3RhdGlvbiA9IGdpem1vTWFwW25hbWVdW2ldWzJdO1xuICAgICAgICAgIGNvbnN0IHNjYWxlID0gZ2l6bW9NYXBbbmFtZV1baV1bM107XG4gICAgICAgICAgY29uc3QgdGFnID0gZ2l6bW9NYXBbbmFtZV1baV1bNF07XG4gICAgICAgICAgb2JqZWN0Lm5hbWUgPSBuYW1lO1xuICAgICAgICAgIG9iamVjdC50YWcgPSB0YWc7XG4gICAgICAgICAgaWYgKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICBvYmplY3QucG9zaXRpb24uc2V0KHBvc2l0aW9uWzBdLCBwb3NpdGlvblsxXSwgcG9zaXRpb25bMl0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocm90YXRpb24pIHtcbiAgICAgICAgICAgIG9iamVjdC5yb3RhdGlvbi5zZXQocm90YXRpb25bMF0sIHJvdGF0aW9uWzFdLCByb3RhdGlvblsyXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzY2FsZSkge1xuICAgICAgICAgICAgb2JqZWN0LnNjYWxlLnNldChzY2FsZVswXSwgc2NhbGVbMV0sIHNjYWxlWzJdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgb2JqZWN0LnVwZGF0ZU1hdHJpeCgpO1xuICAgICAgICAgIGNvbnN0IHRlbXBHZW9tZXRyeSA9IG9iamVjdC5nZW9tZXRyeS5jbG9uZSgpO1xuICAgICAgICAgIHRlbXBHZW9tZXRyeS5hcHBseU1hdHJpeDQob2JqZWN0Lm1hdHJpeCk7XG4gICAgICAgICAgb2JqZWN0Lmdlb21ldHJ5ID0gdGVtcEdlb21ldHJ5O1xuICAgICAgICAgIG9iamVjdC5yZW5kZXJPcmRlciA9IEluZmluaXR5O1xuICAgICAgICAgIG9iamVjdC5wb3NpdGlvbi5zZXQoMCwgMCwgMCk7XG4gICAgICAgICAgb2JqZWN0LnJvdGF0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgICAgICBvYmplY3Quc2NhbGUuc2V0KDEsIDEsIDEpO1xuICAgICAgICAgIGdpem1vLmFkZChvYmplY3QpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZ2l6bW87XG4gICAgfTtcbiAgICB0aGlzLmdpem1vID0ge307XG4gICAgdGhpcy5waWNrZXIgPSB7fTtcbiAgICB0aGlzLmhlbHBlciA9IHt9O1xuICAgIHRoaXMuYWRkKHRoaXMuZ2l6bW9bXCJ0cmFuc2xhdGVcIl0gPSBzZXR1cEdpem1vKGdpem1vVHJhbnNsYXRlKSk7XG4gICAgdGhpcy5hZGQodGhpcy5naXptb1tcInJvdGF0ZVwiXSA9IHNldHVwR2l6bW8oZ2l6bW9Sb3RhdGUpKTtcbiAgICB0aGlzLmFkZCh0aGlzLmdpem1vW1wic2NhbGVcIl0gPSBzZXR1cEdpem1vKGdpem1vU2NhbGUpKTtcbiAgICB0aGlzLmFkZCh0aGlzLnBpY2tlcltcInRyYW5zbGF0ZVwiXSA9IHNldHVwR2l6bW8ocGlja2VyVHJhbnNsYXRlKSk7XG4gICAgdGhpcy5hZGQodGhpcy5waWNrZXJbXCJyb3RhdGVcIl0gPSBzZXR1cEdpem1vKHBpY2tlclJvdGF0ZSkpO1xuICAgIHRoaXMuYWRkKHRoaXMucGlja2VyW1wic2NhbGVcIl0gPSBzZXR1cEdpem1vKHBpY2tlclNjYWxlKSk7XG4gICAgdGhpcy5hZGQodGhpcy5oZWxwZXJbXCJ0cmFuc2xhdGVcIl0gPSBzZXR1cEdpem1vKGhlbHBlclRyYW5zbGF0ZSkpO1xuICAgIHRoaXMuYWRkKHRoaXMuaGVscGVyW1wicm90YXRlXCJdID0gc2V0dXBHaXptbyhoZWxwZXJSb3RhdGUpKTtcbiAgICB0aGlzLmFkZCh0aGlzLmhlbHBlcltcInNjYWxlXCJdID0gc2V0dXBHaXptbyhoZWxwZXJTY2FsZSkpO1xuICAgIHRoaXMucGlja2VyW1widHJhbnNsYXRlXCJdLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLnBpY2tlcltcInJvdGF0ZVwiXS52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5waWNrZXJbXCJzY2FsZVwiXS52aXNpYmxlID0gZmFsc2U7XG4gIH1cbn1cbmNsYXNzIFRyYW5zZm9ybUNvbnRyb2xzUGxhbmUgZXh0ZW5kcyBNZXNoIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoXG4gICAgICBuZXcgUGxhbmVHZW9tZXRyeSgxZTUsIDFlNSwgMiwgMiksXG4gICAgICBuZXcgTWVzaEJhc2ljTWF0ZXJpYWwoe1xuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcbiAgICAgICAgd2lyZWZyYW1lOiB0cnVlLFxuICAgICAgICBzaWRlOiBEb3VibGVTaWRlLFxuICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgICAgb3BhY2l0eTogMC4xLFxuICAgICAgICB0b25lTWFwcGVkOiBmYWxzZVxuICAgICAgfSlcbiAgICApO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJpc1RyYW5zZm9ybUNvbnRyb2xzUGxhbmVcIiwgdHJ1ZSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInR5cGVcIiwgXCJUcmFuc2Zvcm1Db250cm9sc1BsYW5lXCIpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ1bml0WFwiLCBuZXcgVmVjdG9yMygxLCAwLCAwKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcInVuaXRZXCIsIG5ldyBWZWN0b3IzKDAsIDEsIDApKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwidW5pdFpcIiwgbmV3IFZlY3RvcjMoMCwgMCwgMSkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0ZW1wVmVjdG9yXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJkaXJWZWN0b3JcIiwgbmV3IFZlY3RvcjMoKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImFsaWduVmVjdG9yXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ0ZW1wTWF0cml4XCIsIG5ldyBNYXRyaXg0KCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJpZGVudGl0eVF1YXRlcm5pb25cIiwgbmV3IFF1YXRlcm5pb24oKSk7XG4gICAgLy8gdGhlc2UgYXJlIHNldCBmcm9tIHBhcmVudCBjbGFzcyBUcmFuc2Zvcm1Db250cm9sc1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJjYW1lcmFRdWF0ZXJuaW9uXCIsIG5ldyBRdWF0ZXJuaW9uKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ3b3JsZFBvc2l0aW9uXCIsIG5ldyBWZWN0b3IzKCkpO1xuICAgIF9fcHVibGljRmllbGQodGhpcywgXCJ3b3JsZFF1YXRlcm5pb25cIiwgbmV3IFF1YXRlcm5pb24oKSk7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImV5ZVwiLCBuZXcgVmVjdG9yMygpKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiYXhpc1wiLCBudWxsKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwibW9kZVwiLCBcInRyYW5zbGF0ZVwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwic3BhY2VcIiwgXCJ3b3JsZFwiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwidXBkYXRlTWF0cml4V29ybGRcIiwgKCkgPT4ge1xuICAgICAgbGV0IHNwYWNlID0gdGhpcy5zcGFjZTtcbiAgICAgIHRoaXMucG9zaXRpb24uY29weSh0aGlzLndvcmxkUG9zaXRpb24pO1xuICAgICAgaWYgKHRoaXMubW9kZSA9PT0gXCJzY2FsZVwiKVxuICAgICAgICBzcGFjZSA9IFwibG9jYWxcIjtcbiAgICAgIHRoaXMudW5pdFguc2V0KDEsIDAsIDApLmFwcGx5UXVhdGVybmlvbihzcGFjZSA9PT0gXCJsb2NhbFwiID8gdGhpcy53b3JsZFF1YXRlcm5pb24gOiB0aGlzLmlkZW50aXR5UXVhdGVybmlvbik7XG4gICAgICB0aGlzLnVuaXRZLnNldCgwLCAxLCAwKS5hcHBseVF1YXRlcm5pb24oc3BhY2UgPT09IFwibG9jYWxcIiA/IHRoaXMud29ybGRRdWF0ZXJuaW9uIDogdGhpcy5pZGVudGl0eVF1YXRlcm5pb24pO1xuICAgICAgdGhpcy51bml0Wi5zZXQoMCwgMCwgMSkuYXBwbHlRdWF0ZXJuaW9uKHNwYWNlID09PSBcImxvY2FsXCIgPyB0aGlzLndvcmxkUXVhdGVybmlvbiA6IHRoaXMuaWRlbnRpdHlRdWF0ZXJuaW9uKTtcbiAgICAgIHRoaXMuYWxpZ25WZWN0b3IuY29weSh0aGlzLnVuaXRZKTtcbiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7XG4gICAgICAgIGNhc2UgXCJ0cmFuc2xhdGVcIjpcbiAgICAgICAgY2FzZSBcInNjYWxlXCI6XG4gICAgICAgICAgc3dpdGNoICh0aGlzLmF4aXMpIHtcbiAgICAgICAgICAgIGNhc2UgXCJYXCI6XG4gICAgICAgICAgICAgIHRoaXMuYWxpZ25WZWN0b3IuY29weSh0aGlzLmV5ZSkuY3Jvc3ModGhpcy51bml0WCk7XG4gICAgICAgICAgICAgIHRoaXMuZGlyVmVjdG9yLmNvcHkodGhpcy51bml0WCkuY3Jvc3ModGhpcy5hbGlnblZlY3Rvcik7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIllcIjpcbiAgICAgICAgICAgICAgdGhpcy5hbGlnblZlY3Rvci5jb3B5KHRoaXMuZXllKS5jcm9zcyh0aGlzLnVuaXRZKTtcbiAgICAgICAgICAgICAgdGhpcy5kaXJWZWN0b3IuY29weSh0aGlzLnVuaXRZKS5jcm9zcyh0aGlzLmFsaWduVmVjdG9yKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiWlwiOlxuICAgICAgICAgICAgICB0aGlzLmFsaWduVmVjdG9yLmNvcHkodGhpcy5leWUpLmNyb3NzKHRoaXMudW5pdFopO1xuICAgICAgICAgICAgICB0aGlzLmRpclZlY3Rvci5jb3B5KHRoaXMudW5pdFopLmNyb3NzKHRoaXMuYWxpZ25WZWN0b3IpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJYWVwiOlxuICAgICAgICAgICAgICB0aGlzLmRpclZlY3Rvci5jb3B5KHRoaXMudW5pdFopO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJZWlwiOlxuICAgICAgICAgICAgICB0aGlzLmRpclZlY3Rvci5jb3B5KHRoaXMudW5pdFgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJYWlwiOlxuICAgICAgICAgICAgICB0aGlzLmFsaWduVmVjdG9yLmNvcHkodGhpcy51bml0Wik7XG4gICAgICAgICAgICAgIHRoaXMuZGlyVmVjdG9yLmNvcHkodGhpcy51bml0WSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlhZWlwiOlxuICAgICAgICAgICAgY2FzZSBcIkVcIjpcbiAgICAgICAgICAgICAgdGhpcy5kaXJWZWN0b3Iuc2V0KDAsIDAsIDApO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJyb3RhdGVcIjpcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aGlzLmRpclZlY3Rvci5zZXQoMCwgMCwgMCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5kaXJWZWN0b3IubGVuZ3RoKCkgPT09IDApIHtcbiAgICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvcHkodGhpcy5jYW1lcmFRdWF0ZXJuaW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudGVtcE1hdHJpeC5sb29rQXQodGhpcy50ZW1wVmVjdG9yLnNldCgwLCAwLCAwKSwgdGhpcy5kaXJWZWN0b3IsIHRoaXMuYWxpZ25WZWN0b3IpO1xuICAgICAgICB0aGlzLnF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4KHRoaXMudGVtcE1hdHJpeCk7XG4gICAgICB9XG4gICAgICBzdXBlci51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgIH0pO1xuICB9XG59XG5leHBvcnQge1xuICBUcmFuc2Zvcm1Db250cm9scyxcbiAgVHJhbnNmb3JtQ29udHJvbHNHaXptbyxcbiAgVHJhbnNmb3JtQ29udHJvbHNQbGFuZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zZm9ybUNvbnRyb2xzLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/three-stdlib/controls/TransformControls.js\n");

/***/ })

};
;